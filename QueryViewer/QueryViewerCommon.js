function IsQueryObjectPreview(){return void 0!=window.external&&void 0!=window.external.SendText}function IsDashboardEdit(){return"undefined"!==typeof UCDashboardForEditor}function UpdateQueryObjectPreview(a){for(var c=Object.keys(qv.collection)[0],c=qv.collection[c],a=JSON.parse(a),d=Object.keys(a),b=0;b<d.length;b++){var m=d[b];c[m]=a[m]}c.realShow()}
var HIGHCHARTS_COLOR_PREFIX="highcharts-color-",HIGHCHARTS_MAX_COLORS=36,HIGHCHARTS_CUSTOM_COLOR=[],qv={collection:{},fadeTimeouts:{}},QueryViewerVisible={Always:"Always",Yes:"Yes",No:"No",Never:"Never"},QueryViewerElementType={Axis:"Axis",Datum:"Datum"},QueryViewerAxisType={Rows:"Rows",Columns:"Columns",Pages:"Pages"},QueryViewerFilterType={ShowAllValues:"ShowAllValues",HideAllValues:"HideAllValues",ShowSomeValues:"ShowSomeValues"},QueryViewerAxisOrderType={None:"None",Ascending:"Ascending",Descending:"Descending",
Custom:"Custom"},QueryViewerExpandCollapseType={ExpandAllValues:"ExpandAllValues",CollapseAllValues:"CollapseAllValues",ExpandSomeValues:"ExpandSomeValues"},QueryViewerDataType={Integer:"integer",Real:"real",Character:"character",Boolean:"boolean",Date:"date",DateTime:"datetime",GUID:"guid",GeoPoint:"geopoint"},QueryViewerAggregationType={Sum:"Sum",Average:"Average",Count:"Count",Max:"Max",Min:"Min"},QueryViewerOutputType={Card:"Card",Chart:"Chart",PivotTable:"PivotTable",Table:"Table",Map:"Map",
Default:"Default"},QueryViewerMapType={Choropleth:"Choropleth",Bubble:"Bubble"},QueryViewerRegion={Country:"Country",Continent:"Continent",World:"World"},QueryViewerContinent={SouthAmerica:"SouthAmerica",NorthAmerica:"NorthAmerica",Africa:"Africa",Asia:"Asia",Europe:"Europe",Oceania:"Oceania",Antarctica:"Antarctica"},QueryViewerCountry={AF:"AF",AL:"AL",DZ:"DZ",AD:"AD",AO:"AO",AI:"AI",AG:"AG",AR:"AR",AM:"AM",AU:"AU",AT:"AT",AZ:"AZ",BH:"BH",BD:"BD",BB:"BB",BY:"BY",BE:"BE",BZ:"BZ",BJ:"BJ",BM:"BM",BT:"BT",
BO:"BO",BA:"BA",BW:"BW",BR:"BR",VG:"VG",BN:"BN",BG:"BG",BF:"BF",BI:"BI",KH:"KH",CM:"CM",CA:"CA",CV:"CV",CF:"CF",TD:"TD",CL:"CL",CN:"CN",CO:"CO",KM:"KM",CK:"CK",CR:"CR",HR:"HR",CU:"CU",CY:"CY",CZ:"CZ",CD:"CD",DK:"DK",DJ:"DJ",DM:"DM",DO:"DO",TL:"TL",EC:"EC",EG:"EG",SV:"SV",GQ:"GQ",ER:"ER",EE:"EE",SZ:"SZ",ET:"ET",FO:"FO",FJ:"FJ",FI:"FI",FR:"FR",GA:"GA",GM:"GM",GE:"GE",DE:"DE",GH:"GH",GR:"GR",GL:"GL",GD:"GD",GT:"GT",GN:"GN",GW:"GW",GY:"GY",HT:"HT",HN:"HN",HU:"HU",IS:"IS",IN:"IN",ID:"ID",IR:"IR",IQ:"IQ",
IE:"IE",IL:"IL",IT:"IT",CI:"CI",JM:"JM",JP:"JP",JO:"JO",KZ:"KZ",KE:"KE",KI:"KI",XK:"XK",KW:"KW",KG:"KG",LA:"LA",LV:"LV",LB:"LB",LS:"LS",LR:"LR",LY:"LY",LI:"LI",LT:"LT",LU:"LU",MG:"MG",MW:"MW",MY:"MY",MV:"MV",ML:"ML",MT:"MT",MH:"MH",MR:"MR",MU:"MU",MX:"MX",FM:"FM",MD:"MD",MC:"MC",MN:"MN",ME:"ME",MA:"MA",MZ:"MZ",MM:"MM",NA:"NA",NR:"NR",NP:"NP",NL:"NL",NZ:"NZ",NI:"NI",NE:"NE",NG:"NG",KP:"KP",MK:"MK",NO:"NO",OM:"OM",PK:"PK",PW:"PW",PA:"PA",PS:"PS",PG:"PG",PY:"PY",PE:"PE",PH:"PH",PL:"PL",PT:"PT",PR:"PR",
QA:"QA",CG:"CG",RO:"RO",RU:"RU",RW:"RW",KN:"KN",LC:"LC",VC:"VC",WS:"WS",SM:"SM",ST:"ST",SA:"SA",SN:"SN",RS:"RS",SC:"SC",SL:"SL",SG:"SG",SK:"SK",SI:"SI",SB:"SB",SO:"SO",ZA:"ZA",KR:"KR",SS:"SS",ES:"ES",LK:"LK",SD:"SD",SR:"SR",SE:"SE",CH:"CH",SY:"SY",TW:"TW",TJ:"TJ",TZ:"TZ",TH:"TH",BS:"BS",TG:"TG",TK:"TK",TO:"TO",TT:"TT",TN:"TN",TR:"TR",TM:"TM",TV:"TV",UG:"UG",UA:"UA",AE:"AE",GB:"GB",US:"US",UY:"UY",UZ:"UZ",VU:"VU",VA:"VA",VE:"VE",VN:"VN",EH:"EH",YE:"YE",ZM:"ZM",ZW:"ZW"},QueryViewerMapLibrary={Highcharts:"Highcharts",
ECharts:"ECharts"},QueryViewerChartType={Column:"Column",Column3D:"Column3D",StackedColumn:"StackedColumn",StackedColumn3D:"StackedColumn3D",StackedColumn100:"StackedColumn100",Bar:"Bar",StackedBar:"StackedBar",StackedBar100:"StackedBar100",Area:"Area",StackedArea:"StackedArea",StackedArea100:"StackedArea100",SmoothArea:"SmoothArea",StepArea:"StepArea",Line:"Line",StackedLine:"StackedLine",StackedLine100:"StackedLine100",SmoothLine:"SmoothLine",StepLine:"StepLine",Pie:"Pie",Pie3D:"Pie3D",Doughnut:"Doughnut",
Doughnut3D:"Doughnut3D",LinearGauge:"LinearGauge",CircularGauge:"CircularGauge",Radar:"Radar",FilledRadar:"FilledRadar",PolarArea:"PolarArea",Funnel:"Funnel",Pyramid:"Pyramid",ColumnLine:"ColumnLine",Column3DLine:"Column3DLine",Timeline:"Timeline",SmoothTimeline:"SmoothTimeline",StepTimeline:"StepTimeline",Sparkline:"Sparkline"},QueryViewerConditionOperator={Equal:"EQ",LessThan:"LT",GreaterThan:"GT",LessOrEqual:"LE",GreaterOrEqual:"GE",NotEqual:"NE",Interval:"IN"},QueryViewerConditionOperatorSymbol=
{Equal:"=",LessThan:"<",GreaterThan:">",LessOrEqual:"≤",GreaterOrEqual:"≥",NotEqual:"<>",Interval:"-"},QueryViewerOrientation={Horizontal:"Horizontal",Vertical:"Vertical"},QueryViewerPlotSeries={InTheSameChart:"InTheSameChart",InSeparateCharts:"InSeparateCharts"},QueryViewerShowDataAs={Values:"Values",Percentages:"Percentages",ValuesAndPercentages:"ValuesAndPercentages"},QueryViewerSubtotals={Yes:"Yes",Hidden:"Hidden",No:"No"},QueryViewerTrendPeriod={SinceTheBeginning:"SinceTheBeginning",LastYear:"LastYear",
LastSemester:"LastSemester",LastQuarter:"LastQuarter",LastMonth:"LastMonth",LastWeek:"LastWeek",LastDay:"LastDay",LastHour:"LastHour",LastMinute:"LastMinute",LastSecond:"LastSecond"},QueryViewerXAxisLabels={Horizontally:"Horizontally",Rotated30:"Rotated30",Rotated45:"Rotated45",Rotated60:"Rotated60",Vertically:"Vertically"},QueryViewerAutoresizeType={Both:"Both",Vertical:"Vertical",Horizontal:"Horizontal"},QueryViewerTranslationType={NoTranslation:"None",Static:"Static",RunTime:"RunTime"};
qv.util={color:{getHtmlColor:function(a){return"string"==typeof a||"number"==typeof a?gx.color.toHex?-1==a?"":"#"+gx.color.toHex(a):"#"+gxToHex(a):void 0==a?"#000000":a.Html},parseCSSColor:function(a){return"rgb"==a.substring(0,3)?(a=a.replace("rgb","").replace("(","").replace(")","").split(","),this.getHtmlColor(gx.color.rgb(parseInt(a[0]),parseInt(a[1]),parseInt(a[2])))):a},convertValueToColor:function(a){a=-1==a.indexOf("#")?"#"+a:a;for(a=a.substring(1,a.length);6>a.length;)a="0"+a;return"#"+a},
IsHexaColor:function(a){return 6===a.length&&!isNaN(parseInt(a,16))},lightenDarkenColor:function(a,c){var d=!1;"#"==a[0]&&(a=a.slice(1),d=!0);var b=parseInt(a,16),m=(b>>16)+c;255<m?m=255:0>m&&(m=0);var f=(b>>8&255)+c;255<f?f=255:0>f&&(f=0);b=(b&255)+c;255<b?b=255:0>b&&(b=0);return(d?"#":"")+(b|f<<8|m<<16).toString(16)},standardize_color:function(a){var c=document.createElement("canvas").getContext("2d");c.fillStyle=a;return c.fillStyle},resolveColor:function(a,c){qv.util.startsWith(a,"#")||(a=qv.util.color.standardize_color(a));
if(!c||"1"==c)return a;var d=parseInt(a.substring(1),16);return"rgba("+(d>>16&255)+","+(d>>8&255)+","+(d&255)+","+c+")"}},css:function(){var a={};return{replaceCssClasses:function(c){for(;0<=(posIni=c.indexOf("gxpl_cssReplace("));){posFin=c.indexOf(")",posIni);className=c.substring(posIni+16,posFin);var d=className;if(void 0!=a[d])style=a[d];else{for(var b=d,m=void 0,f=gx.theme+".css",q=!1,l=void 0,v=0;v<document.styleSheets.length;v++)if(null!=document.styleSheets[v].href&&0<=document.styleSheets[v].href.indexOf(f)){q=
!0;m=document.styleSheets[v];break}q&&(m.cssRules?crossRules=m.cssRules:m.rules&&(crossRules=m.rules));m=Number.MAX_SAFE_INTEGER;for(v=0;v<crossRules.length;v++)f=crossRules[v],void 0!=f.selectorText&&(0==f.selectorText.toLowerCase().indexOf("."+b.toLowerCase())&&f.selectorText.length<m)&&(l=f.style,m=f.selectorText.length);styleObj=l;void 0!=styleObj?(b=styleObj,l="",""!=b.color&&(l+=(""==l?"":";")+"color:"+qv.util.color.parseCSSColor(b.color)),""!=b.backgroundColor&&(l+=(""==l?"":";")+"backgroundColor:"+
qv.util.color.parseCSSColor(b.backgroundColor)),""!=b.borderStyle&&(l+=(""==l?"":";")+"borderStyle:"+b.borderStyle),""!=b.borderWidth&&(l+=(""==l?"":";")+"borderThickness:"+b.borderWidth.replace("pt","").replace("px","")),""!=b.borderColor&&(l+=(""==l?"":";")+"borderColor:"+qv.util.color.parseCSSColor(b.borderColor)),""!=b.fontFamily&&(l+=(""==l?"":";")+"fontFamily:"+b.fontFamily.replace(/"/g,"").replace(/'/g,"")),""!=b.fontSize&&(l+=(""==l?"":";")+"fontSize:"+b.fontSize.replace("pt","").replace("px",
"")),""!=b.fontWeight&&(l+=(""==l?"":";")+"fontWeight:"+b.fontWeight),""!=b.fontStyle&&(l+=(""==l?"":";")+"fontStyle:"+b.fontStyle),""!=b.textDecoration&&(l+=(""==l?"":";")+"textDecoration:"+b.textDecoration),styleTransformed=l,style=a[d]=styleTransformed):style=""}toReplace=c.substring(posIni,posFin+1);c=c.replace(toReplace,style)}return c},parseStyle:function(a){var d="";if(""!=a&&void 0!=a){if(0>a.indexOf(":"))return a;for(var a=a.split(";"),b=0;b<a.length;b++)var m=a[b].split(":"),f=m[0],d=d+
((""==d?"":",")+'"'+("borderThickness"==f?"borderWidth":f)+'":"'+m[1]+("borderThickness"==f||"fontSize"==f?"px":"")+'"');return"{"+d+"}"}return"{}"},resolveVariable:function(a){return qv.util.startsWith(a,"var(")&&qv.util.endsWith(a,")")?(a=a.substr(4,a.length-5),qv.util.trim(getComputedStyle(document.documentElement).getPropertyValue(a.toLowerCase()))):a}}}(),autorefresh:function(){return{UpdateLayoutSameGroup:function(a,c,d){function b(a,b){function c(a,e){for(var b=0;b<a.Metadata.Parameters.length;b++){var h=
a.Metadata.Parameters[b];if(h.IsCollection&&h.Name==e)return[b,h]}return[null,null]}function d(a,b){for(var e=null,h=0;h<a.Parameters.length;h++)if(a.Parameters[h].Name==b){e=a.Parameters[h];break}return e}function s(a,e){for(var b="",h="I"==e.Type||"R"==e.Type||"B"==e.Type?"":'"',f=0;f<a.Filter.Values.length;f++)b+=(""==b?"":",")+h+a.Filter.Values[f]+h;return"["+b+"]"}var m=[];a._parametersCloned||(a._parametersCloned=!0,a.Parameters=qv.util.cloneObject(a.Parameters));for(var h=qv.util.GetOrderedElementsKeys(a,
b),u=a.GetMetadata(),n=0;n<h.length;n++){var z=parseInt(h[n].substr(6,4));sourceElement=b[z];var e=c(a,sourceElement.Name),z=e[0],e=e[1],g=qv.util.GetElementInCollection(u,"Name",sourceElement.Name),C=null!=g,E=!C;C&&(qv.util.MergeFields(sourceElement,g),m.push(g));E&&null!=e&&(e=s(sourceElement,e),a.Object?(g=eval(a.Object),g[z+2]=e,a.Object=JSON.stringify(g)):(z=d(a,sourceElement.Name),null==z&&(z={},z.Name=sourceElement.Name,a.Parameters.push(z)),z.Value=e))}a.Axes=m}function m(a,c,l){b(a,c);a.RememberLayout=
!1;a.AllowElementsOrderChange=l;qv.util.autorefresh.SaveAxesAndParametersState(a);a.realShow()}if(void 0!=a.AutoRefreshGroup&&null!=a.AutoRefreshGroup&&""!=a.AutoRefreshGroup&&""!=qv.util.trim(a.AutoRefreshGroup))for(index in qv.util.autorefresh.DeleteAxesAndParametersState(a),qv.collection)qViewerOther=qv.collection[index],qv.services.IsObjectSet(qViewerOther)&&(qViewerOther.userControlId()!=a.userControlId()&&a.AutoRefreshGroup==qViewerOther.AutoRefreshGroup)&&(qViewerOther._isAutorefresh=!0,void 0!=
qViewerOther.Metadata&&void 0!=qViewerOther.Metadata.Parameters?m(qViewerOther,c,d):qViewerOther.getQueryParameters(function(a,b){var l=qv.util.dom.xmlDocument(a),l=qv.util.dom.getSingleElementByTagName(l,"gxpl_ParameterCollection");void 0==b.Metadata&&(b.Metadata={});b.Metadata.Parameters=[];for(var l=qv.util.dom.getMultipleElementsByTagName(l,"gxpl_Parameter"),v=0;v<l.length;v++){var s={};s.Name=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(l[v],"Name"));s.Type=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(l[v],
"Type"));s.IsCollection=gx.lang.gxBoolean(qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(l[v],"IsCollection")));b.Metadata.Parameters.push(s)}m(b,c,d)}))},LoadAxesAndParametersState:function(a){function c(a,b){for(var c=0;c<b.length;c++){var l=b[c],d;a:{d=a;for(var s=l.Name,r=0;r<d.length;r++)if(d[r].Name.toLowerCase()==s.toLowerCase()){d=d[r];break a}d=null}null!=d&&Object.assign(d,l)}return a}var d=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",
b=d+"Axes",d=qv.util.storage.getItem(d+"Parameters"),b=qv.util.storage.getItem(b);null!=d&&""!=d&&(a.Parameters=c(JSON.parse(d),a.Parameters),a.RememberLayout=!1);null!=b&&""!=b&&(a.Axes=c(JSON.parse(b),a.Axes),a.RememberLayout=!1)},SaveAxesAndParametersState:function(a){var c=window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",d=c+"Axes";qv.util.storage.setItem(c+"Parameters",JSON.stringify(a.Parameters));qv.util.storage.setItem(d,JSON.stringify(a.Axes))},DeleteAxesAndParametersState:function(a){var a=
window.location.pathname+"_"+a.userControlId()+"_"+a.ObjectId+"_"+a.ObjectName+"_",c=a+"Axes";qv.util.storage.removeItem(a+"Parameters");qv.util.storage.removeItem(c)}}}(),dom:{getSingleElementByTagName:function(a,c){var d;d=this.getMultipleElementsByTagName(a,c);return 0<d.length?d[0]:null},getMultipleElementsByTagName:function(a,c){return!gx.util.browser.isIE()||12<=gx.util.browser.ieVersion()?a.getElementsByTagName(c):a.selectNodes(c)},getBooleanAttribute:function(a,c,d){a=a.getAttribute(c);return null==
a?d:"true"==a.toLowerCase()},getCharacterAttribute:function(a,c,d){a=a.getAttribute(c);return null==a?d:a},getValueNode:function(a){return null==a||void 0==a?null:null!=a.firstChild&&void 0!=a.firstChild?a.firstChild.nodeValue:null},selectXPathNode:function(a,c){var d;a.evaluate?(d=a.evaluate(c,a,null,XPathResult.ANY_TYPE,null),d=d.iterateNext()):(d=a.selectNodes(c),d=0<d.length?d[0]:null);return d},xmlDocument:function(a){var c;!gx.util.browser.isIE()||12<=gx.util.browser.ieVersion()?(parser=new DOMParser,
c=parser.parseFromString(a,"text/xml")):(c=new ActiveXObject("Microsoft.XMLDOM"),c.async="false",c.loadXML(a));return c},getEmptyContainer:function(a){for(a=a.getContainerControl();a.firstChild;)a.removeChild(a.firstChild);return a},setStyle:function(a,c){for(key in c)a.style[key]=c[key]},createText:function(a,c){var d=document.createTextNode(c);a.appendChild(d);return d},createElement:function(a,c,d,b,m,f,q){c=document.createElement(c);""!=d&&(c.id=d);""!=b&&(c.className=b);qv.util.dom.setStyle(c,
m);"function"==typeof f&&(c.onclick=f);""!=q&&qv.util.dom.createText(c,q);null!=a&&a.appendChild(c);return c},createTable:function(a,c,d){a=qv.util.dom.createElement(a,"TABLE","",c,d,null,"");c=document.createElement("TBODY");a.appendChild(c);return c},createRow:function(a){return qv.util.dom.createElement(a,"TR","","",{},null,"")},createCell:function(a,c,d,b,m){a=qv.util.dom.createElement(a,"TD","","",b,null,m);1!=c&&(a.colSpan=c);""!=d&&(a.align=d);return a},createSpan:function(a,c,d,b,m,f,q){a=
qv.util.dom.createElement(a,"SPAN",c,d,m,f,q);""!=b&&(a.title=b);return a},createDiv:function(a,c,d,b,m,f){a=qv.util.dom.createElement(a,"DIV",c,d,m,null,f);""!=b&&(a.title=b);return a},createAnchor:function(a,c,d,b){return qv.util.dom.createElement(a,"A",c,"",d,null,b)},createInput:function(a,c,d,b){a=qv.util.dom.createElement(a,"INPUT",c,"",b,null,"");""!=d&&(a.type=d);return a},createSelect:function(a,c){return qv.util.dom.createElement(a,"SELECT",c,"",{},null,"")},createOption:function(a,c,d,
b){a=qv.util.dom.createElement(a,"OPTION","","",{},null,b);""!=c&&(a.value=c);d&&(a.selected=!0);return a},createIcon:function(a,c,d,b){a=qv.util.dom.createElement(a,"I","","material-icons",d,null,b);""!=c&&(a.title=c);return a},loadStylesAndScripts:function(a,c,d,b){function m(a,b,f,c){qv.util.dom._loadedStyles=qv.util.dom._loadedStyles||[];if(0>qv.util.dom._loadedStyles.indexOf(a))if(qv.util.dom._loadedStyles.push(a),a=qv.services.url.getStaticDirectory()+a,gx.O.DSO){var h=document.createElement("style");
h.setAttribute("data-gx-href",a);h.innerHTML='@import url("'+a+'") layer('+b+")";"function"===typeof c&&(h.onload=c);$(h).insertBefore(f)}else b=document.createElement("link"),b.type="text/css",b.rel="stylesheet",b.href=a,"function"===typeof c&&(b.onload=c),$(b).insertBefore(f);else c()}function f(a,b,c,d,h){"undefined"===typeof h&&(h=0);if(h>=a.length){var u=qv.services.url.getStaticDirectory();gx.http.loadScripts(c.map(function(a){return u+a}),d)}else m(a[h],q,b,function(a,h,e){f(a,b,c,h,e+1)}.closure(this,
[a,d,h]))}var q=a[0].replace(/\//g,"_").replace(/\./g,"_");m(a[0],q,gx.getThemeElement(),function(b,c){var s=qv.util.GetLinkOrStyleElement(a[0]),q=a.slice(1).concat(b);f(q,s,d,c)}.closure(this,[c,b]))}},storage:function(){function a(a,d,b){if(b){var m=new Date;m.setTime(m.getTime()+864E5*b);b="; expires="+m.toGMTString()}else b="";document.cookie=a+"="+d+b+"; path=/"}return{setItem:function(c,d){localStorage?localStorage.setItem(c,d):a(c,d,365)},getItem:function(a){if(localStorage)return localStorage.getItem(a);
a:{for(var a=a+"=",d=document.cookie.split(";"),b=0;b<d.length;b++){for(var m=d[b];" "==m.charAt(0);)m=m.substring(1,m.length);if(0==m.indexOf(a)){a=m.substring(a.length,m.length);break a}}a=null}return a},removeItem:function(c){localStorage?localStorage.removeItem(c):a(c,"",-1)}}}(),ExecuteTracker:function(a,c){for(var d=[],b=0;b<gx.fx.ctx.trackers.length;b++)gx.fx.ctx.trackers[b].types[0]==a&&(d[d.length]=gx.fx.ctx.trackers[b]);for(b=0;b<d.length;b++){var m=gx.O;gx.O=d[b].obj;var f=gx.csv.cmpCtx;
gx.csv.cmpCtx=d[b].obj.CmpContext;gx.evt.setProcessing(!1);d[b].hdl.call(d[b].obj,null,null,c);gx.O=m;gx.csv.cmpCtx=f}},satisfyStyle:function(a,c){switch(c.Operator){case QueryViewerConditionOperator.Equal:return a==c.Value1;case QueryViewerConditionOperator.GreaterThan:return a>c.Value1;case QueryViewerConditionOperator.LessThan:return a<c.Value1;case QueryViewerConditionOperator.GreaterOrEqual:return a>=c.Value1;case QueryViewerConditionOperator.LessOrEqual:return a<=c.Value1;case QueryViewerConditionOperator.NotEqual:return a!=
c.Value1;case QueryViewerConditionOperator.Interval:return a>=c.Value1&&a<=c.Value2}},isGeneXusPreview:function(){return IsQueryObjectPreview()},getGenerator:function(){return gx.gen.isDotNet()?"C#":gx.gen.isJava()?"Java":""},getErrorFromText:function(a){return'<Result OK="True"></Result>'==a?"":a.replace('<Result OK="False"><Dsc>',"").replace("</Dsc></Result>","")},trim:function(a){return"string"!=typeof a?null:a.replace(/^[\s]+/,"").replace(/[\s]+$/,"").replace(/[\s]{2,}/," ")},capitalize:function(a){return a.charAt(0).toUpperCase()+
a.slice(1)},decapitalize:function(a){return a.charAt(0).toLowerCase()+a.slice(1)},dateToString:function(a,c){var d=a.getStringWithFmt("Y4MD").replace(/\//g,"-");c&&(a.TimeFmt=24,d+=" "+a.getTimeString(!0,!0));return d},cloneObject:function(a){return JSON.parse(JSON.stringify(a))},endsWith:function(a,c){return a.substr(a.length-c.length,c.length)==c},startsWith:function(a,c){return a.substr(0,c.length)==c},formatNumber:function(a,c,d,b){a=gx.num.formatNumber(a,c,d,0,!0,!1);if(b&&0<=a.indexOf(gx.decimalPoint)){for(;qv.util.endsWith(a,
"0");)a=a.slice(0,-1);qv.util.endsWith(a,gx.decimalPoint)&&(a=a.slice(0,-1))}return a},formatDateTime:function(a,c,d,b,m,f,q){a=new gx.date.gxdate(a,"Y4MD");d=a.getStringWithFmt(d);c==QueryViewerDataType.DateTime&&(a.TimeFmt=24,d+=" "+a.getTimeString(m,f,b,q));return d},seconsdToText:function(a){return 60>a?qv.util.formatNumber(Math.round(a),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerSeconds")):3600>a?qv.util.formatNumber(Math.round(a/60),0,"ZZZZZZZZZZZZZZ9",!1)+" "+
qv.util.decapitalize(gx.getMessage("GXPL_QViewerMinutes")):86400>a?qv.util.formatNumber(Math.round(a/60/60),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerHours")):2630016>a?qv.util.formatNumber(Math.round(a/60/60/24),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerDays")):31557600>a?qv.util.formatNumber(Math.round(a/60/60/24/30.44),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerMonths")):qv.util.formatNumber(Math.round(a/
60/60/24/365.25),0,"ZZZZZZZZZZZZZZ9",!1)+" "+qv.util.decapitalize(gx.getMessage("GXPL_QViewerYears"))},ParseNumericPicture:function(a,c){var d,b,m="",f="";if(""==c)d=a==QueryViewerDataType.Integer?0:2,b=!1;else{0>c.indexOf(".")&&0>c.indexOf(",")?(d=0,b=!1):0<=c.indexOf(".")&&0>c.indexOf(",")?(d=a==QueryViewerDataType.Integer?0:c.length-c.indexOf(".")-1,b=!1):(d=0>c.indexOf(".")&&0<=c.indexOf(",")?0:a==QueryViewerDataType.Integer?0:c.length-c.indexOf(".")-1,b=!0);for(var q=1,l=0;l<c.length;l++){var v=
c.substr(l,1);if(("."==v||","==v||"9"==v||"Z"==v)&&1==q)q=2;"."!=v&&(","!=v&&"9"!=v&&"Z"!=v)&&2==q&&(q=3);switch(q){case 1:m+=v;break;case 3:f+=v}}}return{DecimalPrecision:d,UseThousandsSeparator:b,Prefix:m,Suffix:f}},ParseDateTimePicture:function(a,c){var d=gx.dateFormat,b=a==QueryViewerDataType.DateTime,m=a==QueryViewerDataType.DateTime,f=a==QueryViewerDataType.DateTime,q=a==QueryViewerDataType.DateTime;""!=c&&(0<=c.indexOf("9999")&&0>d.indexOf("Y4")?d=d.replace("Y","Y4"):0>c.indexOf("9999")&&0<=
d.indexOf("Y4")&&(d=d.replace("Y4","Y")),a==QueryViewerDataType.DateTime&&(b=c.indexOf(" "),0<=b?(q=c.substr(b+1,c.length-b),b=2<=q.length,m=5<=q.length,f=8<=q.length,q=12==q.length):q=f=m=b=!1));return{DateFormat:d,IncludeHours:b,IncludeMinutes:m,IncludeSeconds:f,IncludeMilliseconds:q}},evaluate:function(a,c,d){for(var b=1;b<=d.length;b++)a=a.replace(c+b.toString(),d[b-1]);return eval(a)},aggregate:function(a,c,d){var a=a||QueryViewerAggregationType.Sum,b=null,m=null,f=null,q=null;switch(a){case QueryViewerAggregationType.Sum:for(a=
0;a<c.length;a++)null!=c[a]&&(b+=c[a]);return b;case QueryViewerAggregationType.Average:for(a=0;a<c.length;a++)null!=c[a]&&(b+=c[a],m+=d[a]);return null!=b?b/m:null;case QueryViewerAggregationType.Count:for(a=0;a<d.length;a++)m+=d[a];return m;case QueryViewerAggregationType.Max:for(a=0;a<c.length;a++)q=null==q?c[a]:c[a]>q?c[a]:q;return q;case QueryViewerAggregationType.Min:for(a=0;a<c.length;a++)f=null==f?c[a]:c[a]<f?c[a]:f;return f}},anyError:function(a){return 0==a.indexOf('<Result OK="False"><Dsc>')},
showActivityIndicator:function(a){var c='qv.util.showActivityIndicatorMain("'+a.getContainerControl().id+'");',a=a.userControlId();qv.fadeTimeouts[a]&&clearTimeout(qv.fadeTimeouts[a]);qv.fadeTimeouts[a]=setTimeout(c,500)},showActivityIndicatorMain:function(a){a=document.getElementById(a);gx.dom.addClass(a,"gx-qv-loading");for(var c=0;c<a.childNodes.length;c++)gx.dom.addClass(a.childNodes[c],"gx-qv-loading-children")},hideActivityIndicator:function(a){var c=a.userControlId();qv.fadeTimeouts[c]&&(clearTimeout(qv.fadeTimeouts[c]),
qv.fadeTimeouts[c]=void 0);a=a.getContainerControl();gx.dom.removeClass(a,"gx-qv-loading");for(c=0;c<a.childNodes.length;c++)gx.dom.removeClass(a.childNodes[c],"gx-qv-loading-children")},renderError:function(a,c){if(IsQueryObjectPreview()&&!IsDashboardEdit())window.external.SendText(a.ControlName,c);else{var d=qv.util.dom.getEmptyContainer(a);qv.util.dom.createDiv(d,"","gx-qv-centered-text","",{width:gx.dom.addUnits(a.Width),height:gx.dom.addUnits(a.Height),borderColor:"silver",borderWidth:"thin",
borderStyle:"solid"},gx.getMessage("GXPL_QViewerError")+": "+c);a._ControlRenderedTo=void 0;qv.util.hideActivityIndicator(a)}},GetDesigntimeMetadata:function(a){for(var c=[],d=0;d<a.Metadata.Axes.length;d++){var b=a.Metadata.Axes[d];if(!b.IsComponent){var m={};m.Name=b.Name;m.Title=b.Title;m.DataField=b.DataField;m.Visible=b.Visible;m.Type=QueryViewerElementType.Axis;m.Axis=b.Axis;m.Filter=b.Filter;m.ExpandCollapse=b.ExpandCollapse;m.AxisOrder=b.Order;m.Format={};m.Format.Subtotals=b.Subtotals;m.Format.Picture=
b.Picture;m.Format.CanDragToPages=b.CanDragToPages;m.Format.Style=b.Style;0<b.ValuesStyles.length&&(m.Format.ValuesStyles=b.ValuesStyles);m.Actions={};m.Actions.RaiseItemClick=b.RaiseItemClick;c.push(m)}}for(d=0;d<a.Metadata.Data.length;d++)b=a.Metadata.Data[d],b.IsComponent||(m={},m.Name=b.Name,m.Title=b.Title,m.DataField=b.DataField,m.Visible=b.Visible,m.Type=QueryViewerElementType.Datum,m.Axis="",m.Aggregation=b.Aggregation,m.Format={},m.Format.Picture=b.Picture,m.Format.Style=b.Style,m.Format.TargetValue=
b.TargetValue,m.Format.MaximumValue=m.Format.TargetValue,0<b.ConditionalStyles.length&&(m.Format.ConditionalStyles=b.ConditionalStyles),m.Actions={},m.Actions.RaiseItemClick=b.RaiseItemClick,c.push(m));return c},MergeFields:function(a,c){if(c.Visible!=QueryViewerVisible.Never&&(c.Visible=a.Hidden?QueryViewerVisible.No:QueryViewerVisible.Yes,c.Type==QueryViewerElementType.Axis)){c.Axis=a.Axis;if(a.Order)switch(c.AxisOrder.Type){case QueryViewerAxisOrderType.None:case QueryViewerAxisOrderType.Ascending:case QueryViewerAxisOrderType.Descending:c.AxisOrder.Type=
a.Order;break;case QueryViewerAxisOrderType.Custom:a.Order==QueryViewerAxisOrderType.Descending&&c.AxisOrder.Values.reverse()}c.Format.Subtotals!=QueryViewerSubtotals.No&&void 0!=a.Subtotals&&(c.Format.Subtotals=a.Subtotals==QueryViewerSubtotals.Yes?QueryViewerSubtotals.Yes:QueryViewerSubtotals.Hidden);a.Filter&&(c.Filter=a.Filter);a.ExpandCollapse&&(c.ExpandCollapse=a.ExpandCollapse)}},GetOrderedElementsKeys:function(a,c){function d(a,b,f){return Array(b-(""+a).length+1).join(f||"0")+a}for(var b=
[],m=0;m<c.length;m++){var f=c[m],q=a.RealType==QueryViewerOutputType.Table?"0":f.Type==QueryViewerElementType.Axis?"1":"2";if(null!=f.Position){var l;if(a.RealType==QueryViewerOutputType.PivotTable)if(f.Type==QueryViewerElementType.Axis)switch(f.Axis){case QueryViewerAxisType.Columns:l="B";break;case QueryViewerAxisType.Pages:l="C";break;default:l="A"}else l="D";else l="A";q+=l+d(f.Position,4,"0")+d(m,4,"0")}else q+="Z"+d(m,4,"0")+d(m,4,"0");b.push(q)}b.sort();return b},GetContainerControlClass:function(a){return""!=
a.Class?a.Class+"-"+a.RealType.toLowerCase():""},GetContainerControlClasses:function(a){var c=qv.util.GetContainerControlClass(a),d;switch(a.RealType){case QueryViewerOutputType.Card:d="qv-card";break;case QueryViewerOutputType.Chart:d="qv-chart";break;case QueryViewerOutputType.PivotTable:d="qv-pivottable";break;case QueryViewerOutputType.Table:d="qv-table";break;case QueryViewerOutputType.Map:d="qv-map"}""!=c&&(d+=" "+c);return d},SetUserControlClass:function(a,c){a.getContainerControl().className=
"gx_usercontrol "+c},GetElementInCollection:function(a,c,d){for(var b=0;b<a.length;b++){var m=a[b];if(m[c]==d)return m}return null},IsInteger:function(a){return Number.isInteger?Number.isInteger(a):"number"===typeof a&&isFinite(a)&&Math.floor(a)===a},ApplyPicture:function(a,c,d,b){switch(d){case QueryViewerDataType.Integer:case QueryViewerDataType.Real:return qv.util.formatNumber(a,b.DecimalPrecision,c,!1);case QueryViewerDataType.Boolean:case QueryViewerDataType.Character:case QueryViewerDataType.GUID:case QueryViewerDataType.GeoPoint:return qv.util.trim(a);
case QueryViewerDataType.Date:case QueryViewerDataType.DateTime:return qv.util.formatDateTime(a,d,b.DateFormat,b.IncludeHours,b.IncludeMinutes,b.IncludeSeconds,b.IncludeMilliseconds)}},GetPictureProperties:function(a,c){return a==QueryViewerDataType.Integer||a==QueryViewerDataType.Real?qv.util.ParseNumericPicture(a,c):a==QueryViewerDataType.Date||a==QueryViewerDataType.DateTime?qv.util.ParseDateTimePicture(a,c):null},GetAxisByDataField:function(a,c){for(var d=0;d<a.Metadata.Axes.length;d++)if(a.Metadata.Axes[d].DataField==
c)return a.Metadata.Axes[d]},GetThemeStyleSheet:function(a){a._themeStyleSheet||(a._themeStyleSheet=gx.getThemeElement().sheet);return a._themeStyleSheet},GetNullColor:function(){return qv.util.GetColorObject("")},GetColorObject:function(a){return{IsDefault:!1,Color:a,ColorIndex:"-1"}},IsNullColor:function(a){return a.IsDefault?0>a.ColorIndex:""==a.Color},GetQueryViewerStyleSheet:function(a){if(!a._queryViewerStyleSheet){var c=qv.util.GetLinkOrStyleElement("QueryViewer.css").sheet.rules[0];a._queryViewerStyleSheet=
c.styleSheet}return a._queryViewerStyleSheet},GetLinkOrStyleElement:function(a){if(gx.O.DSO)for(var c=document.getElementsByTagName("style"),d=0;d<c.length;d++){if(c[d].attributes["data-gx-href"]&&0<=c[d].attributes["data-gx-href"].value.indexOf(a))return c[d]}else{c=document.getElementsByTagName("link");for(d=0;d<c.length;d++)if(c[d].attributes.href&&0<=c[d].attributes.href.value.indexOf(a))return c[d]}return null},XAxisDataType:function(a){for(var c=0,d="",b=0;b<a.Metadata.Axes.length;b++){var m=
a.Metadata.Axes[b];if(m.Visible==QueryViewerVisible.Yes||m.Visible==QueryViewerVisible.Always)c++,d=m.DataType}return 1==c?d:QueryViewerDataType.Character},ProcessDataAndMetadata:function(a){function c(a){for(var b=0,e=0;e<a.length;e++)"F0"!=a[e].DataField&&b++;return b}function d(a){a.Chart.Categories={};a.Chart.Categories.DataFields=[];for(var b=0;b<a.Metadata.Axes.length;b++){var e=a.Metadata.Axes[b];if(e.Visible==QueryViewerVisible.Yes||e.Visible==QueryViewerVisible.Always)(a.RealType!=QueryViewerOutputType.Map||
e.DataType==QueryViewerDataType.Character)&&a.Chart.Categories.DataFields.push(e.DataField)}a.Chart.Series={};a.Chart.Series.DataFields=[];e=c(a.Metadata.Data);for(b=0;b<a.Metadata.Data.length;b++){var h=a.Metadata.Data[b];(1==e?h.Visible==QueryViewerVisible.Yes||h.Visible==QueryViewerVisible.Always:h.Visible!=QueryViewerVisible.Never)&&a.Chart.Series.DataFields.push(h.DataField)}}function b(a){for(var b={},e=0;e<a.Metadata.Axes.length;e++){var h=a.Metadata.Axes[e],f=qv.util.GetPictureProperties(h.DataType,
h.Picture);b[h.DataField]={Picture:h.Picture,DataType:h.DataType,PictureProperties:f,Filter:h.Filter}}return b}function m(a,b){function e(a,b,h){function g(a){for(var b=!1,e=0;e<a.length;e++)if(f(a[e].StyleOrClass,!1)[0]){b=!0;break}return b}var c;if(a.RealType==QueryViewerOutputType.Map&&(a.MapType==QueryViewerMapType.Choropleth&&""!=a.Chart.colorAxis||a.MapType==QueryViewerMapType.Bubble&&""!=a.Chart.colorAxis))c=!1;else if(a.RealType==QueryViewerOutputType.Map&&(a.MapType==QueryViewerMapType.Choropleth&&
0==a.Chart.colorAxis.dataClasses.length||a.MapType==QueryViewerMapType.Bubble&&0==a.Chart.colorAxis.dataClasses.length))c=!0;a.RealType==QueryViewerOutputType.Chart&&(qv.chart.IsSingleSerieChart(a)||a.RealChartType==QueryViewerChartType.PolarArea&&1==a.Chart.Series.DataFields.length)?c=!0:a.RealType==QueryViewerOutputType.Chart&&(qv.chart.IsAreaChart(a)||qv.chart.IsLineChart(a)||a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar)?c=!1:a.RealType==QueryViewerOutputType.Chart&&
1<a.Chart.Series.DataFields.length&&!qv.chart.IsSplittedChart(a)?c=!1:(a=g(b.ConditionalStyles),b=!1,null!=h&&(b=g(h.ValuesStyles)),c=a||b);return c}for(var h={},g=c(a.Metadata.Data),n=0;n<a.Metadata.Data.length;n++){var o=a.Metadata.Data[n];if(1==g?o.Visible==QueryViewerVisible.Yes||o.Visible==QueryViewerVisible.Always:o.Visible!=QueryViewerVisible.Never){var k=e(a,o,b);h[o.DataField]={Datum:o,Multicolored:k}}}return h}function f(a,b){var e="",h=!1,f=b?"backgroundcolor":"color";if(""!=a){for(var g=
a.split(";"),c=0;c<g.length;c++){var n=g[c].split(":");if(2==n.length){var o=qv.util.trim(n[0]),n=qv.util.trim(n[1]);if(o.toLowerCase()==f){e=n;h=""!=n;break}}}h&&"#"==e.substr(0,1)&&(e=e.replace("#",""))}return[h,e]}function q(a,b,e,h,g,c,n){function o(a,b){for(var e=[!1,""],h=0;h<a.ValuesStyles.length;h++){var g=a.ValuesStyles[h];if(g.Value==b){e=f(g.StyleOrClass,!1);break}}return e}function k(a,b){for(var e=[!1,""],h=!1,g=0;g<a.ConditionalStyles.length;g++){var c=a.ConditionalStyles[g];if(h=qv.util.satisfyStyle(b,
c)){e=f(c.StyleOrClass,!1);break}}return e}var u,d=-1,l=!1;if(a){if(a=!1,null!=e&&(e=o(e,c),a=e[0],u=e[1]),!a)e=k(b,n),a=e[0],u=e[1],a||(d=g%HIGHCHARTS_MAX_COLORS,l=!0)}else e=f(b.Style,!1),a=e[0],u=e[1],a||(d=h%HIGHCHARTS_MAX_COLORS,l=!0);return{IsDefault:l,Color:u,ColorIndex:d}}function l(a,b,e,h){for(var f="",g="",c=0;c<a.Chart.Categories.DataFields.length;c++){var n=a.Chart.Categories.DataFields[c],o;void 0!=b[n]?(o=qv.util.trim(b[n]),n=qv.util.ApplyPicture(o,h[n].Picture,h[n].DataType,h[n].PictureProperties)):
n=o=a.Metadata.TextForNullValues;f+=(""==f?"":", ")+o;g+=(""==g?"":", ")+n}b=[f,g];h={};h.Value=b[0];h.ValueWithPicture=b[1];a.Chart.Categories.Values.push(h);if(0==e)a.Chart.Categories.MinValue=h.Value,a.Chart.Categories.MaxValue=h.Value;else if(h.Value>a.Chart.Categories.MaxValue&&(a.Chart.Categories.MaxValue=h.Value),h.Value<a.Chart.Categories.MinValue)a.Chart.Categories.MinValue=h.Value}function v(a,b,e,h,f){for(var g=0;g<a.Chart.Series.DataFields.length;g++){var c=a.Chart.Series.ByIndex[g],n=
a.Chart.Series.DataFields[g],o=void 0!=b[n]?b[n]:null,u={};u.Value=o;var k=h[n].Datum,d=h[n].Multicolored;if(k.Aggregation==QueryViewerAggregationType.Average){var l=b[n+"_N"],n=b[n+"_D"];void 0==l&&void 0==n&&(l=o,n="1");u.Value_N=l;u.Value_D=n}u.Color=d?q(d,k,f,0,e,a.Chart.Categories.Values[e].Value,o):qv.util.GetNullColor();c.Points.push(u);0<u.Value&&(c.PositiveValues=!0);0>u.Value&&(c.NegativeValues=!0);if(0===e)c.MinValue=parseFloat(u.Value),c.MaxValue=parseFloat(u.Value);else if(parseFloat(u.Value)>
c.MaxValue&&(c.MaxValue=parseFloat(u.Value)),parseFloat(u.Value)<c.MinValue)c.MinValue=parseFloat(u.Value)}}function s(a,b){for(var e=0;e<b.ConditionalStyles.length;e++){var h=b.ConditionalStyles[e],g=f(h.StyleOrClass,!0),c=g[1];if(g[0]){plotBand={};plotBand.Color=qv.util.GetColorObject(c);if(h.Operator==QueryViewerConditionOperator.Interval)plotBand.From=parseFloat(h.Value1),plotBand.To=parseFloat(h.Value2);else if(h.Operator==QueryViewerConditionOperator.Equal)plotBand.From=parseFloat(h.Value1),
plotBand.To=parseFloat(h.Value1);else if(h.Operator==QueryViewerConditionOperator.GreaterOrEqual||h.Operator==QueryViewerConditionOperator.GreaterThan)plotBand.From=parseFloat(h.Value1);else if(h.Operator==QueryViewerConditionOperator.LessOrEqual||h.Operator==QueryViewerConditionOperator.LessThan)plotBand.To=parseFloat(h.Value1);plotBand.SeriesName=""!=b.Title?b.Title:b.Name;a.Chart.PlotBands.push(plotBand)}}}function r(a,b){for(var e=!1,h=0;h<a.Metadata.Axes.length;h++){var g=a.Metadata.Axes[h];
if(g.Visible==QueryViewerVisible.Yes||g.Visible==QueryViewerVisible.Always){var c=qv.util.trim(b[g.DataField]);if(g.Filter.Type==QueryViewerFilterType.HideAllValues){e=!0;break}else if(g.Filter.Type==QueryViewerFilterType.ShowSomeValues&&0>g.Filter.Values.indexOf(c)){e=!0;break}if(a.RealType===QueryViewerOutputType.Map&&g.DataType===QueryViewerDataType.Character)if(a.Region===QueryViewerRegion.Country){if(!qv.util.startsWith(c.toUpperCase(),a.Country+"-")){e=!0;break}}else if(a.Region===QueryViewerRegion.Continent)switch(a.Continent){case QueryViewerContinent.Africa:e=
!qv.map.IsAfricanCountry(c.toUpperCase());break;case QueryViewerContinent.Asia:e=!qv.map.IsAsianCountry(c.toUpperCase());break;case QueryViewerContinent.Europe:e=!qv.map.IsEuropeanCountry(c.toUpperCase());break;case QueryViewerContinent.NorthAmerica:e=!qv.map.IsNorthAmericanCountry(c.toUpperCase());break;case QueryViewerContinent.Oceania:e=!qv.map.IsOceanianCountry(c.toUpperCase());break;case QueryViewerContinent.SouthAmerica:e=!qv.map.IsSouthAmericanCountry(c.toUpperCase());break;default:e=!0}}}return e}
function h(a){0>=a.TargetValue&&(a.TargetValue=100);0>=a.MaximumValue&&(a.MaximumValue=100);a.MaximumValue<a.TargetValue&&(a.MaximumValue=a.TargetValue)}function u(a){for(var b=[],e=[],h="",g=0;g<a.Points.length;g++){var c,f;a.Aggregation==QueryViewerAggregationType.Count?(c=0,f=parseFloat(qv.util.trim(a.Points[g].Value))):a.Aggregation==QueryViewerAggregationType.Average?(c=parseFloat(qv.util.trim(a.Points[g].Value_N)),f=parseFloat(qv.util.trim(a.Points[g].Value_D))):(c=parseFloat(qv.util.trim(a.Points[g].Value)),
f=1);b.push(c);e.push(f);""==h&&(h=a.Points[g].Color)}b=qv.util.aggregate(a.Aggregation,b,e).toString();a.Points=[{Value:b,Value_N:b,Value_D:"1",Color:h}];a.NegativeValues=0>b;a.PositiveValues=0<b}function n(a,b){a.Chart.colorAxis=a.Chart.colorAxis||{};a.Chart.colorAxis.dataClasses=a.Chart.colorAxis.dataClasses||[];for(var e=0;e<b.ConditionalStyles.length;e++){var h=b.ConditionalStyles[e];colorAxis={dataClasses:[]};var g={};g.color=h.StyleOrClass.replace("color:","");h.Operator==QueryViewerConditionOperator.Interval?
(g.from=parseFloat(h.Value1),g.to=parseFloat(h.Value2),g.Operator=QueryViewerConditionOperatorSymbol.Interval):h.Operator==QueryViewerConditionOperator.Equal?(g.from=parseFloat(h.Value1),g.Operator=QueryViewerConditionOperatorSymbol.Equal):h.Operator==QueryViewerConditionOperator.GreaterOrEqual?(g.from=parseFloat(h.Value1),g.Operator=QueryViewerConditionOperatorSymbol.GreaterOrEqual):h.Operator==QueryViewerConditionOperator.GreaterThan?(g.from=parseFloat(h.Value1),g.Operator=QueryViewerConditionOperatorSymbol.GreaterThan):
h.Operator==QueryViewerConditionOperator.LessThan?(g.to=parseFloat(h.Value1),g.Operator=QueryViewerConditionOperatorSymbol.LessThan):h.Operator==QueryViewerConditionOperator.LessOrEqual?(g.to=parseFloat(h.Value1),g.Operator=QueryViewerConditionOperatorSymbol.LessOrEqual):h.Operator==QueryViewerConditionOperator.NotEqual&&(g.from=parseFloat(h.Value1),g.Operator=QueryViewerConditionOperatorSymbol.NotEqual);a.Chart.colorAxis.dataClasses.push(g)}}var z=function(a){var b=qv.util.XAxisDataType(a),e;switch(a.RealType){case QueryViewerOutputType.Chart:a=
qv.chart.IsDatetimeXAxis(a)?b==QueryViewerDataType.Date||b==QueryViewerDataType.DateTime:!0;e="GXPL_QViewerNoDatetimeAxis";break;case QueryViewerOutputType.Map:a=b==QueryViewerDataType.GeoPoint||b==QueryViewerDataType.Character;e="GXPL_QViewerNoMapAxis";break;default:a=!0}return{IsOK:a,Error:a?"":gx.getMessage(e)}}(a);if(z.IsOK){a.Chart={};d(a);a.Chart.Categories.MinValue=null;a.Chart.Categories.MaxValue=null;a.Chart.Categories.Values=[];z=b(a);a.Chart.Series.ByIndex=[];var e=1==a.Chart.Categories.DataFields.length?
qv.util.GetAxisByDataField(a,a.Chart.Categories.DataFields[0]):null,g=m(a,e);a.Chart.PlotBands=[];for(var C=0;C<a.Chart.Series.DataFields.length;C++){var E=a.Chart.Series.DataFields[C],o=g[E].Datum,k={MinValue:null,MaxValue:null},E=g[E].Multicolored;k.FieldName=o.Name;k.Name=o.Title;k.Visible=o.Visible;k.DataType=o.DataType;k.Aggregation=o.Aggregation;var F=o.Picture;k.Picture=""==F?k.DataType==QueryViewerDataType.Integer?"ZZZZZZZZZZZZZZ9":"ZZZZZZZZZZZZZZ9.99":F;k.NumberFormat=qv.util.ParseNumericPicture(k.DataType,
k.Picture);k.Color=E?qv.util.GetNullColor():q(E,o,e,C,0,"",0);k.TargetValue=o.TargetValue;k.MaximumValue=o.MaximumValue;h(k);k.PositiveValues=!1;k.NegativeValues=!1;k.Points=[];a.Chart.Series.ByIndex.push(k);a.RealType==QueryViewerOutputType.Chart&&s(a,o);a.RealType==QueryViewerOutputType.Map&&n(a,o)}for(C=o=0;C<a.Data.Rows.length;C++)k=a.Data.Rows[C],r(a,k)||(l(a,k,o,z),v(a,k,o,g,e),o++);if(a.RealType==QueryViewerOutputType.Chart&&qv.chart.IsGaugeChart(a))for(C=0;C<a.Chart.Series.DataFields.length;C++)k=
a.Chart.Series.ByIndex[C],u(k);return""}return z.Error},getTranslation:function(a){return qv.TranslationType==QueryViewerTranslationType.RunTime?gx.getMessage(a):a},getTranslationAlsoIfStatic:function(a){return qv.TranslationType==QueryViewerTranslationType.RunTime||qv.TranslationType==QueryViewerTranslationType.Static?gx.getMessage(a):a},aggregateData:function(a,c){for(var d={},b=0;b<a.length;b++){var m=a[b],f;f=m;for(var q=c,l=[],v=[],s=[],r=0;r<q.length;r++){var h=q[r];if(f.IsFormula){var u=0;
do{u++;var n=h[f.DataField+"_"+u.toString()];void 0!=n&&(n=parseFloat(n),0==r?s.push(n):s[u-1]+=n)}while(void 0!=n)}else f.Aggregation==QueryViewerAggregationType.Count?(u=0,h=parseFloat(h[f.DataField])):f.Aggregation==QueryViewerAggregationType.Average?(u=parseFloat(h[f.DataField+"_N"]),h=parseFloat(h[f.DataField+"_D"])):(u=parseFloat(h[f.DataField]),h=1),l.push(u),v.push(h)}f=f.IsFormula?qv.util.evaluate(f.Formula,f.DataField+"_",s):qv.util.aggregate(f.Aggregation,l,v).toString();d[m.DataField]=
f}return d}};var STATE_DONE=4,STATUS_OK=200,METADATA_VERSION=2;
qv.services=function(){function a(a){return eval(a)[1].replace(/\\/g,".")}function c(a,b){var c=qv.services.RuntimeFieldsJSON(a),d=qv.services.RuntimeParametersJSON(a),s="",m="",h;a:switch(a.RealType){case QueryViewerOutputType.Table:h="IgnoreType";break a;case QueryViewerOutputType.Chart:case QueryViewerOutputType.Card:h="IgnoreTypeAndAxis";break a;default:h="IgnoreNot"}""!=a.QueryInfo&&(m=eval("("+a.QueryInfo+")"),s=m.TextForNullValues,m=gx.json.serializeJson(m.Fields));return a.ObjectName!=b.ObjectName||
a.ObjectType!=b.ObjectType||a.ObjectId!=b.ObjectId||a.Object!=b.Object||c!=b.RuntimeFieldsJSON||d!=b.RuntimeParametersJSON||s!=b.QueryInfoTextForNullValues||m!=b.QueryInfoFieldsJSON||h!=b.MetadataType?(b.ObjectName=a.ObjectName,b.ObjectType=a.ObjectType,b.ObjectId=a.ObjectId,b.Object=a.Object,b.RuntimeFieldsJSON=c,b.RuntimeParametersJSON=d,b.QueryInfoTextForNullValues=s,b.QueryInfoFieldsJSON=m,b.MetadataType=h,!0):!1}function d(a,c){function d(a,e,h){for(var a=b(a),c=0;c<e.length;c++){var f=e[c],
n="";void 0!=f[h]&&(n=f[h].Type);""!=n&&(n=qv.services.postInfo._priv.SdtWithValuesJSON("Order",n,QueryViewerAxisOrderType.Custom,f[h].Values,!1),a+=","+n);void 0!=f.Analytics&&(a+=","+f.Analytics.ShowValuesAs,a+=","+f.Analytics.RollingAverageType,a+=","+f.Analytics.RollingAverageTerms,a+=","+f.Analytics.DifferenceFrom,a+=","+f.Analytics.ShowAsPercentage)}return a}var m=qv.services.RuntimeParametersJSON(a),s=d(a,a.Axes,"AxisOrder"),r="",h="",u="",n=a.RealType==QueryViewerOutputType.Table?"PagedRecordSet":
a.RealType==QueryViewerOutputType.PivotTable?"PagedLineSet":"NotPaged";""!=a.QueryInfo&&(u=eval("("+a.QueryInfo+")"),r=u.SQLSentence,h=gx.json.serializeJson(u.Parameters),u=d(a,u.Fields,"Order"));return a.ObjectName!=c.ObjectName||a.ObjectType!=c.ObjectType||a.ObjectId!=c.ObjectId||a.Object!=c.Object||m!=c.RuntimeParametersJSON||s!=c.FieldsJSON||r!=c.QueryInfoSQLSentence||h!=c.QueryInfoParametersJSON||u!=c.QueryInfoFieldsJSON||n!=c.DataType?(c.ObjectName=a.ObjectName,c.ObjectType=a.ObjectType,c.ObjectId=
a.ObjectId,c.Object=a.Object,c.RuntimeParametersJSON=m,c.FieldsJSON=s,c.QueryInfoSQLSentence=r,c.QueryInfoParametersJSON=h,c.QueryInfoFieldsJSON=u,c.DataType=n,!0):!1}function b(a){return a.RealType==QueryViewerOutputType.Chart&&qv.chart.IsDatetimeXAxis(a)||a.RealType==QueryViewerOutputType.Card&&(a.IncludeSparkline||a.IncludeTrend)}function m(a,b){return{Success:a,Message:b}}return{url:function(){function a(b,f){var d=qv.util.getGenerator(),h;h=(new Date).getTime();var u=b.enableServerDebug?"_debug":
"";switch(d){case "C#":var d=new gx.util.Url(location.href),n=d.path,n=n.substr(0,n.lastIndexOf("/")+1);urlresult=""==d.port?d.protocol+"://"+d.host+n:d.protocol+"://"+d.host+":"+d.port+n;return urlresult+"agxpl_get"+u+".aspx?"+f+","+h;case "Java":return c(!1)+"qviewer.services.agxpl_get"+u+"?"+f+","+h;default:return""}}function b(){var a;a=""!=gx.staticDirectory?gx.staticDirectory:this.getCookie("StaticContent");return qv.util.startsWith(a,"/")?a.substr(1,a.length-1):a}function c(a){var f=gx.util.resourceUrl(gx.basePath,
!0);a&&(f+=b());return f}return{getDefaultOutputURL:function(b){return a(b,"defaultoutput")},getRecordsetCacheKeyURL:function(b){return a(b,"recordsetcachekey")},getMetadataURL:function(b){return a(b,"metadata")},getDataURL:function(b){return a(b,"data")},getAttributeValuesURL:function(b){return a(b,"attributevalues")},getPageDataForTableURL:function(b){return a(b,"pagedatafortable")},getPageDataForPivotTableURL:function(b){return a(b,"pagedataforpivottable")},getQueryParametersURL:function(b){return a(b,
"queryparameters")},getDashboardSpecURL:function(b){return a(b,"dashboardspec")},getStaticDirectory:function(){return"Java"===qv.util.getGenerator()?c(!0):b()}}}(),postInfo:function(){function c(a,b){var f="",l,e,g,m,s,o,k,F,r,p,B,w,v,N,H,t;l=!1;for(i=0;void 0!=a.Axes[i];i++){l=!0;f+=""!=f?",":"";f+="{";e="";m=g=0;o=s="";F=k=!0;p=r="";B=0;t=H=N=v=w="";var G;G=a.Axes[i];var y="",A=!1;if(void 0!=G.Format&&void 0!=G.Format.ValuesStyles)for(var x=0;void 0!=G.Format.ValuesStyles[x];x++)A=!0,y+=""!=y?",":
"",y+="{",y+='"Value":"'+encodeURIComponent(G.Format.ValuesStyles[x].Value)+'"',y+=",",y+='"Style":"'+encodeURIComponent(G.Format.ValuesStyles[x].StyleOrClass)+'"',y+=",",y+='"Propagate":'+(G.Format.ValuesStyles[x].ApplyToRowOrColumn?"true":"false"),y+="}";A&&(y='"ValuesStyles":['+y+"]");G=y;y=a.Axes[i];A="";x=!1;if(void 0!=y.Format&&void 0!=y.Format.ConditionalStyles)for(var K=0;void 0!=y.Format.ConditionalStyles[K];K++)x=!0,A+=""!=A?",":"",A+="{",A+='"Operator":"'+y.Format.ConditionalStyles[K].Operator+
'"',A+=",",A+='"Value1":"'+encodeURIComponent(y.Format.ConditionalStyles[K].Value1)+'"',y.Format.ConditionalStyles[K].Operator==QueryViewerConditionOperator.Interval&&(A+=",",A+='"Value2":"'+encodeURIComponent(y.Format.ConditionalStyles[K].Value2)+'"'),A+=",",A+='"Style":"'+encodeURIComponent(y.Format.ConditionalStyles[K].StyleOrClass)+'"',A+="}";x&&(A='"ConditionalStyles":['+A+"]");y=A;A=a.Axes[i];x="";void 0!=A.Grouping&&(x+="{",x+='"GroupByYear":'+(A.Grouping.GroupByYear?"true":"false"),x+=",",
x+='"YearTitle":"'+A.Grouping.YearTitle+'"',x+=",",x+='"GroupBySemester":'+(A.Grouping.GroupBySemester?"true":"false"),x+=",",x+='"SemesterTitle":"'+A.Grouping.SemesterTitle+'"',x+=",",x+='"GroupByQuarter":'+(A.Grouping.GroupByQuarter?"true":"false"),x+=",",x+='"QuarterTitle":"'+A.Grouping.QuarterTitle+'"',x+=",",x+='"GroupByMonth":'+(A.Grouping.GroupByMonth?"true":"false"),x+=",",x+='"MonthTitle":"'+A.Grouping.MonthTitle+'"',x+=",",x+='"GroupByDayOfWeek":'+(A.Grouping.GroupByDayOfWeek?"true":"false"),
x+=",",x+='"DayOfWeekTitle":"'+A.Grouping.DayOfWeekTitle+'"',x+=",",x+='"HideValue":'+(A.Grouping.HideValue?"true":"false"),x+="}",x='"Grouping":'+x);A=x;void 0!=a.Axes[i].Format&&(e=a.Axes[i].Format.Picture?a.Axes[i].Format.Picture:"",g=a.Axes[i].Format.TargetValue?a.Axes[i].Format.TargetValue:0,m=a.Axes[i].Format.MaximumValue?a.Axes[i].Format.MaximumValue:0,s=a.Axes[i].Format.Style?a.Axes[i].Format.Style:"",o=a.Axes[i].Format.Subtotals?a.Axes[i].Format.Subtotals:"",k=void 0!=a.Axes[i].Format.CanDragToPages?
a.Axes[i].Format.CanDragToPages:!0);void 0!=a.Axes[i].Actions&&(F=a.Axes[i].Actions.RaiseItemClick);void 0!=a.Axes[i].Analytics&&(r=a.Axes[i].Analytics.ShowValuesAs,p=a.Axes[i].Analytics.RollingAverageType,B=a.Axes[i].Analytics.RollingAverageTerms,w=a.Axes[i].Analytics.DifferenceFrom,v=a.Axes[i].Analytics.ShowAsPercentage);void 0!=a.Axes[i].AxisOrder&&(N=a.Axes[i].AxisOrder.Type);void 0!=a.Axes[i].ExpandCollapse&&(H=a.Axes[i].ExpandCollapse.Type);void 0!=a.Axes[i].Filter&&(t=a.Axes[i].Filter.Type);
void 0==t&&(t=QueryViewerFilterType.ShowSomeValues);f+='"Name":"'+encodeURIComponent(a.Axes[i].Name)+'"';f+=",";f+='"Caption":"'+encodeURIComponent(a.Axes[i].Title)+'"';f+=",";f+='"Aggregation":"'+a.Axes[i].Aggregation+'"';f+=",";f+='"Visible":"'+a.Axes[i].Visible+'"';f+=",";f+='"Type":"'+a.Axes[i].Type+'"';f+=",";f+='"Axis":"'+a.Axes[i].Axis+'"';f+=",";f+='"Picture":"'+encodeURIComponent(e)+'"';f+=",";f+='"TargetValue":'+g;f+=",";f+='"MaximumValue":'+m;f+=",";f+='"Style":"'+s+'"';f+=",";f+='"Subtotals":"'+
o+'"';f+=",";f+='"CanDragToPages":'+k;f+=",";f+='"RaiseItemClick":'+F;""!=r&&(f+=",",f+='"Analytics":{',f+='"ShowValuesAs":"'+r+'"',f+=",",f+='"RollingAverageType":"'+p+'"',f+=",",f+='"RollingAverageTerms":'+B,f+=",",f+='"DifferenceFrom":"'+w+'"',f+=",",f+='"ShowAsPercentage":"'+v+'"',f+="}");""!=N&&(e=d("Order",N,QueryViewerAxisOrderType.Custom,a.Axes[i].AxisOrder.Values,b),f+=""!=e?","+e:"");""!=H&&(H=d("ExpandCollapse",H,QueryViewerExpandCollapseType.ExpandSomeValues,a.Axes[i].ExpandCollapse.Values,
b),f+=""!=H?","+H:"");""!=t&&a.Axes[i].Filter.Values&&(t=d("Filter",t,QueryViewerFilterType.ShowSomeValues,a.Axes[i].Filter.Values,b),f+=""!=t?","+t:"");f+=""!=G?","+G:"";f+=""!=y?","+y:"";f+=""!=A?","+A:"";f+="}"}l&&(f='"RuntimeFields":['+f+"]");return f}function d(a,b,f,c,e){var g="";if(""!=b){g=g+('"'+a+'":')+"{"+('"Type":"'+b+'"');strValues="";if(b==f){existValues=!1;for(j=0;void 0!=c[j];j++)existValues=!0,strValues+=""!=strValues?",":"",strValues=e?strValues+('"'+encodeURIComponent(c[j])+'"'):
strValues+('"'+c[j]+'"');existValues&&(strValues=',"Values":['+strValues+"]")}g+=strValues;g+="}"}return g}function l(a){var b="",f=!1;if(a.Object){a=eval(a.Object);for(i=2;i<a.length;i++)f=!0,b+=""!=b?",":"",b+="{",b+='"Value":"'+encodeURIComponent(a[i])+'"',b+="}"}else for(i=0;void 0!=a.Parameters[i];i++)f=!0,b+=""!=b?",":"",b+="{",b+='"Name":"'+a.Parameters[i].Name+'"',b+=",",b+='"Value":"'+encodeURIComponent(a.Parameters[i].Value)+'"',b+="}";f&&(b='"RuntimeParameters":['+b+"]");return b}function m(a){var b=
"",f=!1;for(i=0;void 0!=a[i];i++){f=!0;b+=""!=b?",":"";b+="{";b+='"DataField":"'+a[i].DataField+'"';b+=",";b+='"NullIncluded":'+a[i].NullIncluded;strIncludedValues="";existValues=!1;for(j=0;void 0!=a[i].NotNullValues.Included[j];j++)existValues=!0,strIncludedValues+=""!=strIncludedValues?",":"",strIncludedValues+='"'+encodeURIComponent(a[i].NotNullValues.Included[j])+'"';existValues&&(strIncludedValues=',"Included":['+strIncludedValues+"]");strExcludedValues="";existValues=!1;for(j=0;void 0!=a[i].NotNullValues.Excluded[j];j++)existValues=
!0,strExcludedValues+=""!=strExcludedValues?",":"",strExcludedValues+='"'+encodeURIComponent(a[i].NotNullValues.Excluded[j])+'"';existValues&&(strExcludedValues=',"Excluded":['+strExcludedValues+"]");b+=",";b+='"NotNullValues":{"DefaultAction":"'+a[i].NotNullValues.DefaultAction+'"'+strIncludedValues+strExcludedValues+"}";b+="}"}f&&(b='"Filters":['+b+"]");return b}function s(a){return a.UseRecordsetCache?'{"ActualKey":"'+a.RecordsetCache.ActualKey+'","OldKey":"'+a.RecordsetCache.OldKey+'","MinutesToKeep":'+
a.MinutesToKeepInRecordsetCache+',"MaximumSize":'+a.MaximumCacheSize+"}":'{"ActualKey":"","OldKey":"","MinutesToKeep":0,"MaximumSize":0}'}function r(b){var f;f=""+(""!=b.ParentObject.PackageName?'"ApplicationNamespace":"'+b.ParentObject.PackageName+'",':"");b.Object?f+='"ObjectName":"'+a(b.Object)+'"':(f+='"ObjectName":"'+b.ObjectName+'"',f=f+","+('"Alt_ObjectType":"'+b.ObjectType+'"'),f=f+","+('"Alt_ObjectId":'+b.ObjectId));return f}return{DefaultOutput:function(a){var b;b="{"+r(a);b+=""!=a.ObjectInfo?
',"ObjectInfo":'+a.ObjectInfo:"";return"Data="+encodeURIComponent(b+"}")},RecordsetCacheKey:function(a){a="{"+r(a);return"Data="+encodeURIComponent(a+"}")},Metadata:function(a){var b="",d=l(a),m=c(a,!0),b=b+"{"+r(a),b=b+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),b=b+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),b=b+(""!=d?","+d:"")+(""!=m?","+m:"")+","+('"OutputType":"'+a.RealType+'"'),b=b+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),b=b+","+('"RememberLayout":'+a.RememberLayout),
b=b+","+('"ShowDataLabelsIn":"'+a.ShowDataLabelsIn+'"'),b=b+","+('"RecordsetCacheInfo":'+s(a)),b=b+","+('"ReturnSampleData":'+a.ReturnSampleData),b=b+","+('"TranslationType":"'+a.TranslationType+'"');return"Data="+encodeURIComponent(b+"}")},Data:function(a){var d="",m=l(a),q=c(a,!0),d=d+"{"+r(a),d=d+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),d=d+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),d=d+(""!=m?","+m:"")+(""!=q?","+q:"")+","+('"OutputType":"'+a.RealType+'"'),d=d+","+('"SortAscendingForced":'+
b(a)),d=d+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),d=d+","+('"RecordsetCacheInfo":'+s(a)),d=d+","+('"ReturnSampleData":'+a.ReturnSampleData),d=d+","+('"TranslationType":"'+a.TranslationType+'"');return"Data="+encodeURIComponent(d+"}")},AttributeValues:function(a,b,d,m,e){var g="",C=l(a),q=c(a,!0),g=g+"{"+r(a),g=g+","+('"DataField":"'+b+'"')+","+('"PageNumber":'+d)+","+('"PageSize":'+m)+","+('"Filter":"'+e+'"')+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),g=g+(""!=a.AppSettings?
',"AppSettings":'+a.AppSettings:""),g=g+(""!=C?","+C:"")+(""!=q?","+q:"")+","+('"OutputType":"'+a.RealType+'"'),g=g+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),g=g+","+('"RecordsetCacheInfo":'+s(a)),g=g+","+('"ReturnSampleData":'+a.ReturnSampleData),g=g+","+('"TranslationType":"'+a.TranslationType+'"');return"Data="+encodeURIComponent(g+"}")},TablePageData:function(a,b,d,q,e,g,C,E){var o="",k=l(a),F=c(a,!0),C=m(C),o=o+"{"+r(a),o=o+","+('"PageNumber":'+b)+","+('"PageSize":'+(gx.lang.gxBoolean(a.Paging)?
d:0)),o=o+","+('"ReturnTotPages":'+q)+","+('"Order":'+('{"DataField":"'+e+'","Type":"'+g+'"}'))+(""!=C?","+C:"")+(""!=a.QueryInfo?',"QueryInfo":'+a.QueryInfo:""),o=o+(""!=a.AppSettings?',"AppSettings":'+a.AppSettings:""),o=o+(""!=k?","+k:"")+(""!=F?","+F:"")+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange),o=o+","+('"RecordsetCacheInfo":'+s(a)),o=o+","+('"LayoutChanged":'+E)+","+('"ReturnSampleData":'+a.ReturnSampleData),o=o+","+('"TranslationType":"'+a.TranslationType+'"');return"Data="+
encodeURIComponent(o+"}")},PivotTablePageData:function(a,b,d,q,e,g,C,E,o){for(var k="",F=l(a),M=c(a,!0),p="",B=!1,w=0;void 0!=e[w];w++)B=!0,p+=""!=p?",":"",p+="{",p+='"DataField":"'+e[w].DataField+'"',p+=",",p+='"Visible":'+!e[w].Hidden,p+=",",p+='"Axis":"'+e[w].Axis.Type+'"',p+=",",p+='"Position":'+(qv.util.IsInteger(e[w].Axis.Position)?e[w].Axis.Position:0),p+=",",p+='"Order":"'+e[w].Order+'"',p+=",",p+='"Subtotals":'+e[w].Subtotals,p+="}";B&&(p='"AxesInfo":['+p+"]");e=p;p="";B=!1;for(w=0;void 0!=
g[w];w++)B=!0,p+=""!=p?",":"",p+="{",p+='"DataField":"'+g[w].DataField+'"',p+=",",p+='"Visible":'+!g[w].Hidden,p+=",",p+='"Position":'+(qv.util.IsInteger(g[w].Position)?g[w].Position:0),p+="}";B&&(p='"DataInfo":['+p+"]");g=p;C=m(C);p="";B=!1;for(w=0;void 0!=E[w];w++){B=!0;p+=""!=p?",":"";p+="{";p+='"DataField":"'+E[w].DataField+'"';p+=",";p+='"NullExpanded":'+E[w].NullExpanded;strExpandedValues="";existValues=!1;for(var J=0;void 0!=E[w].NotNullValues.Expanded[J];J++)existValues=!0,strExpandedValues+=
""!=strExpandedValues?",":"",strExpandedValues+='"'+encodeURIComponent(E[w].NotNullValues.Expanded[J])+'"';existValues&&(strExpandedValues=',"Expanded":['+strExpandedValues+"]");strCollapsedValues="";existValues=!1;for(J=0;void 0!=E[w].NotNullValues.Collapsed[J];J++)existValues=!0,strCollapsedValues+=""!=strCollapsedValues?",":"",strCollapsedValues+='"'+encodeURIComponent(E[w].NotNullValues.Collapsed[J])+'"';existValues&&(strCollapsedValues=',"Collapsed":['+strCollapsedValues+"]");p+=",";p+='"NotNullValues":{"DefaultAction":"'+
E[w].NotNullValues.DefaultAction+'"'+strExpandedValues+strCollapsedValues+"}";p+="}"}B&&(p='"ExpandCollapse":['+p+"]");E=p;k=k+"{"+r(a);k=k+","+('"PageNumber":'+b)+","+('"PageSize":'+(gx.lang.gxBoolean(a.Paging)?d:0));k=k+","+('"ReturnTotPages":'+q)+","+('"ShowDataLabelsIn":"'+a.ShowDataLabelsIn+'"');k=k+","+('"TotalForRows":"'+a.TotalForRows+'"');k=k+","+('"TotalForColumns":"'+a.TotalForColumns+'"');k=k+(""!=e?","+e:"")+(""!=g?","+g:"")+(""!=C?","+C:"")+(""!=E?","+E:"")+(""!=a.QueryInfo?',"QueryInfo":'+
a.QueryInfo:"");k+=""!=a.AppSettings?',"AppSettings":'+a.AppSettings:"";k=k+(""!=F?","+F:"")+(""!=M?","+M:"")+","+('"AllowElementsOrderChange":'+a.AllowElementsOrderChange);k=k+","+('"RecordsetCacheInfo":'+s(a));k=k+","+('"LayoutChanged":'+o)+","+('"ReturnSampleData":'+a.ReturnSampleData);k=k+","+('"TranslationType":"'+a.TranslationType+'"');return"Data="+encodeURIComponent(k+"}")},getQueryParameters:function(a){var b;b="{"+r(a);b+=""!=a.ObjectInfo?',"ObjectInfo":'+a.ObjectInfo:"";return"Data="+encodeURIComponent(b+
"}")},DashboardSpec:function(b){var f="";b.Object&&(f=a(b.Object));b=JSON.stringify({ApplicationNamespace:b.ParentObject.PackageName,ObjectName:f,Alt_ObjectId:0});return"Data="+encodeURIComponent(b)},_priv:{RuntimeParametersJSON:function(a){return l(a)},RuntimeFieldsJSON:function(a){return c(a)},SdtWithValuesJSON:function(a,b,f,c,e){return d(a,b,f,c,e)}}}}(),RuntimeParametersJSON:function(a){return this.postInfo._priv.RuntimeParametersJSON(a)},RuntimeFieldsJSON:function(a,b){return this.postInfo._priv.RuntimeFieldsJSON(a,
b)},getXMLHttpRequest:function(){if(window.XMLHttpRequest)return new window.XMLHttpRequest;try{return new ActiveXObject("MSXML2.XMLHTTP.3.0")}catch(a){return null}},CallServerSync:function(a,b,c,d){d=d||[];d.unshift(a);a=b.call(qv.services.url,a);c=c.apply(qv.services.postInfo,d);d=qv.services.getXMLHttpRequest();d.open("POST",a,!1);d.setRequestHeader("Content-Type","application/x-www-form-urlencoded");d.send(c);return d.responseText},createAsyncServerCallFn:function(a,b,c,d,m){return function(r,
h){h=h||[];h.unshift(a);var u=function(b){m&&a.RealType!=QueryViewerOutputType.Card&&(b=m.call(qv.util.css,b));r(b,a)};if(gx.lang.gxBoolean(a.IsExternalQuery))u(a.ExternalQueryResultObj()[d]);else{var n=b.call(qv.services.url,a),z=c.apply(qv.services.postInfo,h),e=qv.services.getXMLHttpRequest(),g=function(){e.readyState==STATE_DONE&&e.status==STATUS_OK&&u(e.responseText)};gx.util.browser.isIE()?e.onreadystatechange=g:e.onload=g;e.open("POST",n);e.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
e.send(z)}}},parseRecordsetCacheKeyXML:function(a){""!=a.xml.recordsetCacheKey&&(a.RecordsetCache=a.RecordsetCache||{},a.RecordsetCache.OldKey=a.RecordsetCache.ActualKey?a.RecordsetCache.ActualKey:"",a.RecordsetCache.ActualKey=a.xml.recordsetCacheKey)},parseDataXML:function(a){if(""!=a.xml.data){var b=qv.util.dom.xmlDocument(a.xml.data),b=qv.util.dom.getSingleElementByTagName(b,"Recordset");a.Data=a.Data||{};b=gx.util.browser.isIE()?qv.util.dom.getMultipleElementsByTagName(qv.util.dom.getSingleElementByTagName(b,
"Page"),"Record"):qv.util.dom.getMultipleElementsByTagName(b,"Record");a.Data.Rows=[];for(var c=0;c<b.length;c++){for(var d={},m=0;m<b[c].childNodes.length;m++){var r=b[c].childNodes[m];1==r.nodeType&&(d[r.nodeName]=1==r.childNodes.length?r.childNodes[0].nodeValue:"")}a.Data.Rows.push(d)}}},parseMetadataXML:function(a){function b(a,e){if("greaterequal"==a&&"lessequal"==e)return QueryViewerConditionOperator.Interval;switch(a){case "equal":return QueryViewerConditionOperator.Equal;case "less":return QueryViewerConditionOperator.LessThan;
case "greater":return QueryViewerConditionOperator.GreaterThan;case "lessequal":return QueryViewerConditionOperator.LessOrEqual;case "greaterequal":return QueryViewerConditionOperator.GreaterOrEqual;case "notequal":return QueryViewerConditionOperator.NotEqual}}function c(a,b,e,f){var g={},a=qv.util.dom.getSingleElementByTagName(a,b);if(null!=a){g.GroupFound=!0;g.TotalValueFound=!1;e=qv.util.dom.getMultipleElementsByTagName(a,e);g.Values=[];for(a=0;a<e.length;a++)b=null!=e[a].firstChild?e[a].firstChild.nodeValue:
"","TOTAL"==b&&f?g.TotalValueFound=!0:g.Values.push(b)}else g.GroupFound=!1;return g}function d(a){if(0==a.indexOf("gxpl_cssReplace("))var b=a.indexOf("gxpl_cssReplace("),e=a.indexOf(")",b),a=a.substring(b+16,e);return a}function s(a){for(var a=qv.util.dom.getSingleElementByTagName(a,"formatValues"),a=null!=a?qv.util.dom.getMultipleElementsByTagName(a,"value"):[],b=[],e=0;e<a.length;e++){var c={};c.Value=qv.util.trim(null!=a[e].firstChild?a[e].firstChild.nodeValue:"");c.StyleOrClass=d(a[e].getAttribute("format"));
c.ApplyToRowOrColumn="yes"==a[e].getAttribute("recursive");b.push(c)}return b}function r(a){for(var a=qv.util.dom.getSingleElementByTagName(a,"conditionalFormats"),a=null!=a?qv.util.dom.getMultipleElementsByTagName(a,"rule"):[],e=[],c=0;c<a.length;c++){var f={};f.Operator=b(a[c].getAttribute("op1"),a[c].getAttribute("op2"));f.Value1=parseFloat(a[c].getAttribute("value1"));f.Operator==QueryViewerConditionOperator.Interval&&(f.Value2=parseFloat(a[c].getAttribute("value2")));f.StyleOrClass=d(a[c].getAttribute("format"));
e.push(f)}return e}if(""!=a.xml.metadata){var h=qv.util.dom.xmlDocument(a.xml.metadata),u=qv.util.dom.getSingleElementByTagName(h,"OLAPCube"),h=u.getAttribute("Version");if(null==h||parseInt(h)==METADATA_VERSION){a.Metadata=a.Metadata||{};a.Metadata.TextForNullValues=u.getAttribute("textForNullValues");var n=qv.util.dom.getMultipleElementsByTagName(u,"OLAPDimension");a.Metadata.Axes=[];for(h=0;h<n.length;h++){var z={};z.Name=n[h].getAttribute("name");z.Title=n[h].getAttribute("displayName");z.DataField=
n[h].getAttribute("dataField");z.DataType=n[h].getAttribute("dataType");z.Visible=n[h].getAttribute("visible");z.Axis=n[h].getAttribute("axis");z.Picture=n[h].getAttribute("picture");if(""==z.Picture)switch(z.DataType){case QueryViewerDataType.Integer:z.Picture="ZZZZZZZZZZZZZZ9";break;case QueryViewerDataType.Real:z.Picture="ZZZZZZZZZZZZZZ9.99";break;case QueryViewerDataType.Date:z.Picture="99/99/9999";break;case QueryViewerDataType.DateTime:z.Picture="99/99/9999 99:99:99";break;case QueryViewerDataType.GUID:z.Picture=
"XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX"}z.CanDragToPages=qv.util.dom.getBooleanAttribute(n[h],"canDragToPages",!0);z.RaiseItemClick=qv.util.dom.getBooleanAttribute(n[h],"raiseItemClick",!0);z.IsComponent=qv.util.dom.getBooleanAttribute(n[h],"isComponent",!1);z.Style=n[h].getAttribute("format");var e=c(n[h],"include","value",!0),g=c(n[h],"exclude","value",!0),C=c(n[h],"expand","value",!1),E=c(n[h],"customOrder","Value",!1);z.Subtotals="no"==n[h].getAttribute("summarize")?QueryViewerSubtotals.No:g.GroupFound&&
g.TotalValueFound?QueryViewerSubtotals.Hidden:QueryViewerSubtotals.Yes;z.Filter={};!e.GroupFound&&!g.GroupFound?(z.Filter.Type=QueryViewerFilterType.ShowAllValues,z.Filter.Values=[]):!e.GroupFound&&g.GroupFound&&0==g.Values.length&g.TotalValueFound?(z.Filter.Type=QueryViewerFilterType.ShowAllValues,z.Filter.Values=[]):e.GroupFound&&!g.GroupFound&&0==e.Values.length?(z.Filter.Type=QueryViewerFilterType.HideAllValues,z.Filter.Values=[]):(z.Filter.Type=QueryViewerFilterType.ShowSomeValues,z.Filter.Values=
e.Values);z.ExpandCollapse={};C.GroupFound?C.GroupFound&&0==C.Values.length?(z.ExpandCollapse.Type=QueryViewerExpandCollapseType.CollapseAllValues,z.ExpandCollapse.Values=[]):(z.ExpandCollapse.Type=QueryViewerExpandCollapseType.ExpandSomeValues,z.ExpandCollapse.Values=C.Values):(z.ExpandCollapse.Type=QueryViewerExpandCollapseType.ExpandAllValues,z.ExpandCollapse.Values=[]);z.Order={};e=n[h].getAttribute("order");null==e?(z.Order.Type=QueryViewerAxisOrderType.None,z.Order.Values=[]):(z.Order.Type=
qv.util.capitalize(e),z.Order.Values=z.Order.Type==QueryViewerAxisOrderType.Custom?E.Values:[]);z.ValuesStyles=s(n[h]);a.Metadata.Axes.push(z)}u=qv.util.dom.getMultipleElementsByTagName(u,"OLAPMeasure");a.Metadata.Data=[];for(h=0;h<u.length;h++)n={},n.Name=u[h].getAttribute("name"),n.Title=u[h].getAttribute("displayName"),n.DataField=u[h].getAttribute("dataField"),n.Aggregation=u[h].getAttribute("aggregation"),n.DataType=u[h].getAttribute("dataType"),n.Visible=u[h].getAttribute("visible"),n.Picture=
u[h].getAttribute("picture"),n.RaiseItemClick=qv.util.dom.getBooleanAttribute(u[h],"raiseItemClick",!0),n.IsComponent=qv.util.dom.getBooleanAttribute(u[h],"isComponent",!1),""==n.Picture&&(n.Picture=n.DataType==QueryViewerDataType.Integer?"ZZZZZZZZZZZZZZ9":"ZZZZZZZZZZZZZZ9.99"),n.Aggregation=qv.util.capitalize(n.Aggregation),n.TargetValue=parseFloat(u[h].getAttribute("targetValue")),n.MaximumValue=parseFloat(u[h].getAttribute("maximumValue")),n.Style=u[h].getAttribute("format"),0>=n.TargetValue&&
(n.TargetValue=100),0>=n.MaximumValue&&(n.MaximumValue=100),n.ConditionalStyles=r(u[h]),z=qv.util.dom.getCharacterAttribute(u[h],"formula",""),n.IsFormula=""!=z,n.Formula=z,a.Metadata.Data.push(n);a.Metadata.ParserResult=m(!0,"")}else a.Metadata.ParserResult=m(!1,gx.getMessage("GXPL_QViewerWrongMetadataVersion").replace("{0}",METADATA_VERSION))}},GetDataIfNeeded:function(a,b){a.Data=a.Data||{};a.Data.LastServiceCallKey=a.Data.LastServiceCallKey||{};void 0==a.xml.data||d(a,a.Data.LastServiceCallKey)||
gx.lang.gxBoolean(a.IsExternalQuery)?a.calculatePivottableData(b):b(a.xml.data,a)},GetMetadataIfNeeded:function(a,b){a.Metadata=a.Metadata||{};a.Metadata.LastServiceCallKey=a.Metadata.LastServiceCallKey||{};void 0==a.xml.metadata||c(a,a.Metadata.LastServiceCallKey)||gx.lang.gxBoolean(a.IsExternalQuery)?a.calculatePivottableMetadata(b):b(a.xml.metadata,a)},GetDashboardSpecIfNeeded:function(b,c){b.DashboardSpec=b.DashboardSpec||"";b.LastServiceCallKey=b.LastServiceCallKey||{};var d;if(!(d=void 0==b.DashboardSpec))if(d=
b.LastServiceCallKey,b.Object){var m=a(b.Object);m!=d.ObjectName?(d.ObjectName=m,d=!0):d=!1}else d=""==b.DashboardSpec;d?(b.LoadingSpec=!0,b.GetDashboardSpec(c)):c(b.DashboardSpec,b)},GetRecordsetCacheKeyIfNeeded:function(a,b){a.UseRecordsetCache&&!gx.lang.gxBoolean(a.IsExternalQuery)?(a.RecordsetCache=a.RecordsetCache||{},a.RecordsetCache.LastServiceCallKey=a.RecordsetCache.LastServiceCallKey||{},void 0==a.xml.recordsetCacheKey||d(a,a.RecordsetCache.LastServiceCallKey)?a.getRecordsetCacheKey(b):
b(a.xml.recordsetCacheKey,a)):b("",a)},IsObjectSet:function(a){return a.Object||""!=a.ObjectName||""!=a.ObjectType&&0!=a.ObjectId}}}();
qv.pivot=function(){function a(a){var c=qv.util.GetContainerControlClasses(a);""!=c&&qv.util.SetUserControlClass(a,c);c=a.userControlId()+"_"+a.RealObjectName().replace(/,/g,"").replace(/\./g,"")+"_pivot_page";a.pivotParams={};a.pivotParams.page=c;var f=a.userControlId()+"_"+a.RealObjectName().replace(/,/g,"").replace(/\./g,"")+"_pivot_content";a.pivotParams.content=f;if(a._ControlRenderedTo!=a.RealType||0==jQuery("#"+f).length)if(a._ControlRenderedTo!=a.RealType&&a.RealType==QueryViewerOutputType.PivotTable){var d=
qv.util.dom.getEmptyContainer(a);a.Title&&qv.util.dom.createDiv(d,c.replace("_pivot_page","_title_div"),"","",{},"");qv.util.dom.createDiv(d,c,"","",{},"");qv.util.dom.createDiv(d,f,"","",{},"")}else a.Title&&jQuery("#"+a.ContainerName).find(".pivot_title_div").attr("id",c.replace("_pivot_page","_title_div")),jQuery("#"+a.ContainerName).find(".pivot_filter_div").attr("id",c),jQuery("#"+a.ContainerName).find(".conteiner_table_div").attr("id",f);a.pivotParams.container=a.getContainerControl();a.pivotParams.RealType=
a.RealType;a.pivotParams.ObjectName=a.RealObjectName();a.pivotParams.ControlName=a.ControlName;a.pivotParams.PageSize=a.Paging&&"false"!=a.Paging?a.PageSize:void 0;a.pivotParams.metadata=a.xml.metadata;c=gx.lang.gxBoolean(a.IsExternalQuery)?a.xml.data:a.RealType==QueryViewerOutputType.Table?a.ServerPagingForTable?a.xml.pageData:a.xml.data:a.ServerPagingForPivotTable?a.xml.pageData:a.xml.data;a.pivotParams.data=c;a.pivotParams.UcId=a.userControlId();a.pivotParams.AutoResize=gx.lang.gxBoolean(a.AutoResize)||
gx.lang.gxBoolean(a.ShrinkToFit);a.pivotParams.DisableColumnSort=a.DisableColumnSort;a.pivotParams.RememberLayout=a.RememberLayout;a.pivotParams.ShowDataLabelsIn=a.ShowDataLabelsIn;a.pivotParams.ServerPaging=a.ServerPagingForTable&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.ServerPagingPivot=a.ServerPagingForPivotTable&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.ServerPagingCacheSize=0;a.pivotParams.UseRecordsetCache=a.UseRecordsetCache&&!gx.lang.gxBoolean(a.IsExternalQuery);a.pivotParams.AllowSelection=
a.AllowSelection;a.pivotParams.SelectLine=!0;a.pivotParams.TotalForColumns=a.TotalForColumns;a.pivotParams.TotalForRows=a.TotalForRows;a.pivotParams.Title=qv.util.getTranslation(a.Title);void 0!=OAT.Loader?renderJSPivot(a.pivotParams,qv.collection,a):OAT.Loader.addListener(function(){renderJSPivot(a.pivotParams,qv.collection,a)});a._ControlRenderedTo=a.RealType;a.RealType==QueryViewerOutputType.Table&&qv.util.hideActivityIndicator(a)}function c(b){b.getPageDataForTable(function(b,c){(new Date).getTime();
qv.util.anyError(b)?(errMsg=qv.util.getErrorFromText(b),qv.util.renderError(c,errMsg)):(""!=b&&(c.xml.pageData=b),a(c))},[1,b.PageSize,!0,"","",[],!1])}function d(a,c){var f=[];if(null!=a)for(var d=-1,l=0;l<a.childNodes.length;l++)if("ITEM"==a.childNodes[l].nodeName){var v=a.childNodes[l].getAttribute("name");if(0>c.indexOf(v)){d++;f[d]={};f[d].Name=v;f[d].Values=[];for(var v=-1,s=a.childNodes[l],r=0;r<a.childNodes[l].childNodes.length;r++)if("VALUES"==a.childNodes[l].childNodes[r].nodeName){s=a.childNodes[l].childNodes[r];
break}for(r=0;r<s.childNodes.length;r++)"VALUE"==s.childNodes[r].nodeName&&(v++,f[d].Values[v]=null!=s.childNodes[r].firstChild?s.childNodes[r].firstChild.nodeValue:"")}}return f}return{tryToRenderPivotTable:function(b){var d="",f=(new Date).getTime();b.xml=b.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(b,function(b,l){var v=!1;b!=l.xml.recordsetCacheKey&&(l.xml.recordsetCacheKey=b,v=!0);qv.util.anyError(b)?(d=qv.util.getErrorFromText(b),qv.util.renderError(l,d)):(v&&qv.services.parseRecordsetCacheKeyXML(l),
qv.services.GetMetadataIfNeeded(l,function(b,l){var h=false;if(b!=l.xml.metadata){l.xml.metadata=b;h=true}var u=(new Date).getTime();if(qv.util.anyError(b)){d=qv.util.getErrorFromText(b);qv.util.renderError(l,d)}else{h&&qv.services.parseMetadataXML(l);if(l.Metadata.ParserResult.Success)if(l.ServerPagingForTable&&l.RealType==QueryViewerOutputType.Table&&!gx.lang.gxBoolean(l.IsExternalQuery)){h=false;OAT.getStateWhenServingPaging&&(h=OAT.getStateWhenServingPaging(l.userControlId()+"_"+l.ObjectName,
l.ObjectName));!h||!l.RememberLayout?c(l,f,u):a(l)}else if(l.ServerPagingForPivotTable&&l.RealType==QueryViewerOutputType.PivotTable&&!gx.lang.gxBoolean(l.IsExternalQuery)){h=false;OAT.getStateWhenServingPaging&&(h=OAT.getStateWhenServingPaging(l.userControlId()+"_"+l.ObjectName,l.ObjectName));a(l)}else qv.services.GetDataIfNeeded(l,function(b,c){if(b!=c.xml.data)c.xml.data=b;(new Date).getTime();if(qv.util.anyError(b)){d=qv.util.getErrorFromText(b);qv.util.renderError(c,d)}else a(c)});else qv.util.renderError(l,
l.Metadata.ParserResult.Message)}}))})},GetMetadataPivot:function(a){var c=qv.util.GetDesigntimeMetadata(a);if(0<c.length){for(var d=a.oat_element.getMetadataXML(),d=qv.pivot.GetRuntimeMetadata(d,a.RealType),q=[],a=qv.util.GetOrderedElementsKeys(a,d),l=0;l<a.length;l++)for(var v=parseInt(a[l].substr(6,4)),v=d[v],s,r=0;r<c.length;r++)if(s=c[r],s.Name==v.Name){s=qv.util.cloneObject(s);qv.util.MergeFields(v,s);q.push(s);break}return q}return[]},GetRuntimeMetadata:function(a,c){function d(a,b,e,c,g){var b=
qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(a,b)),f=[];if(b==c&&(a=qv.util.dom.getSingleElementByTagName(a,e),null!=a)){a=qv.util.dom.getMultipleElementsByTagName(a,"value");for(e=0;e<a.length;e++)c=qv.util.trim(qv.util.dom.getValueNode(a[e])),null!=c&&("TOTAL"!=c.toUpperCase()||!g)&&f.push(c)}return{Type:b,Values:f}}var q=qv.util.dom.xmlDocument(a),q=qv.util.dom.getSingleElementByTagName(q,"OLAPCube"),l=[],v;v=qv.util.dom.getMultipleElementsByTagName(q,"OLAPDimension");for(var s=
0;s<v.length;s++){var r={},h=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"name")),u="true"==qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"hidden")),n=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"axis")),z=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"position")),e=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"summarize")),g=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],
"order"));r.Name=h;r.Type=QueryViewerElementType.Axis;r.Hidden=u;r.Axis=null!=n&&""!=n&&"null"!=n?qv.util.capitalize(n):null;r.Position=z;r.Order=null!=g&&""!=g&&"null"!=g?qv.util.capitalize(g):null;c==QueryViewerOutputType.Table?(r.Filter=d(v[s],"","include",null,!0),r.Filter.Type=QueryViewerFilterType.ShowSomeValues):(r.Subtotals="no"==e?QueryViewerSubtotals.No:QueryViewerSubtotals.Yes,r.Filter=d(v[s],"filterType","include",QueryViewerFilterType.ShowSomeValues,!0),r.ExpandCollapse=d(v[s],"collapseType",
"includeExpand",QueryViewerExpandCollapseType.ExpandSomeValues,!1));l.push(r)}v=qv.util.dom.getMultipleElementsByTagName(q,"OLAPMeasure");for(s=0;s<v.length;s++)r={},h=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"name")),u="true"==qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"hidden")),z=qv.util.dom.getValueNode(qv.util.dom.getSingleElementByTagName(v[s],"position")),r.Name=h,r.Type=QueryViewerElementType.Datum,r.Hidden=u,r.Position=z,l.push(r);return l},
GetDataPivot:function(a){return a.oat_element.getDataXML()},GetFilteredDataPivot:function(a){return a.oat_element.getFilteredDataXML()},onOAT_PIVOTDragAndDropEvent:function(a,c){if(a.RealType==QueryViewerOutputType.PivotTable&&(IsQueryObjectPreview()&&window.external.SendText(a.ControlName,c),a.DragAndDrop)){var d=qv.util.dom.xmlDocument(c),d=qv.util.dom.selectXPathNode(d,"/DATA");a.DragAndDropData.Name=d.getAttribute("name");a.DragAndDropData.Type=QueryViewerElementType.Axis;axis=d.getAttribute("axis");
a.DragAndDropData.Axis="rows"==axis?QueryViewerAxisType.Rows:"columns"==axis?QueryViewerAxisType.Columns:QueryViewerAxisType.Pages;a.DragAndDropData.Position=d.getAttribute("position");a.DragAndDrop()}},onItemClickEvent:function(a,c,f){var q,l;if(a.ItemClick&&!f||a.ItemDoubleClick&&f){l=f?l=a.ItemDoubleClickData:a.ItemClickData;var v=qv.util.dom.xmlDocument(c),s=qv.util.dom.selectXPathNode(v,"/DATA/ITEM"),c=qv.util.dom.selectXPathNode(v,"/DATA/CONTEXT/RELATED"),v=qv.util.dom.selectXPathNode(v,"/DATA/CONTEXT/FILTERS");
l.Name=s.getAttribute("name");q=s.getAttribute("location");switch(q){case "rows":l.Type=QueryViewerElementType.Axis;l.Axis=QueryViewerAxisType.Rows;break;case "columns":l.Type=QueryViewerElementType.Axis;l.Axis=QueryViewerAxisType.Columns;break;case "pages":l.Type=QueryViewerElementType.Axis;l.Axis=QueryViewerAxisType.Pages;break;default:l.Type=QueryViewerElementType.Datum,l.Axis=""}l.Value=null!=s.firstChild?s.firstChild.nodeValue:"";l.Selected="true"==s.getAttribute("selected");s=[];for(q=0;q<a.Metadata.Axes.length;q++)a.Metadata.Axes[q].IsComponent&&
s.push(a.Metadata.Axes[q].Name);for(q=0;q<a.Metadata.Data.length;q++)a.Metadata.Data[q].IsComponent&&s.push(a.Metadata.Data[q].Name);l.Context=d(c,s);l.Filters=d(v,s);f?a.ItemDoubleClick():a.ItemClick()}},onItemExpandCollapseEvent:function(a,c,d){var q;IsQueryObjectPreview()&&window.external.SendText(a.ControlName,c);if(a.ItemExpand&&!d||a.ItemCollapse&&d){q=d?q=a.ItemCollapseData:a.ItemExpandData;var c=qv.util.dom.xmlDocument(c),l=qv.util.dom.selectXPathNode(c,"/DATA/ITEM"),c=qv.util.dom.selectXPathNode(c,
"/DATA/CONTEXT/EXPANDEDVALUES");q.Name=l.getAttribute("name");q.Value=l.firstChild.nodeValue;q.ExpandedValues=[];for(var l=-1,v=0;v<c.childNodes.length;v++)"VALUE"==c.childNodes[v].nodeName&&(l++,q.ExpandedValues[l]=c.childNodes[v].firstChild.nodeValue);d?a.ItemCollapse():a.ItemExpand()}},Select:function(a,c){a.oat_element.selectValue(c)},Deselect:function(a){a.oat_element.deselectValue()}}}();var HCChart,_highChartsDrawPointsWrapped,DEFAULTCHARTSPACING=10;
qv.chart=function(){function a(a){return a.RealChartType==QueryViewerChartType.Timeline||a.RealChartType==QueryViewerChartType.SmoothTimeline||a.RealChartType==QueryViewerChartType.StepTimeline}function c(b){return a(b)||b.RealChartType==QueryViewerChartType.Sparkline}function d(a){return a.RealChartType==QueryViewerChartType.Pie||a.RealChartType==QueryViewerChartType.Pie3D||a.RealChartType==QueryViewerChartType.Doughnut||a.RealChartType==QueryViewerChartType.Doughnut3D}function b(a){return a.RealChartType==
QueryViewerChartType.Funnel||a.RealChartType==QueryViewerChartType.Pyramid}function m(a){return a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar||a.RealChartType==QueryViewerChartType.PolarArea}function f(a){return(a.RealChartType==QueryViewerChartType.ColumnLine||a.RealChartType==QueryViewerChartType.Column3DLine)&&1<a.Chart.Series.DataFields.length}function q(a){return a.RealChartType==QueryViewerChartType.CircularGauge||a.RealChartType==QueryViewerChartType.LinearGauge}
function l(a){return a.RealChartType==QueryViewerChartType.StackedColumn||a.RealChartType==QueryViewerChartType.StackedColumn3D||a.RealChartType==QueryViewerChartType.StackedColumn100||a.RealChartType==QueryViewerChartType.StackedBar||a.RealChartType==QueryViewerChartType.StackedBar100||a.RealChartType==QueryViewerChartType.StackedArea||a.RealChartType==QueryViewerChartType.StackedArea100||a.RealChartType==QueryViewerChartType.StackedLine||a.RealChartType==QueryViewerChartType.StackedLine100?!1:(a.PlotSeries==
QueryViewerPlotSeries.InSeparateCharts||d(a)||b(a))&&1<a.Chart.Series.DataFields.length}function v(a,b){for(var e=[],c=0;c<a.Charts.length;c++)for(var g=0;g<a.Charts[c].series.length;g++)e.push(a.Charts[c].series[g].data[b]);return e}function s(a,b,e,c,g){for(var d=0;d<a.Charts.length;d++)if(b.id!=a.Charts[d].container.id)for(var f=0;f<a.Charts[d].series.length;f++){var h=a.Charts[d].series[f].data[e];c?(g&&h.setState("hover"),a.Charts[d].tooltip.hide(0)):h.setState()}}function r(a){switch(a){case QueryViewerChartType.Column:case QueryViewerChartType.Column3D:case QueryViewerChartType.StackedColumn:case QueryViewerChartType.StackedColumn3D:case QueryViewerChartType.StackedColumn100:case QueryViewerChartType.PolarArea:return"column";
case QueryViewerChartType.Bar:case QueryViewerChartType.StackedBar:case QueryViewerChartType.StackedBar100:case QueryViewerChartType.LinearGauge:return"bar";case QueryViewerChartType.Area:case QueryViewerChartType.StackedArea:case QueryViewerChartType.StackedArea100:case QueryViewerChartType.FilledRadar:case QueryViewerChartType.StepArea:return"area";case QueryViewerChartType.SmoothArea:return"areaspline";case QueryViewerChartType.Line:case QueryViewerChartType.StackedLine:case QueryViewerChartType.StackedLine100:case QueryViewerChartType.Radar:case QueryViewerChartType.Timeline:case QueryViewerChartType.StepTimeline:case QueryViewerChartType.Sparkline:case QueryViewerChartType.StepLine:return"line";
case QueryViewerChartType.SmoothLine:case QueryViewerChartType.SmoothTimeline:return"spline";case QueryViewerChartType.ColumnLine:case QueryViewerChartType.Column3DLine:return"column";case QueryViewerChartType.Pie:case QueryViewerChartType.Pie3D:case QueryViewerChartType.Doughnut:case QueryViewerChartType.Doughnut3D:return"pie";case QueryViewerChartType.Funnel:return"funnel";case QueryViewerChartType.Pyramid:return"pyramid";case QueryViewerChartType.CircularGauge:return"solidgauge";default:return"line"}}
function h(a,b,e,c,g,d,f){function h(a,b){var c={};c.Name=a.Name;var e=qv.util.GetPictureProperties(a.DataType,a.Picture),e=qv.util.ApplyPicture(b,a.Picture,a.DataType,e);c.Values=[e];return c}a.Name=e;a.Type=c;a.Axis="";a.Value=g;a.Selected=d;a.Context=[];for(e=0;e<b.Metadata.Axes.length;e++)c=b.Metadata.Axes[e],c.IsComponent||(c=h(c,f[c.DataField]),a.Context.push(c));for(e=0;e<b.Metadata.Data.length;e++)c=b.Metadata.Data[e],c.IsComponent||(c=h(c,f[c.DataField]),a.Context.push(c));a.Filters=[]}function u(a,
b){for(var c=!1,e=0;e<a.length;e++)for(var g=a[e],d=0;d<g.series.length;d++){var f=g.series[d].points[b];if(f.selected){f.select();break}else f.select(!0,0<d),c=!0}return c}function n(a){for(var b=0;b<a.length;b++){var c=a[b].getSelectedPoints();0<c.length&&c[0].select(!1,!1)}}function z(a){var b=qv.collection[this.chart.options.qv.viewerId],c=l(b)?this.chart.options.qv.seriesIndex:a.point.series.index,e=!1;if(b.SelectionAllowed())if("Point"==b.SelectionType){if(a.point.select(),e=a.point.selected,
b.PlotSeries==QueryViewerPlotSeries.InSeparateCharts&&e)for(var g=0;g<b.Charts.length;g++){var d=b.Charts[g].series[0].points[a.point.index];d!=a.point&&d.select(!1)}}else e=u(b.Charts,a.point.index);b.ItemClick&&b.Metadata.Data[c].RaiseItemClick&&(c=b.Chart.Series.ByIndex[c],g=qv.util.formatNumber(a.point.y,c.NumberFormat.DecimalPrecision,c.Picture,!1),h(b.ItemClickData,b,c.FieldName,QueryViewerElementType.Datum,g,e,b.Data.Rows[a.point.index]),b.ItemClick())}function e(a){return qv.util.dom.createSpan(null,
"","","",{fontWeight:"bold"},null,a).outerHTML}function g(a,b){l(b);var c=Math.min(b.getContainerControl().offsetHeight,b.getContainerControl().offsetWidth)/(l(b)?b.Chart.Series.DataFields.length:1)/13;return qv.util.dom.createSpan(null,"","","",{color:B(b,a),fontSize:c+"px"},null,qv.util.formatNumber(a.point.y,2,"ZZZZZZZZZZZZZZ9.99",!0)+"%").outerHTML}function C(a,b,c){if(c){var g;a.points?(c=a.points[0],g=c.point.index):(c=a.point,g=c.index);c=qv.collection[c.series.chart.options.qv.viewerId];g=
v(c,g);var d=!a.key?!a.x?"":a.x:a.key,a=""!=d&&c.RealChartType!=QueryViewerChartType.Sparkline,c="";a&&(c+=e(d));for(var f=0;f<g.length;f++)var h=g[f],d=h.series.chart.options.qv.seriesIndex,d=b[d],c=c+((a||0<f?"<br/>":"")+h.series.name+": "),c=c+qv.util.formatNumber(h.y,d.NumberFormat.DecimalPrecision,d.Picture,!1);return c}c=qv.collection[a.series.chart.options.qv.viewerId];d=a.series.index;d=b[d];b=q(c)?"ZZZZZZZZZZZZZZ9.99":d.Picture;g=q(c)?2:d.NumberFormat.DecimalPrecision;d=q(c);return"<b>"+
(""!=a.point.name?a.point.name:a.series.name)+"</b>: "+qv.util.formatNumber(a.point.y,g,b,d)+(q(c)?"%":"")}function E(a,b){function c(a){for(var b=a.y,e=a.series.data,a=a.index,g="",g=a,d=a+1;d<e.length&&e[d].y==b;d++)g=d;g<e.length-1&&g++;for(var f=a,d=a-1;0<=d&&e[d].y==b;d--)f=d;b=(e[g].x-e[f].x)/1E3;return g=" ("+gx.getMessage("GXPL_QViewerDuration")+": "+qv.util.seconsdToText(b)+")"}var g,d=a.points[0].series.chart.options.qv.viewerId,f=qv.collection[d];l(f)?g=v(f,a.points[0].point.index):(g=
[],jQuery.each(a.points,function(a,b){g.push(b.point)}));for(var h={},d=gx.dom.el(d+"_options_compare_enable").checked,k=0;k<g.length;k++){var o=(d?Math.trunc(g[k].series.index/2):g[k].series.index).toString();void 0==h[o]&&(h[o]=[]);h[o].push(g[k])}var k="",s,B;for(o in h)for(var m=parseInt(o),m=b[m],w=m.Name,C=h[o],p=0;void 0!=C[p];p++){var n=C[p],y=parseInt(n.real_x?n.real_x:n.x);d?B!=w&&(k+=e(w)+"<br/>",B=w):s!=y&&(k+=e(n.name)+"<br/>",s=y);var y=f.RealChartType==QueryViewerChartType.StepTimeline?
c(n):"",F=qv.util.dom.createSpan(null,"","","",{},null,(d?n.name:w)+": ").outerHTML,n=qv.util.dom.createSpan(null,"","","",{},null,qv.util.formatNumber(n.y,m.NumberFormat.DecimalPrecision,m.Picture,!1)).outerHTML,k=k+(F+n+y+"<br/>")}return k}function o(a){"undefined"===typeof _avoidSelectionEventHandler&&(_avoidSelectionEventHandler=!1);if(!_avoidSelectionEventHandler){t(V,"none");V=null;if(a.xAxis){var b=a.target.options.qv,c=a.xAxis[0];ca(a.target.options.qv.viewerId,100*((c.min-b.dataMin)/(b.dataMax-
b.dataMin)),100*((c.max-b.dataMin)/(b.dataMax-b.dataMin)))}else ca(a.target.options.qv.viewerId,0,100);b=qv.collection[a.target.options.qv.viewerId];if(l(b)){var b=b.getContainerControl().id,b=jQuery("[id^="+b+"_chart]"),e=[];jQuery.each(b,function(b,c){if(c.id!=a.target.renderTo.id){var g=jQuery("#"+c.id).highcharts();e.push(g)}});jQuery.each(e,function(b,e){a.xAxis?e.get("xaxis").setExtremes(c.min,c.max):(_avoidSelectionEventHandler=!0,e.zoomOut(),_avoidSelectionEventHandler=!1)})}}}function k(a,
b,c,e,g){function d(a,b,c,e,g){function f(a,b){return a==QueryViewerDataType.Date?10==b.length:" "==b.charAt(10)}function h(a,b,c,e,g){var d=a.substr(0,4),f=a.substr(5,2),a=a.substr(8,2);e||(b=b.replace("M",""));g||(b=b.replace("D",""));for(var k="",D=0;D<b.length;D++)k+=0==D?"":"/",k+=b.charAt(D);b=k.replace("Y",c?d:d.substr(2,2));e&&(b=b.replace("M",f));g&&(b=b.replace("D",a));return b}var k,D;if(""!=a)switch(g=g||(c==QueryViewerDataType.Date?"Days":"Seconds"),g){case "Years":k=a.substr(0,4)+"-01-01";
D=h(k,e,f(c,b),!1,!1);break;case "Months":k=a.substr(0,7)+"-01";D=h(k,e,f(c,b),!0,!1);break;case "Semesters":k="06">=a.substr(5,2)?"01":"07";k=a.substr(0,5)+k+"-01";g="06">=a.substr(5,2)?"01":"02";dateStrSemester=a.substr(0,5)+g+"-01";D=h(dateStrSemester,e,f(c,b),!0,!1);break;case "Quarters":k="03">=a.substr(5,2)?"01":"06">=a.substr(5,2)?"04":"09">=a.substr(5,2)?"07":"10";k=a.substr(0,5)+k+"-01";g="03">=a.substr(5,2)?"01":"06">=a.substr(5,2)?"02":"09">=a.substr(5,2)?"03":"04";dateStrQuarter=a.substr(0,
5)+g+"-01";D=h(dateStrQuarter,e,f(c,b),!0,!1);break;case "Weeks":a=new gx.date.gxdate(a,"Y4MD");k=gx.date.dow(a);a=gx.date.dtadd(a,-86400*(k-1));k=qv.util.dateToString(a,!1);D=h(k,e,f(c,b),!0,!0);break;case "Days":k=c==QueryViewerDataType.Date?a:a.substr(0,10);D=c==QueryViewerDataType.Date?b:b.substr(0,10);break;case "Hours":k=a.substr(0,13)+":00:00";D=b.substr(0,13)+":00";break;case "Minutes":k=a.substr(0,16)+":00";D=b.substr(0,16);break;case "Seconds":k=a,D=b}else D=k="";return{dateStr:k,name:D}}
var f;f={dateStr:null,name:null};var h=[],k=[],l=[];for(i=0;i<b.length;i++){var o=a.Values[i].ValueWithPicture,s=a.Values[i].Value,B,m;null!=b[i].Value?e==QueryViewerAggregationType.Count?(B=0,m=parseFloat(qv.util.trim(b[i].Value))):e==QueryViewerAggregationType.Average?(B=parseFloat(qv.util.trim(b[i].Value_N)),m=parseFloat(qv.util.trim(b[i].Value_D))):(B=parseFloat(qv.util.trim(b[i].Value)),m=1):(B=null,m=0);o=d(s,o,c,gx.dateFormat,g);o.dateStr==f.dateStr||0==i?(null!=B&&(h.push(B),k.push(m)),0==
i&&(f=o)):(f={x:f.dateStr,y:qv.util.aggregate(e,h,k),name:f.name},l.push(f),f=o,h=[B],k=[m])}0<h.length&&0<k.length&&(f={x:f.dateStr,y:qv.util.aggregate(e,h,k),name:f.name},l.push(f));return l}function F(b){var c,e,g;a(b)?(b=DEFAULTCHARTSPACING,c=0,e=DEFAULTCHARTSPACING,g=0):g=e=c=b=DEFAULTCHARTSPACING;return[b,c,e,g]}function M(a,b){var c,e;c=3>=a?24:50/(a-1)-1;e=100-(c+1)*(b-1);return{Width:c,Center:e,LowerExtreme:e-c/2,UpperExtreme:e+c/2}}function p(a,b){var c=1/a/2,e=-0.5+(b-0.5)/a;return{Width:c,
Center:e,LowerExtreme:e-c/2,UpperExtreme:e+c/2}}function B(a,b){function c(a){function b(a,c,e,g){g||(g=0);for(var d=0;d<c.length;d++){var f=c[d];if(f instanceof CSSStyleRule){if(f.selectorText&&0==f.selectorText.indexOf(e)){var h=f.selectorText.replace(e,"");a[h]=f.style.fill;g++}if(g===HIGHCHARTS_MAX_COLORS)break}else f instanceof CSSImportRule?b(a,f.styleSheet.rules||f.styleSheet.cssRules,e,g):f instanceof CSSLayerBlockRule&&b(a,f.cssRules,e,g)}}if(!a._HighchartsDefaultColors){a._HighchartsDefaultColors=
[];var e={},g,d;g=qv.util.GetQueryViewerStyleSheet(a);b(e,g.cssRules,".highcharts-color-");""!=a.Class&&(g=qv.util.GetThemeStyleSheet(a),d="."+qv.util.GetContainerControlClass(a)+" .highcharts-color-",b(e,g.cssRules,d));for(g=0;g<HIGHCHARTS_MAX_COLORS;g++)a._HighchartsDefaultColors.push(e[g.toString()])}return a._HighchartsDefaultColors}var e;e=b.className&&0==b.className.indexOf("highcharts-color-")?parseInt(b.className.replace("highcharts-color-","")):b.colorIndex;e<HIGHCHARTS_MAX_COLORS?e=c(a)[e]:
(e=HIGHCHARTS_CUSTOM_COLOR[e-HIGHCHARTS_MAX_COLORS],qv.util.color.IsHexaColor(e)&&(e="#"+e));return e}function w(a,b,c,e){if(!qv.util.IsNullColor(c)){if(c.IsDefault)a=c.ColorIndex;else{var g=c.Color,c=HIGHCHARTS_CUSTOM_COLOR.indexOf(g);if(0>c){HIGHCHARTS_CUSTOM_COLOR.push(g);var c=HIGHCHARTS_CUSTOM_COLOR.length-1,c=HIGHCHARTS_MAX_COLORS+c,d=qv.util.color.IsHexaColor(g)?"#":"",g="."+HIGHCHARTS_COLOR_PREFIX+c+" {fill: "+d+g+"; stroke: "+d+g+";}",a=qv.util.GetThemeStyleSheet(a);a.insertRule(g,a.cssRules.length)}else c=
HIGHCHARTS_MAX_COLORS+c;a=c}e?b.colorIndex=a:b.className=HIGHCHARTS_COLOR_PREFIX+a}}function J(h,B,n){var y=qv.util.XAxisDataType(h)==QueryViewerDataType.Date?"Days":"Seconds",t={qv:{}};t.qv.viewerId=h.userControlId();t.qv.seriesIndex=n;t.chart=function(b,c){var e={styledMode:!0};e.spacing=F(b);if(l(b)){var g=b.userControlId(),g=a(b)?x(g):g;e.renderTo=document.getElementById(g+"_chart"+c.toString())}else e.renderTo=a(b)?document.getElementById(x(b.userControlId())):b.getContainerControl();f(b)||(e.type=
r(b.RealChartType));b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==QueryViewerChartType.FilledRadar||b.RealChartType==QueryViewerChartType.PolarArea?e.polar=!0:b.RealChartType==QueryViewerChartType.Column3D||b.RealChartType==QueryViewerChartType.StackedColumn3D||b.RealChartType==QueryViewerChartType.Column3DLine?e.options3d={enabled:!0,alpha:15,beta:15,depth:50,viewDistance:25}:b.RealChartType==QueryViewerChartType.Pie3D||b.RealChartType==QueryViewerChartType.Doughnut3D?e.options3d=
{enabled:!0,alpha:45,beta:0}:a(b)&&(e.zoomType="x",e.resetZoomButton={theme:{display:"none"}},e.events={},e.events.selection=function(a){o(a)});return e}(h,n);t.credits={enabled:!1};t.legend={enabled:1<h.Chart.Series.DataFields.length&&!l(h)||d(h)||b(h),margin:0};t.title=""==h.Title?{text:null}:{text:null==n||0==n?qv.util.getTranslation(h.Title):null};t.subtitle=function(a,c){var e={};if(l(a)&&(d(a)||b(a)||a.RealChartType==QueryViewerChartType.CircularGauge))e.text=c.Name,e.floating=!0,e.align="left",
e.verticalAlign="middle";return e}(h,B);t.pane=function(a,b){var c={};if(a.RealChartType==QueryViewerChartType.CircularGauge){c.background=[];var e;l(a)&&(e=M(1,1));for(var g=0;g<a.Chart.Series.ByIndex.length;g++)if(!l(a)||g==b){var d=a.Chart.Series.ByIndex[g],f={};l(a)||(e=M(a.Chart.Series.DataFields.length,g+1));f.outerRadius=e.UpperExtreme.toString()+"%";f.innerRadius=e.LowerExtreme.toString()+"%";d=qv.util.IsNullColor(d.Color)?d.Points[0].Color:d.Color;w(a,f,d,!1);f.borderWidth=0;c.background.push(f)}}return c}(h,
n);t.xAxis=function(a,b){xAxis={tickWidth:1,tickLength:10};if(a.RealChartType!=QueryViewerChartType.CircularGauge){var e=c(a);if(a.RealChartType!=QueryViewerChartType.Radar&&a.RealChartType!=QueryViewerChartType.FilledRadar&&a.RealChartType!=QueryViewerChartType.PolarArea&&a.RealChartType!=QueryViewerChartType.LinearGauge&&a.RealChartType!=QueryViewerChartType.Sparkline){var g=xAxis,d="";if(""==a.XAxisTitle)for(var f=0;f<a.Metadata.Axes.length;f++){var h=a.Metadata.Axes[f];if(h.Visible==QueryViewerVisible.Yes||
h.Visible==QueryViewerVisible.Always)d+=(""==d?"":", ")+qv.util.getTranslation(h.Title)}else d=qv.util.getTranslationAlsoIfStatic(a.XAxisTitle);g.title={text:d}}else{a.RealChartType==QueryViewerChartType.Sparkline&&l(a)&&(xAxis.title={text:a.Chart.Series.ByIndex[b].Name});xAxis.lineWidth=0;if(a.RealChartType==QueryViewerChartType.LinearGauge||a.RealChartType==QueryViewerChartType.Sparkline)xAxis.tickPositions=[];xAxis.tickmarkPlacement=a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==
QueryViewerChartType.FilledRadar?"on":"between"}if(a.RealChartType==QueryViewerChartType.LinearGauge){var k;l(a)&&(k=p(1,1));xAxis.plotBands=[];for(g=0;g<a.Chart.Series.ByIndex.length;g++)if(!l(a)||g==b)d=a.Chart.Series.ByIndex[g],l(a)||(k=p(a.Chart.Series.DataFields.length,g+1)),plotBand={},d=qv.util.IsNullColor(d.Color)?d.Points[0].Color:d.Color,w(a,plotBand,d,!1),plotBand.from=k.LowerExtreme,plotBand.to=k.UpperExtreme,xAxis.plotBands.push(plotBand)}e||(xAxis.categories=[]);k=!1;for(g=0;g<a.Chart.Categories.Values.length;g++)""!=
a.Chart.Categories.Values[g].ValueWithPicture&&(k=!0),e||(xAxis.categories[g]=a.Chart.Categories.Values[g].ValueWithPicture);if(e)xAxis.type="datetime",xAxis.id="xaxis",xAxis.minRange=1,qv.util.XAxisDataType(a)==QueryViewerDataType.Date&&(null!=a.Chart.Categories.MaxValue&&null!=a.Chart.Categories.MinValue)&&(e=new gx.date.gxdate(a.Chart.Categories.MinValue,"Y4MD"),864E6>(new gx.date.gxdate(a.Chart.Categories.MaxValue,"Y4MD")).Value.getTime()-e.Value.getTime()&&(xAxis.tickInterval=864E5));else if(xAxis.labels=
{},xAxis.labels.enabled=k,a.XAxisLabels!=QueryViewerXAxisLabels.Horizontally&&!(a.RealChartType==QueryViewerChartType.Bar||a.RealChartType==QueryViewerChartType.StackedBar||a.RealChartType==QueryViewerChartType.StackedBar100)&&!m(a))a.XAxisLabels==QueryViewerXAxisLabels.Vertically?(e=90,k=5):(e=parseInt(a.XAxisLabels.replace("Rotated","")),k=10),xAxis.labels.rotation=360-e,xAxis.labels.y=k,xAxis.labels.align="right";m(a)?xAxis.className="highcharts-no-axis-line highcharts-yes-grid-line":a.RealChartType==
QueryViewerChartType.Sparkline&&(xAxis.className="highcharts-no-axis-line highcharts-no-grid-line")}return xAxis}(h,n);t.yAxis=function(a,e,c){function g(a){if(0==a.length)return!1;for(var b,e=0;e<a.length;e++)if(0==e)b=a[e].Picture;else if(a[e].Picture!=b)return!1;return!0}if(a.RealChartType==QueryViewerChartType.Sparkline)yAxis={visible:!1};else{var h;h=a.RealChartType==QueryViewerChartType.CircularGauge?null:l(a)?e.Name:N(a);f(a)&&!l(a)?(yAxis=[],yAxis[0]={title:{text:h}},yAxis[1]={title:{text:""},
opposite:!0}):yAxis={title:{text:h}};yAxis.plotLines=[];yAxis.plotBands=[];if(!d(a)&&!b(a)&&!q(a)){for(var k=0;k<a.Chart.PlotBands.length;k++){var D=a.Chart.PlotBands[k];if(null==e||e.Name==D.SeriesName)D.From==D.To&&null!=D.From?(h={value:D.From,width:1,zIndex:3},w(a,h,D.Color,!1),yAxis.plotLines.push(h)):(h={},w(a,h,D.Color,!1),h.from=!D.From?Number.MIN_VALUE:D.From,h.to=!D.To?Number.MAX_VALUE:D.To,yAxis.plotBands.push(h))}if(l(a)||1==a.Chart.Series.ByIndex.length||g(a.Chart.Series.ByIndex)){var o=
l(a)?e:a.Chart.Series.ByIndex[0];yAxis.labels={};yAxis.labels.formatter=function(){return qv.util.formatNumber(this.value,o.NumberFormat.DecimalPrecision,o.Picture,true)}}}if(a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar||a.RealChartType==QueryViewerChartType.PolarArea)yAxis.min=0,yAxis.gridLineInterpolation=a.RealChartType==QueryViewerChartType.Radar||a.RealChartType==QueryViewerChartType.FilledRadar?"polygon":"circle";if(q(a)){yAxis.min=0;for(k=yAxis.max=
0;k<a.Chart.Series.ByIndex.length;k++)if(!l(a)||k==c)h=a.Chart.Series.ByIndex[k],yAxis.max=Math.max(yAxis.max,100*h.MaximumValue/h.TargetValue);if(a.RealChartType==QueryViewerChartType.LinearGauge||100!=yAxis.max){h={className:"highcharts-dashed-plot-line",value:100};if(l(a)||1==a.Chart.Series.DataFields.length)c=l(a)?e:a.Chart.Series.ByIndex[0],a.RealChartType==QueryViewerChartType.LinearGauge?(e=-10,k=-5,D="right"):(e=15,k=0,D="center"),h.label={text:c.TargetValue,verticalAlign:"bottom",rotation:0,
y:e,x:k,align:D};yAxis.plotLines.push(h)}}a.RealChartType==QueryViewerChartType.LinearGauge?(yAxis.className="highcharts-no-axis-line highcharts-no-grid-line",yAxis.labels={enabled:!1}):a.RealChartType==QueryViewerChartType.CircularGauge&&(yAxis.lineWidth=0,yAxis.tickPositions=[]);k=e=!1;for(c=0;c<a.Chart.Series.ByIndex.length;c++)h=a.Chart.Series.ByIndex[c],h.PositiveValues&&(e=!0),h.NegativeValues&&(k=!0);if(!k&&!e)f(a)&&!l(a)?(yAxis[0].min=0,yAxis[1].min=0,yAxis[0].max=1,yAxis[1].max=1):(yAxis.min=
0,yAxis.max=1);else if(gx.lang.gxBoolean(a.XAxisIntersectionAtZero)&&(k||(f(a)&&!l(a)?(yAxis[0].min=0,yAxis[1].min=0):yAxis.min=0),!e))f(a)&&!l(a)?(yAxis[0].max=0,yAxis[1].max=0):yAxis.max=0}return yAxis}(h,B,n);t.plotOptions=function(b,e){function c(a){var b;b=l(a)||1==a.Chart.Series.DataFields.length?23*(l(a)?a.Chart.Series.DataFields.length:1):29;return a.getContainerControl().offsetHeight-b}function d(a){var b={radius:3,symbol:"circle",states:{hover:{radius:4}}};a.SelectionAllowed()&&(b.states.select=
{radius:5,lineWidth:1});return b}function f(a,b,e){b=b.touchingSliceAt;return["M",a.x+("left"===a.alignment?1:-1)*e.connectorPadding,a.y,"L",b.x,a.y,"L",b.x,b.y]}var h=gx.lang.gxBoolean(e.ShowValues),k={series:{}};k.series.events={};e.RealChartType==QueryViewerChartType.CircularGauge?(k.series.dataLabels={},k.series.dataLabels.enabled=1==e.Chart.Series.DataFields.length&&gx.lang.gxBoolean(e.ShowValues)||l(e),k.series.dataLabels.y=0,k.series.dataLabels.borderWidth=0,k.series.dataLabels.formatter=function(){return g(this,
e)},k.series.marker={enabled:!1}):h&&(k.series.dataLabels={},k.series.dataLabels.enabled=!0,k.series.dataLabels.connectorColor="#000000",k.series.dataLabels.formatter=function(){var a=l(e)?this.series.chart.options.qv.seriesIndex:this.series.index,a=a%e.Chart.Series.ByIndex.length,a=e.Chart.Series.ByIndex[a];return qv.util.formatNumber(this.point.y*(e.RealChartType==QueryViewerChartType.LinearGauge?a.TargetValue/100:1),a.NumberFormat.DecimalPrecision,a.Picture,!1)},e.RealChartType==QueryViewerChartType.LinearGauge&&
(k.series.dataLabels.inside=!0));if(l(e)&&e.RealChartType!=QueryViewerChartType.CircularGauge){k.series.point={};k.series.point.events={};var D=e.RealChartType!=QueryViewerChartType.LinearGauge;k.series.point.events.mouseOver=function(){s(e,this.series.chart.container,this.index,true,D)};k.series.point.events.mouseOut=function(){s(e,this.series.chart.container,this.index,false,D)}}if(e.ItemClick||e.SelectionAllowed())k.series.events.click=z;switch(b){case "bar":k.bar={};e.RealChartType==QueryViewerChartType.StackedBar?
(k.series.stacking="normal",k.bar.stacking="normal"):e.RealChartType==QueryViewerChartType.StackedBar100&&(k.series.stacking="percent",k.bar.stacking="percent");if(e.RealChartType==QueryViewerChartType.LinearGauge){h=p(e.Chart.Series.DataFields.length,1).Width*c(e);k.bar.pointWidth=h;k.bar.pointPadding=0;k.bar.groupPadding=0;for(var o=Number.MAX_VALUE,B=0;B<e.Chart.Series.DataFields.length;B++){var m=e.Chart.Series.ByIndex[B],m=m.Points[0].Value/m.TargetValue;m<o&&(o=m)}o*=e.getContainerControl().offsetWidth;
k.bar.borderRadius=Math.min(h/2,o/2)}break;case "column":k.column={};e.RealChartType==QueryViewerChartType.StackedColumn||e.RealChartType==QueryViewerChartType.StackedColumn3D||e.RealChartType==QueryViewerChartType.PolarArea?(k.series.stacking="normal",k.column.stacking="normal"):e.RealChartType==QueryViewerChartType.StackedColumn100&&(k.series.stacking="percent",k.column.stacking="percent");e.RealChartType==QueryViewerChartType.PolarArea&&(k.column.pointPadding=0,k.column.groupPadding=0);break;case "area":k.area=
{};e.RealChartType==QueryViewerChartType.StepArea&&(k.area.step="center");k.area.marker=d(e);e.RealChartType==QueryViewerChartType.StackedArea?k.area.stacking="normal":e.RealChartType==QueryViewerChartType.StackedArea100&&(k.area.stacking="percent");break;case "areaspline":k.areaspline={};k.areaspline.marker=d(e);break;case "line":k.line={};k.line.marker=d(e);e.RealChartType==QueryViewerChartType.StepLine?k.line.step="center":e.RealChartType==QueryViewerChartType.StepTimeline&&(k.line.step="left");
a(e)?k.series.connectNulls=!0:e.RealChartType==QueryViewerChartType.StackedLine?k.line.stacking="normal":e.RealChartType==QueryViewerChartType.StackedLine100&&(k.line.stacking="percent");break;case "spline":k.spline={};k.spline.marker=d(e);break;case "pie":k.pie={};if(e.RealChartType==QueryViewerChartType.Doughnut||e.RealChartType==QueryViewerChartType.Doughnut3D)k.pie.innerSize="35%";if(e.RealChartType==QueryViewerChartType.Pie3D||e.RealChartType==QueryViewerChartType.Doughnut3D)k.pie.depth=35;k.pie.dataLabels=
{enabled:h,connectorColor:"#c3c4c8",connectorShape:f};k.pie.showInLegend=!0;break;case "solidgauge":k.solidgauge={};k.solidgauge.showInLegend=!0;k.solidgauge.rounded=!0;break;case "funnel":k.funnel={};k.funnel.showInLegend=!0;k.funnel.dataLabels={enabled:h,connectorColor:"#c3c4c8",connectorShape:f};break;case "pyramid":k.pyramid={},k.pyramid.showInLegend=!0,k.pyramid.dataLabels={enabled:h,connectorColor:"#c3c4c8",connectorShape:f}}return k}(t.chart.type,h);t.tooltip=function(b){var c={};a(b)?(c.borderRadius=
1,c.shadow=!0,c.shared=1<b.Metadata.Data.length,c.useHTML=!1,c.formatter=function(){return 1===b.Metadata.Data.length?C(this,b.Chart.Series.ByIndex,l(b)):E(this,b.Chart.Series.ByIndex)}):b.RealChartType==QueryViewerChartType.StackedColumn100||b.RealChartType==QueryViewerChartType.StackedBar100||b.RealChartType==QueryViewerChartType.StackedArea100||b.RealChartType==QueryViewerChartType.StackedLine100?c.formatter=function(){return"<b>"+(""!=this.point.id?this.point.id:this.series.name)+"</b>: "+Math.round(100*
this.point.percentage)/100+"%"}:d(b)?c.formatter=function(){var a;if(l(b)){a=v(qv.collection[this.point.series.chart.options.qv.viewerId],this.point.index);var c=0<a.length?a[0].id:"",g=""!=c,d="";g&&(d+=e(c));for(c=0;c<a.length;c++)var f=a[c],d=d+((g||0<c?"<br/>":"")+f.series.name+": "),f=Math.round(100*f.percentage)/100,d=d+(f+"%");a=d}else f=Math.round(100*this.point.percentage)/100,a="<b>"+(""!=this.point.name?this.point.name:this.point.series.name)+"</b>: "+f+"%";return a}:b.RealChartType==QueryViewerChartType.CircularGauge?
(c.enabled=(1<b.Chart.Series.DataFields.length||!gx.lang.gxBoolean(b.ShowValues))&&!l(b),c.formatter=function(){return g(this,b)},c.positioner=function(a){return{x:(this.chart.plotWidth-a)/2,y:this.chart.plotHeight/2}}):c.formatter=function(){return C(this,b.Chart.Series.ByIndex,l(b)&&!q(b))};return c}(h);t.series=function(b,e,g){function d(b,e,g,f,h){f={};b.ItemClick&&b.Metadata.Data[g].RaiseItemClick&&(f.className="highcharts-drilldown-point");f.visible=e.Visible==QueryViewerVisible.Yes||e.Visible==
QueryViewerVisible.Always;f.events={legendItemClick:function(a){if(e.Visible==QueryViewerVisible.Always)a.preventDefault();else{var c=qv.chart.GetRuntimeMetadata(b),a=qv.util.GetElementInCollection(c,"Name",b.Chart.Series.ByIndex[a.target.index].FieldName);a.Hidden=!a.Hidden;qv.util.autorefresh.UpdateLayoutSameGroup(b,c,false)}}};if(a(b)){f.name=e.Name;f.data=[];f.turboThreshold=0;qv.util.IsNullColor(e.Color)||w(b,f,e.Color,!0);var D=k(b.Chart.Categories,e.Points,qv.util.XAxisDataType(b),e.Aggregation,
h);for(j=0;j<D.length;j++){var g=D[j].name,o=D[j].x,h=D[j].y,o=new gx.date.gxdate(o,"Y4MD");f.data[j]={x:o.Value.getTime()-6E4*o.Value.getTimezoneOffset(),y:h,name:g};qv.util.IsNullColor(e.Color)&&w(b,f.data[j],e.Points[j].Color,!0)}}else{b.RealChartType==QueryViewerChartType.CircularGauge&&(D=l(b)?M(1,1):M(b.Chart.Series.DataFields.length,g+1));f.name=e.Name;f.data=[];f.turboThreshold=0;qv.util.IsNullColor(e.Color)||w(b,f,e.Color,!0);if(b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==
QueryViewerChartType.FilledRadar||b.RealChartType==QueryViewerChartType.PolarArea)f.pointPlacement=b.RealChartType==QueryViewerChartType.Radar||b.RealChartType==QueryViewerChartType.FilledRadar?"on":null;for(j=0;j<e.Points.length;j++)(h=null!=e.Points[j].Value?parseFloat(qv.util.trim(e.Points[j].Value).replace(",",".")):null,q(b)&&(h=100*(h/e.TargetValue)),g=b.Chart.Categories.Values[j].ValueWithPicture,f.data[j]={},f.data[j].y=h,f.data[j].name=q(b)?"":g,f.data[j].id=f.data[j].name,c(b)&&(o=b.Chart.Categories.Values[j].Value,
o=new gx.date.gxdate(o,"Y4MD"),f.data[j].x=o.Value.getTime()-6E4*o.Value.getTimezoneOffset(),f.data[j].id=o),b.RealChartType==QueryViewerChartType.CircularGauge&&(f.data[j].radius=D.UpperExtreme.toString()+"%",f.data[j].innerRadius=D.LowerExtreme.toString()+"%"),b.RealChartType==QueryViewerChartType.CircularGauge)?(g=qv.util.IsNullColor(e.Color)?e.Points[0].Color:e.Color,w(b,f.data[j],g,!0)):qv.util.IsNullColor(e.Color)&&w(b,f.data[j],e.Points[j].Color,!0)}return f}for(var h=[],D=0;D<b.Chart.Series.ByIndex.length;D++)if(!l(b)||
D==e){var o=d(b,b.Chart.Series.ByIndex[D],D,h,g),B=null!=e?e:D;f(b)&&(0==B%2?(o.type="column",o.yAxis=0):(o.type="line",o.yAxis=l(b)?0:1));h.push(o)}return h}(h,n,y);return t}function N(a){var b="";if(""==a.YAxisTitle){if(1==a.Chart.Series.DataFields.length){var e;a:for(b=0;b<a.Metadata.Data.length;b++)if(a.Metadata.Data[b].DataField==a.Chart.Series.DataFields[0]){e=a.Metadata.Data[b];break a}b=qv.util.getTranslation(e.Title)}}else b=qv.util.getTranslationAlsoIfStatic(a.YAxisTitle);return b}function H(a){return!isNaN(parseFloat(a))&&
isFinite(a)?gx.dom.el(T+"_Zoom_"+a+"m"):gx.dom.el(a)}function t(a,b){if(zoom=H(a))zoom.style.textDecoration=b}function G(a){if(zoom=H(a))zoom.onclick();else if(0!=a){var b;switch(a){case 12:b=6;break;case 6:b=3;break;case 3:b=2;break;case 2:b=1;break;case 1:b=0}G(b)}}function y(a,b){gx.dom.el(a+"_options_compare_enable").disabled=!b;gx.dom.el(a+"_options_compare_text").disabled=!b;gx.dom.el(a+"_options_compare_text").style.opacity=!b?0.5:1;gx.dom.el(a+"_options_compare_options").disabled=!b;gx.dom.el(a+
"_options_compare_options").style.opacity=!b?0.5:1}function A(a){return a+"_options"}function x(a){return a+"_center"}function K(a){return a+"_footer_slider"}function ba(a){return a+"_footer_chart"}function U(a){return a+"_footer_range"}function Y(a){return a+"_footer_left_cursor"}function L(a){return a+"_footer_right_cursor"}function I(a){return a+"_footer_center"}function ca(a,b,e){var c=Math.max(b,0),b=Math.min(c,100),c=Math.max(e,0),e=Math.min(c,100);jQuery("#"+(a+"_footer")).css("width","100%").css("height",
R.toString()+"px");jQuery("#"+ba(a)).css("width","100%").css("height",(R-2).toString()+"px");c=qv.collection[a].getContainerControl().offsetWidth;b=b*c/100;e=(100-e)*c/100;if(c-b-e<2*S){var g=2*S-(c-b-e),d;d=0==g%2?g/2:(g+1)/2;b-=d;e-=g-d;0>b&&(e+=b,b=0);0>e&&(b+=e,e=0)}jQuery("#"+K(a)).css("width","100%").css("height",R.toString()+"px").css("padding-left",(100*b/c).toString()+"%").css("padding-right",(100*e/c).toString()+"%");jQuery("#"+U(a)).css("width","100%").css("height",R.toString()+"px");jQuery("#"+
Y(a)).css("width",S.toString()+"px").css("height",R.toString()+"px");jQuery("#"+L(a)).css("width",S.toString()+"px").css("height",R.toString()+"px");jQuery("#"+I(a)).css("width","calc(100% - "+2*S+"px)").css("height",R.toString()+"px").css("left",S.toString()+"px")}function ga(a,b){var e=parseInt(jQuery("#"+K(a)).css("padding-left")),c=parseInt(jQuery("#"+U(a)).css("width")),g;g=b.originalEvent.touches?b.originalEvent.touches[0].pageX-b.originalEvent.touches[0].target.offsetLeft:b.offsetX;switch(b.target.id){case K(a):return g;
case Y(a):return g+e;case I(a):return g+e;case L(a):return g+e+c-S}}function ia(b){function e(a){a.preventDefault();O=b;var c=jQuery("#"+K(O)),g=jQuery("#"+U(O));parseInt(c.css("padding-left"));ha=ga(O,a);Z=parseInt(c.css("padding-left"));da=parseInt(c.css("padding-right"));aa=parseInt(c.css("width"));ea=parseInt(g.css("width"))}function c(){if(W||P||Q){var b=jQuery("#"+K(O)),e=qv.collection[O],g=gx.dom.el(O+"_options_compare_enable").checked,d=e.getContainerControl().offsetWidth,f;f=a(e)?x(e.userControlId()):
e.getContainerControl().id;var e=l(e)?jQuery("[id^="+f+"_chart]"):jQuery("#"+f),k=[];jQuery.each(e,function(a,b){var e=jQuery("#"+b.id).highcharts();k.push(e)});e=k[0];f=parseInt(b.css("padding-left"));var h=parseInt(b.css("padding-right")),b=100*f/d,d=100*(1-h/d);if(0==b&&100==d)jQuery.each(k,function(a,b){b.zoomOut()});else{e.get("xaxis").getExtremes();var e=e.options.qv,o=e.dataMin+b/100*(e.dataMax-e.dataMin),B=e.dataMin+d/100*(e.dataMax-e.dataMin),m=g?!1:!0;jQuery.each(k,function(a,b){b.get("xaxis").setExtremes(o,
B,m)})}g&&X(k);if(P||Q)t(V,"none"),V=null}P=Q=W=!1}function g(a){if(W||P||Q)if(a=ga(O,a)-ha,a=Q?Math.min(a,ea-2*S):Math.min(a,da),a=P?Math.max(a,-ea+2*S):Math.max(a,-Z),0!=a){jQuery("#"+I(O));var b=jQuery("#"+K(O));jQuery("#"+U(O));Q?b.css("padding-left",(100*(Z+a)/aa).toString()+"%"):(P||b.css("padding-left",(100*(Z+a)/aa).toString()+"%"),b.css("padding-right",(100*(da-a)/aa).toString()+"%"))}}var d=jQuery("#"+Y(b)),f=jQuery("#"+L(b)),k=jQuery("#"+I(b)),h=jQuery("#"+K(b));jQuery("#"+U(b));d.mousedown(function(a){a.preventDefault();
Q=!0});f.mousedown(function(a){a.preventDefault();P=!0});k.mousedown(function(a){a.preventDefault();!Q&&!P&&(W=!0)});h.mousedown(function(a){e(a)});jQuery(document).mouseup(function(a){c(a)});h.mousemove(function(a){g(a)});d.on("touchstart",function(a){a.preventDefault();Q=!0});f.on("touchstart",function(a){a.preventDefault();P=!0});k.on("touchstart",function(a){a.preventDefault();!Q&&!P&&(W=!0)});h.on("touchstart",function(a){e(a)});jQuery(document).on("touchend",function(a){c(a)});jQuery(document).on("touchcancel",
function(a){c(a)});h.on("touchmove",function(a){g(a)})}function ja(a,b){var e=qv.util.dom.createDiv(a,K(b),"gx-qv-footer-slider","",{},""),e=qv.util.dom.createDiv(e,U(b),"gx-qv-footer-range","",{},"");qv.util.dom.createDiv(e,Y(b),"gx-qv-footer-left-cursor","",{},"");qv.util.dom.createDiv(e,L(b),"gx-qv-footer-right-cursor","",{},"");qv.util.dom.createDiv(e,I(b),"gx-qv-footer-center","",{},"");qv.util.dom.createDiv(a,ba(b),"gx-qv-footer-chart","",{},"")}function ka(a,b){var e=ba(a.userControlId()),
c=a.RealChartType==QueryViewerChartType.SmoothTimeline?"spline":"line",g=a.RealChartType==QueryViewerChartType.StepTimeline?"left":"",d=[];if(l(a))for(f=0;f<b.length;f++)d.push(b[f].series[0]);else for(var f=0;f<b[0].series.length;f++)d.push(b[0].series[f]);return qv.chart.getSparklineChartOptions(a,e,c,!1,g,d)}function X(a){var b=a[0],e=b.options.qv.viewerId,c=qv.collection[e],g=gx.dom.el(e+"_options_compare_enable").checked,d=b.get("xaxis").getExtremes();void 0!=d.userMin&&(d.min=d.userMin);void 0!=
d.userMax&&(d.max=d.userMax);if(g){var f=gx.dom.el(e+"_options_compare_options").children,h;for(ind=0;void 0!=f[ind]&&void 0==h;ind++)f[ind].selected&&(h=f[ind].value);var o,B;"PrevPeriod"==h?(B=new Date(d.min),o=new Date(d.min-(d.max-d.min))):"PrevYear"==h&&(o=new Date(d.min),o=new Date(o.setFullYear(o.getFullYear()-1)),B=new Date(d.max),B=new Date(B.setFullYear(B.getFullYear()-1)));o=o.getTime();B=B.getTime();if(zoom=H(e+"_Zoom_0m"))zoom.style.display="none"}else if(zoom=H(e+"_Zoom_0m"))zoom.style.display=
"";jQuery.each(a,function(a,b){for(var e=[];b.series.length>0;){b.options.qv.colorIndexesUsed||e.push(b.series[0].colorIndex);b.series[0].remove(true)}if(!b.options.qv.colorIndexesUsed)b.options.qv.colorIndexesUsed=e});for(var m=f=0;m<c.Chart.Series.ByIndex.length;m++){var s=c.Chart.Series.ByIndex[m];seriesName=s.Name;var w,n;l(c)?(w=a[f],n=w.options.qv.colorIndexesUsed[0]):(w=b,n=w.options.qv.colorIndexesUsed[f]);var C={turboThreshold:0};C.colorIndex=n;C.id=seriesName+"1";C.name=seriesName;C.data=
[];if(g){var p={className:"highcharts-dashed-series-line",turboThreshold:0};p.colorIndex=n;p.id=seriesName+"2";p.name=seriesName;p.data=[]}n=document.getElementById(e+"_options_group_options").value;s=k(c.Chart.Categories,s.Points,qv.util.XAxisDataType(c),s.Aggregation,n);for(i=0;i<s.length;i++){n=s[i].y;var t=new gx.date.gxdate(s[i].x,"Y4MD"),y=s[i].name,F=t.Value.getTime()-6E4*t.Value.getTimezoneOffset(),t=t.Value.getTime()-6E4*t.Value.getTimezoneOffset();if(g){var x=!1,r=!1;F<=d.max&&F>=d.min&&
(x=!0);if(F<=B&&F>=o){var r=!0,A=new Date(F),E;"PrevPeriod"==h?E="1m"==w.options.qv.predef_zoom?A.setMonth(A.getMonth()+1):"2m"==w.options.qv.predef_zoom?A.setMonth(A.getMonth()+2):"3m"==w.options.qv.predef_zoom?A.setMonth(A.getMonth()+3):"6m"==w.options.qv.predef_zoom?A.setMonth(A.getMonth()+6):"12m"==w.options.qv.predef_zoom?A.setFullYear(A.getFullYear()+1):E+(d.max-d.min):"PrevYear"==h&&(E=A.setFullYear(A.getFullYear()+1))}x&&(x={},x.x=F,x.y=n,x.name=y,C.data.push(x));r&&(x={},x.x=E,x.y=n,x.name=
y,x.real_x=t,p.data.push(x))}else C.data.push({x:F,y:n,name:y})}w.addSeries(C);g&&w.addSeries(p);f++}}function la(a,b){if(a.length<b)return 0;var e=(a[a.length-1].x-a[a.length-b].x)/1E3/3600/24/(365/12);return 1>=e?1:2>=e?2:3>=e?3:6>=e?6:12}function ma(a,b){function e(a,b,c,g,d,f,k,h,o){var l=b.userControlId(),a=qv.util.dom.createSelect(a,A(l)+"_group_options");qv.util.XAxisDataType(b)==QueryViewerDataType.DateTime&&(qv.util.dom.createOption(a,"Seconds","Seconds"==b._groupOption,gx.getMessage("GXPL_QViewerSeconds")),
o&&(qv.util.dom.createOption(a,"Minutes","Minutes"==b._groupOption,gx.getMessage("GXPL_QViewerMinutes")),h&&qv.util.dom.createOption(a,"Hours","Hours"==b._groupOption,gx.getMessage("GXPL_QViewerHours"))));if(r||qv.util.XAxisDataType(b)==QueryViewerDataType.Date)qv.util.dom.createOption(a,"Days","Days"==b._groupOption,gx.getMessage("GXPL_QViewerDays")),k&&(qv.util.dom.createOption(a,"Weeks","Weeks"==b._groupOption,gx.getMessage("GXPL_QViewerWeeks")),f&&(qv.util.dom.createOption(a,"Months","Months"==
b._groupOption,gx.getMessage("GXPL_QViewerMonths")),d&&(qv.util.dom.createOption(a,"Quarters","Quarters"==b._groupOption,gx.getMessage("GXPL_QViewerQuarters")),g&&(qv.util.dom.createOption(a,"Semesters","Semesters"==b._groupOption,gx.getMessage("GXPL_QViewerSemesters")),c&&qv.util.dom.createOption(a,"Years","Years"==b._groupOption,gx.getMessage("GXPL_QViewerYears"))))));return a}var c=a[0];T=c.options.qv.viewerId;var g=qv.collection[T],d=document.getElementById(A(T)),f=document.getElementById(T+"_footer"),
k=c.get("xaxis").getExtremes(),h=k.dataMax-k.dataMin;jQuery.each(a,function(a,b){b.options.qv.dataMax=k.dataMax;b.options.qv.dataMin=k.dataMin});var o=2628288E3<h,l=5255712E3<h,B=7884E6<h,s=15768E6<h,h=31536E6<h;g._groupOption=g._groupOption||(qv.util.XAxisDataType(g)==QueryViewerDataType.Date?"Days":"Seconds");var m=new gx.date.gxdate(""),w=new gx.date.gxdate("");m.Value.setTime(k.dataMin+6E4*m.Value.getTimezoneOffset());w.Value.setTime(k.dataMax+6E4*w.Value.getTimezoneOffset());var n=!0,C=!0,p=
!0,x=!0,F=!0,r=!0,E=!0,u=!0;gx.date.year(m)==gx.date.year(w)&&(n=!1,6>=gx.date.month(m)&&7<=gx.date.month(w)||(C=!1,3>=gx.date.month(m)&&4<=gx.date.month(w)||(6>=gx.date.month(m)&&7<=gx.date.month(w)||9>=gx.date.month(m)&&10<=gx.date.month(w))||(p=!1,gx.date.month(m)==gx.date.month(w)&&(x=!1,gx.date.day(m)-gx.date.dow(m)==gx.date.day(w)-gx.date.dow(w)&&(F=!1,gx.date.day(m)==gx.date.day(w)&&(r=!1,gx.date.hour(m)==gx.date.hour(w)&&(E=!1,gx.date.minute(m)==gx.date.minute(w)&&(u=!1))))))));(function(a,
b,c,g,d,f,k,h,o,l,B,m,s,w){function n(a){return qv.util.dom.createDiv(a,"","QVTimelineHeaderGroup","",{height:fa+"px",flexGrow:1},"")}function C(a,b,e){return qv.util.dom.createAnchor(a,e,{cursor:"pointer",paddingLeft:"6px"},b)}var p=b.userControlId(),a=qv.util.dom.createDiv(a,"","QVTimelineHeader","",{display:"flex",flexDirection:"row",flexWrap:"wrap"},""),t=n(a),y=n(a),x=n(a),t=qv.util.dom.createDiv(t,"","","",{"float":"left"},"");qv.util.dom.createText(t,gx.getMessage("GXPL_QViewerJSChartZoom"));
if(c){C(t,gx.getMessage("GXPL_QViewerJSChartZoomLevelToOneMonth"),p+"_Zoom_1m");if(g){C(t,gx.getMessage("GXPL_QViewerJSChartZoomLevelToTwoMonth"),p+"_Zoom_2m");if(d){C(t,gx.getMessage("GXPL_QViewerJSChartZoomLevelToThreeMonth"),p+"_Zoom_3m");if(f){C(t,gx.getMessage("GXPL_QViewerJSChartZoomLevelToSixMonth"),p+"_Zoom_6m");k&&C(t,gx.getMessage("GXPL_QViewerJSChartZoomLevelToOneYear"),p+"_Zoom_12m")}}}}C(t,gx.getMessage("GXPL_QViewerJSChartZoomLevelToAll"),p+"_Zoom_0m");c=qv.util.dom.createDiv(y,"","",
"",{"float":"right",paddingLeft:"12px"},"");qv.util.dom.createSpan(c,A(p)+"_groupby_text","","",{whiteSpace:"nowrap",paddingRight:"6px"},null,gx.getMessage("GXPL_QViewerGroupBy"));e(c,b,h,o,l,B,m,s,w);b=qv.util.dom.createDiv(x,"","","",{"float":"right",paddingLeft:"12px"},"");qv.util.dom.createInput(b,A(p)+"_compare_enable","checkbox",{verticalAlign:"text-bottom"});qv.util.dom.createSpan(b,A(p)+"_compare_text","","",{whiteSpace:"nowrap",paddingRight:"6px",paddingLeft:"6px"},null,gx.getMessage("GXPL_QViewerCompareWith"));
p=qv.util.dom.createSelect(b,A(p)+"_compare_options");qv.util.dom.createOption(p,"PrevPeriod",false,gx.getMessage("GXPL_QViewerPreviousPeriod"));qv.util.dom.createOption(p,"PrevYear",false,gx.getMessage("GXPL_QViewerPreviousYear"));return a})(d,g,o,l,B,s,h,n,C,p,x,F,E,u);ja(f,T);ia(T);gx.dom.el(d.id+"_compare_enable").onclick=function(){X(a)};gx.dom.el(d.id+"_compare_options").onchange=function(){gx.dom.el(d.id+"_compare_enable").checked&&X(a)};gx.dom.el(d.id+"_group_options").onchange=function(){X(a)};
var f=function(b){var e=gx.dom.el(d.id+"_compare_enable").checked;if(b>0){var g,f;f=c.get("xaxis").getExtremes().dataMax;g=f-b*2628028800;var k=e?false:true;jQuery.each(a,function(a,b){b.get("xaxis").setExtremes(g,f,k)});var h=c.options.qv;ca(c.options.qv.viewerId,(g-h.dataMin)/(h.dataMax-h.dataMin)*100,(f-h.dataMin)/(h.dataMax-h.dataMin)*100);y(c.options.qv.viewerId,true)}else{jQuery.each(a,function(a,b){b.zoomOut()});y(c.options.qv.viewerId,false)}t(V,"none");t(this.id,"underline");jQuery.each(a,
function(a,e){e.options.qv.predef_zoom=b+"m"});V=this.id;e&&X(a)},o=[0,1,2,3,6,12],q;for(q in o)if(l=o[q],B=gx.dom.el(T+"_Zoom_"+l+"m"))B.onclick=f.closure(B,[l]);q=la(c.series[0].points,20);G(q);g=ka(g,b);new Highcharts.Chart(g)}function na(b){var e=qv.collection[b.options.qv.viewerId];if(!c(e)){var g=e.SelectionAllowed(),d=!1;if(e.ItemClick)for(var f=0;f<e.Metadata.Axes.length;f++)if(e.Metadata.Axes[f].RaiseItemClick){d=!0;break}(d||g)&&jQuery.each(b.xAxis[0].ticks,function(e,c){c&&c.label&&(d&&
c.label.addClass("gx-qv-clickable-element"),c.label.on("click",function(){var f=d,k=qv.collection[b.options.qv.viewerId],o=!1;g&&!a(k)&&(o=u(k.Charts,c.pos));f&&(f=1==k.Chart.Categories.DataFields.length?qv.util.GetAxisByDataField(k,k.Chart.Categories.DataFields[0]).Name:"",h(k.ItemClickData,k,f,QueryViewerElementType.Axis,c.label.textStr,o,k.Data.Rows[e]),k.ItemClick())}))})}}var V=null,T=null,fa=35,R=50,S=10,ha=0,O="",Z=0,da=0,ea=0,aa=0,Q=!1,P=!1,W=!1;return{tryToRenderChart:function(b){var e="";
(new Date).getTime();b.xml=b.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(b,function(b,c){var g=!1;b!=c.xml.recordsetCacheKey&&(c.xml.recordsetCacheKey=b,g=!0);qv.util.anyError(b)?(e=qv.util.getErrorFromText(b),qv.util.renderError(c,e)):(g&&qv.services.parseRecordsetCacheKeyXML(c),qv.services.GetMetadataIfNeeded(c,function(b,c){var g=false;if(b!=c.xml.metadata){c.xml.metadata=b;g=true}(new Date).getTime();if(qv.util.anyError(b)){e=qv.util.getErrorFromText(b);qv.util.renderError(c,e)}else{g&&qv.services.parseMetadataXML(c);
c.Metadata.ParserResult.Success?qv.services.GetDataIfNeeded(c,function(b,c){var g=false;if(b!=c.xml.data){c.xml.data=b;g=true}(new Date).getTime();if(qv.util.anyError(b)){e=qv.util.getErrorFromText(b);qv.util.renderError(c,e)}else{g&&qv.services.parseDataXML(c);g=qv.util.GetContainerControlClasses(c);g!=""&&qv.util.SetUserControlClass(c,g);g=qv.util.ProcessDataAndMetadata(c);if(g==""){var d=c.userControlId(),g=qv.util.dom.getEmptyContainer(c);if((a(c)||l(c))&&g.offsetHeight==0)g.style.height="400px";
if(a(c)){qv.util.dom.createDiv(g,A(d),"QVTimelineHeaderContainer","",{width:"100%",height:fa+"px"},"");var f=qv.util.dom.createDiv(g,x(d),"","",{width:"100%",height:"calc(100% - "+fa+"px - "+R+"px)"},"");qv.util.dom.createDiv(g,d+"_footer","gx-qv-footer","",{width:"100%",height:R+"px"},"");g.style.padding=DEFAULTCHARTSPACING+"px";g=f}if(l(c))for(var f=c.Chart.Series.DataFields.length,k=parseInt(100/f),h=100%f,d=a(c)?x(d):d,o=0;o<f;o++)qv.util.dom.createDiv(g,d+"_chart"+o.toString(),"","",{width:"100%",
height:(k+(o<h?1:0)).toString()+"%"},"");g=[];if(l(c))for(f=0;f<c.Chart.Series.ByIndex.length;f++){k=J(c,c.Chart.Series.ByIndex[f],f);g.push(k)}else{k=J(c,null,null);g.push(k)}if(c.RealChartType==QueryViewerChartType.CircularGauge){f=qv.util.GetThemeStyleSheet(c);f.insertRule("#"+c.ContainerName+" .highcharts-tooltip-box {fill: none !important; stroke-width: 0 !important; }",f.cssRules.length)}Highcharts.setOptions({lang:{months:[gx.getMessage("GXPL_QViewerJanuary"),gx.getMessage("GXPL_QViewerFebruary"),
gx.getMessage("GXPL_QViewerMarch"),gx.getMessage("GXPL_QViewerApril"),gx.getMessage("GXPL_QViewerMay"),gx.getMessage("GXPL_QViewerJune"),gx.getMessage("GXPL_QViewerJuly"),gx.getMessage("GXPL_QViewerAugust"),gx.getMessage("GXPL_QViewerSeptember"),gx.getMessage("GXPL_QViewerOctober"),gx.getMessage("GXPL_QViewerNovember"),gx.getMessage("GXPL_QViewerDecember")],weekdays:[gx.getMessage("GXPL_QViewerSunday"),gx.getMessage("GXPL_QViewerMonday"),gx.getMessage("GXPL_QViewerTuesday"),gx.getMessage("GXPL_QViewerWednesday"),
gx.getMessage("GXPL_QViewerThursday"),gx.getMessage("GXPL_QViewerFriday"),gx.getMessage("GXPL_QViewerSaturday")],shortMonths:[gx.getMessage("GXPL_QViewerJanuary").substring(0,3),gx.getMessage("GXPL_QViewerFebruary").substring(0,3),gx.getMessage("GXPL_QViewerMarch").substring(0,3),gx.getMessage("GXPL_QViewerApril").substring(0,3),gx.getMessage("GXPL_QViewerMay").substring(0,3),gx.getMessage("GXPL_QViewerJune").substring(0,3),gx.getMessage("GXPL_QViewerJuly").substring(0,3),gx.getMessage("GXPL_QViewerAugust").substring(0,
3),gx.getMessage("GXPL_QViewerSeptember").substring(0,3),gx.getMessage("GXPL_QViewerOctober").substring(0,3),gx.getMessage("GXPL_QViewerNovember").substring(0,3),gx.getMessage("GXPL_QViewerDecember").substring(0,3)],numericSymbols:null}});f=[];for(k=0;k<g.length;k++){HCChart=new Highcharts.Chart(g[k],na);f.push(HCChart)}c.Charts=f;a(c)&&ma(f,g);c._ControlRenderedTo=c.RealType;qv.util.hideActivityIndicator(c)}else qv.util.renderError(c,g)}}):qv.util.renderError(c,c.Metadata.ParserResult.Message)}}))})},
GetMetadataChart:function(a){var b=qv.util.GetDesigntimeMetadata(a);(function(a,b){function e(a,b,c){for(var g=0;g<a.length;g++){var d=a[g];if(d.Name==b){d.Visible=c?QueryViewerVisible.Yes:QueryViewerVisible.No;break}}}if(a.PlotSeries==QueryViewerPlotSeries.InTheSameChart)for(var c=0;c<a.Charts[0].series.length;c++){var g=a.Charts[0].series[c],d=a.Chart.Series.ByIndex[c].FieldName;e(b,d,g.visible)}else for(c=0;c<a.Charts.length;c++)g=a.Charts[c].series[0],d=a.Chart.Series.ByIndex[c].FieldName,e(b,
d,g.visible)})(a,b);return b},GetRuntimeMetadata:function(a){for(var b=[],e,c=e=0;c<a.Metadata.Axes.length;c++){var g=a.Metadata.Axes[c];g.Visible!=QueryViewerVisible.Never&&(e+=1);b.push({Name:g.Name,Type:QueryViewerElementType.Axis,Axis:g.Axis,Position:g.Visible!=QueryViewerVisible.Never?e:null,Hidden:g.Visible==QueryViewerVisible.Never||g.Visible==QueryViewerVisible.No})}for(c=e=0;c<a.Metadata.Data.length;c++)g=a.Metadata.Data[c],g.Visible!=QueryViewerVisible.Never&&(e+=1),b.push({Name:g.Name,
Type:QueryViewerElementType.Datum,Axis:"",Position:g.Visible!=QueryViewerVisible.Never?e:null,Hidden:g.Visible==QueryViewerVisible.Never||g.Visible==QueryViewerVisible.No});if(a.PlotSeries==QueryViewerPlotSeries.InTheSameChart)for(e=0;e<a.Charts[0].series.length;e++)c=a.Charts[0].series[e],g=a.Chart.Series.ByIndex[e].FieldName,g=qv.util.GetElementInCollection(b,"Name",g),g.Hidden=!c.visible;else for(e=0;e<a.Charts.length;e++)c=a.Charts[e].series[0],g=a.Chart.Series.ByIndex[e].FieldName,g=qv.util.GetElementInCollection(b,
"Name",g),g.Hidden=!c.visible;return b},GetDataChart:function(a){return a.xml.data},getSparklineChartOptions:function(a,b,e,c,g,d){a={chart:{}};a.chart.renderTo=b;a.chart.margin=0;a.chart.type=e;a.chart.styledMode=!0;c&&(a.chart.className="highcharts-no-background");a.title={};a.title.text="";a.credits={};a.credits.enabled=!1;a.xAxis={};a.xAxis.visible=!1;a.yAxis={};a.yAxis.visible=!1;a.legend={};a.legend.enabled=!1;a.tooltip={};a.tooltip.enabled=!1;a.plotOptions={};a.plotOptions.series={};a.plotOptions.series.animation=
!1;a.plotOptions.series.connectNulls=!0;a.plotOptions.series.enableMouseTracking=!1;a.plotOptions.series.lineWidth=1;a.plotOptions.series.shadow=!1;a.plotOptions.series.states={};a.plotOptions.series.states.hover={};a.plotOptions.series.states.hover.lineWidth=1;a.plotOptions.series.marker={};a.plotOptions.series.marker.radius=0;a.plotOptions.series.marker.states={};a.plotOptions.series.marker.states.hover={};a.plotOptions.series.marker.states.hover.radius=2;""!=g&&(a.plotOptions.series.step=g);a.series=
[];for(b=0;b<d.length;b++)a.series.push(d[b]);return a},IsDatetimeXAxis:function(a){return c(a)},IsSingleSerieChart:function(a){return d(a)||b(a)},IsAreaChart:function(a){return a.RealChartType==QueryViewerChartType.Area||a.RealChartType==QueryViewerChartType.StackedArea||a.RealChartType==QueryViewerChartType.StackedArea100||a.RealChartType==QueryViewerChartType.SmoothArea||a.RealChartType==QueryViewerChartType.StepArea},IsLineChart:function(b){return b.RealChartType==QueryViewerChartType.Line||b.RealChartType==
QueryViewerChartType.StackedLine||b.RealChartType==QueryViewerChartType.StackedLine100||b.RealChartType==QueryViewerChartType.SmoothLine||b.RealChartType==QueryViewerChartType.StepLine||b.RealChartType==QueryViewerChartType.Sparkline||a(b)},IsSplittedChart:function(a){return l(a)},IsGaugeChart:function(a){return q(a)},Select:function(a,b){for(var e=[],c=0;c<a.Data.Rows.length;c++){var g=a.Data.Rows[c],d=!0;for(j=0;j<b.length;j++){var f=b[j];if(g[f.DataField]&&qv.util.trim(g[f.DataField])!=qv.util.trim(f.Value)){d=
!1;break}}d&&e.push(c)}if(0<e.length){c=a.Charts;for(g=0;g<c.length;g++)for(var d=c[g],f=!1,k=0;k<e.length;k++)for(var h=e[k],o=0;o<d.series.length;o++)d.series[o].points[h].select(!0,f),f||(f=!0)}else n(a.Charts)},Deselect:function(a){n(a.Charts)}}}();
qv.card=function(){function a(a,b){if(0!=a.ConditionalStyles.length)for(var c=0;c<a.ConditionalStyles.length;c++){var d=a.ConditionalStyles[c];if(qv.util.satisfyStyle(b,d))return qv.util.css.parseStyle(d.StyleOrClass)}return qv.util.css.parseStyle(a.Style)}function c(a,b,c,d){function f(a,b){var e=gx.date.now(),c;switch(a){case QueryViewerTrendPeriod.LastYear:c=gx.date.addyr(e,-1);break;case QueryViewerTrendPeriod.LastSemester:c=gx.date.addmth(e,-6);break;case QueryViewerTrendPeriod.LastQuarter:c=
gx.date.addmth(e,-3);break;case QueryViewerTrendPeriod.LastMonth:c=gx.date.addmth(e,-1);break;case QueryViewerTrendPeriod.LastWeek:c=gx.date.dtadd(e,-604800);break;case QueryViewerTrendPeriod.LastDay:c=gx.date.dtadd(e,-86400);break;case QueryViewerTrendPeriod.LastHour:c=gx.date.dtadd(e,-3600);break;case QueryViewerTrendPeriod.LastMinute:c=gx.date.dtadd(e,-60);break;case QueryViewerTrendPeriod.LastSecond:c=gx.date.dtadd(e,-1)}return qv.util.dateToString(c,b==QueryViewerDataType.DateTime)}var l={};
if(a.IncludeTrend)if(a.TrendPeriod==QueryViewerTrendPeriod.SinceTheBeginning||""==a.TrendPeriod)l=0;else for(var e=f(a.TrendPeriod,d),l=a.Data.Rows.length-1,g=a.Data.Rows.length-2;0<=g&&!(a.Data.Rows[g][c]<e);g--)l=g;else l=a.Data.Rows.length-1;return l=function(a,b,e,c,g,d){var f=null,h=null,l=null,m=null,s=[],n={AnyTrend:!1};if(""!=e){for(var t=g.length-1,r=0,y=0,A=0,x=0,u=0,q=0,z=null,v=null;a<=t;a++)if(void 0!=g[a][e]&&void 0!=g[a][c]){var r=r+1,L=new gx.date.gxdate(g[a][e],"Y4MD"),I=parseFloat(g[a][c]);
s.push({x:L.Value.getTime()-6E4*L.Value.getTimezoneOffset(),y:I});if(null==f&&null==h)h=f=I,l=g[a][e],m=g[a][e];else if(I>h&&(m=g[a][e],h=I),I<f)l=g[a][e],f=I;a>=b&&(null==z&&null==v&&(z=L,v=I),L=d==QueryViewerDataType.Date?gx.date.daysDiff(L,z):gx.date.secDiff(L,z),I-=v,y+=L,A+=I,x+=L*I,u+=L*L,q+=I*I)}n.AnyTrend=1<r;n.Slope=(r*x-y*A)/(r*u-y*y);n.Intercept=(A-n.Slope*y)/r;n.R2=Math.pow((r*x-y*A)/Math.sqrt((r*u-y*y)*(r*q-A*A)),2)}b={};b.LinearRegression=n;b.MinValue=f;b.MinWhen=l;b.MaxValue=h;b.MaxWhen=
m;b.ChartSeriesData=s;return b}(a.IncludeSparkline||a.IncludeMaxAndMin?0:l,l,c,b.DataField,a.Data.Rows,d)}function d(a,b,c,d){function f(a,b){function e(a,b,c){var g=[];if(c)for(c=0;c<b.length;c++)g.push(b[c][a]);else g.push(b[b.length-1][a]);return g}for(var c=[],d=0;d<a.Metadata.Axes.length;d++){var h=a.Metadata.Axes[d];if(!h.IsComponent){var l={};l.Name=h.Name;l.Values=e(h.DataField,a.Data.Rows,b);c.push(l)}}for(d=0;d<a.Metadata.Data.length;d++)h=a.Metadata.Data[d],h.IsComponent||(l={},l.Name=
h.Name,l.Values=e(h.DataField,a.Data.Rows,b),c.push(l));return c}for(var l=null,e=0;e<b.Metadata.Data.length;e++)if(b.Metadata.Data[e].Name==c){l=b.Metadata.Data[e];break}null!=l&&(a.Name=l.Name,a.Type=QueryViewerElementType.Datum,a.Axis="",c=d?qv.util.aggregateData(b.Metadata.Data,b.Data.Rows):b.Data.Rows[b.Data.Rows.length-1],a.Value=c[l.DataField],a.Context=f(b,d))}function b(a,b){return a+"_card_sparkline_"+b}function m(a,c,d){d=b(a.userControlId(),d);return qv.chart.getSparklineChartOptions(a,
d,"line",!0,"",[{data:c}])}function f(a,b,c,d){var f={textAlign:"center",paddingTop:"0px",paddingRight:"5px",paddingBottom:"0px",paddingLeft:"5px"},a=qv.util.dom.createTable(a,"",{}),l;l=qv.util.dom.createRow(a);l=qv.util.dom.createCell(l,1,"",f,"");qv.util.dom.createSpan(l,"","qv-card-max-and-min-value",c,{},null,b);l=qv.util.dom.createRow(a);l=qv.util.dom.createCell(l,1,"",f,"");qv.util.dom.createSpan(l,"","qv-card-max-and-min-title",c,{},null,d);return a}function q(a){var a=new gx.date.gxdate(a,
"Y4MD"),b=gx.date.now(),a=gx.date.secDiff(b,a);return gx.getMessage("GXPL_QViewerTimeAgo").replace("{0}",qv.util.seconsdToText(a))}function l(a,b,c,d){""!=b?(d=qv.util.formatNumber(parseFloat(b),d,c.Picture,!1),b=qv.util.formatNumber(parseFloat(100*b/c.TargetValue),2,"ZZZZZZZZZZZZZZ9.99",!1)+"%"):b=d="";switch(a.ShowDataAs){case QueryViewerShowDataAs.Values:return d;case QueryViewerShowDataAs.Percentages:return b;case QueryViewerShowDataAs.ValuesAndPercentages:return d+" ("+b+")";default:return d}}
function v(d){function r(a,b,e){var e=0<e.LinearRegression.Slope?"keyboard_arrow_up":0>e.LinearRegression.Slope?"keyboard_arrow_down":"drag_handle",c;c=""==b.TrendPeriod?gx.getMessage("GXPL_QViewerSinceTheBeginningTrend"):gx.getMessage("GXPL_QViewer"+b.TrendPeriod+"Trend");var g={width:"0px",marginLeft:"5px"};b.IncludeSparkline||(g.position="relative",g.top="2px");g.fontSize="36px";return e=qv.util.dom.createIcon(a,c,g,e)}for(var h=0<d.Data.Rows.length,u=!0,n="",v,e=0;e<d.Metadata.Axes.length;e++){var g=
d.Metadata.Axes[e];if(g.DataType==QueryViewerDataType.Date||g.DataType==QueryViewerDataType.DateTime){u=!1;n=g.DataField;v=g.DataType;break}}var C;h&&(C=u?qv.util.aggregateData(d.Metadata.Data,d.Data.Rows):d.Data.Rows[d.Data.Rows.length-1]);var E=qv.util.dom.getEmptyContainer(d);g=d.IsAutoResize()?e="":e="100%";var e=qv.util.dom.createTable(E,qv.util.GetContainerControlClasses(d),{width:e,height:g}),e=qv.util.dom.createRow(e),E=qv.util.dom.createCell(e,1,"center",{},""),e=d.Orientation==QueryViewerOrientation.Horizontal?
"100%":"",g=d.Orientation==QueryViewerOrientation.Vertical?"100%":"",E=qv.util.dom.createTable(E,"",{width:e,height:g,whiteSpace:"nowrap"}),o;d.Orientation==QueryViewerOrientation.Horizontal&&(o=qv.util.dom.createRow(E));g=[];for(e=0;e<d.Metadata.Data.length;e++){var k=d.Metadata.Data[e];if(k.Visible==QueryViewerVisible.Yes||k.Visible==QueryViewerVisible.Always){var F=qv.util.ParseNumericPicture(k.DataType,k.Picture).DecimalPrecision,M,p,B;h?(M=C[k.DataField],p=l(d,C[k.DataField],k,F),B=q(C[n])):
B=p=M="";if((gx.lang.gxBoolean(d.IncludeTrend)||gx.lang.gxBoolean(d.IncludeSparkline)||gx.lang.gxBoolean(d.IncludeMaxAndMin))&&h){var w=c(d,k,n,v);g.push(w)}var J=a(k,M);M={};var N="qv-card-element-value";qv.util.startsWith(J,"{")&&qv.util.endsWith(J,"}")?M=JSON.parse(J):N=J;J=null;d.ItemClick&&k.RaiseItemClick&&(N+=(""==N?"":" ")+"gx-qv-clickable-element",J=function(){qv.card.fireItemClickEvent(event,d,u)});d.Orientation==QueryViewerOrientation.Vertical&&(o=qv.util.dom.createRow(E));var H=d.Orientation==
QueryViewerOrientation.Horizontal?"10px":"",t=d.Orientation==QueryViewerOrientation.Vertical?"10px":"",H=qv.util.dom.createCell(o,1,"center",{paddingRight:H,paddingLeft:H,paddingBottom:t,paddingTop:t},""),H=qv.util.dom.createTable(H,"",{}),t=qv.util.dom.createRow(H),t=qv.util.dom.createCell(t,1,"center",{},""),t=qv.util.dom.createTable(t,"",{}),t=qv.util.dom.createRow(t),G=qv.util.dom.createCell(t,1,"center",{},"");qv.util.dom.createSpan(G,d.getContainerControl().id+"_"+k.Name,N,""!=n?B:"",M,J,p);
var G=qv.util.dom.createCell(t,1,"",{},"");h&&(d.IncludeTrend&&!d.IncludeSparkline&&w.LinearRegression.AnyTrend)&&r(G,d,w);t=qv.util.dom.createRow(H);t=qv.util.dom.createCell(t,1,"center",{},"");span1=qv.util.dom.createSpan(t,"","qv-card-element-title",""!=n?B:"",{},null,k.Title);d.IncludeSparkline&&(""!=n&&h)&&(t=qv.util.dom.createRow(H),t=qv.util.dom.createCell(t,1,"",{},""),t=qv.util.dom.createTable(t,"",{width:"100%"}),t=qv.util.dom.createRow(t),G=qv.util.dom.createCell(t,1,"",{width:"100%"},
""),qv.util.dom.createDiv(G,b(d.userControlId(),e),"","",{height:"50px",width:"100%",minWidth:"100px"},""),G=qv.util.dom.createCell(t,1,"",{width:"0%"},""),h&&(d.IncludeTrend&&w.LinearRegression.AnyTrend)&&r(G,d,w));d.IncludeMaxAndMin&&(""!=n&&h)&&(t=qv.util.dom.createRow(H),t=qv.util.dom.createCell(t,1,"center",{},""),t=qv.util.dom.createTable(t,"",{"margin-top":"10px"}),t=qv.util.dom.createRow(t),G=qv.util.dom.createCell(t,1,"",{},""),f(G,l(d,w.MinValue,k,F),q(w.MinWhen),gx.getMessage("GXPL_QViewerCardMinimum")),
G=qv.util.dom.createCell(t,1,"",{},""),f(G,l(d,w.MaxValue,k,F),q(w.MaxWhen),gx.getMessage("GXPL_QViewerCardMaximum")))}}if(d.IncludeSparkline&&""!=n&&h)for(e=0;e<d.Metadata.Data.length;e++)h=m(d,g[e].ChartSeriesData,e),new Highcharts.Chart(h);d._ControlRenderedTo=d.RealType;qv.util.hideActivityIndicator(d)}return{tryToRenderCard:function(a){var b="";(new Date).getTime();a.xml=a.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(a,function(a,c){var d=!1;a!=c.xml.recordsetCacheKey&&(c.xml.recordsetCacheKey=
a,d=!0);qv.util.anyError(a)?(b=qv.util.getErrorFromText(a),qv.util.renderError(c,b)):(d&&qv.services.parseRecordsetCacheKeyXML(c),qv.services.GetMetadataIfNeeded(c,function(a,e){var c=false;if(a!=e.xml.metadata){e.xml.metadata=a;c=true}(new Date).getTime();if(qv.util.anyError(a)){b=qv.util.getErrorFromText(a);qv.util.renderError(e,b)}else{c&&qv.services.parseMetadataXML(e);e.Metadata.ParserResult.Success?qv.services.GetDataIfNeeded(e,function(a,e){var c=false;if(a!=e.xml.data){e.xml.data=a;c=true}(new Date).getTime();
if(qv.util.anyError(a)){b=qv.util.getErrorFromText(a);qv.util.renderError(e,b)}else{c&&qv.services.parseDataXML(e);v(e)}}):qv.util.renderError(e,e.Metadata.ParserResult.Message)}}))})},GetMetadataCard:function(a){return qv.util.GetDesigntimeMetadata(a)},GetDataCard:function(a){return a.xml.data},fireItemClickEvent:function(a,b,c){a=a.target.id;a=a.substr(a.lastIndexOf("_")+1);d(b.ItemClickData,b,a,c);b.ItemClick()}}}();
qv.map=function(){function a(a){if(a.MapType==QueryViewerMapType.Choropleth||a.MapType==QueryViewerMapType.Bubble&&a.Metadata.Axes[0].DataType==QueryViewerDataType.Character||a.MapType==QueryViewerMapType.Bubble&&a.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&"F0"!=a.Chart.Series.DataFields[0])return a.Chart.Series.ByIndex[0].Color.Color?"#"+a.Chart.Series.ByIndex[0].Color.Color:"#0F5B78";if(a.MapType==QueryViewerMapType.Bubble&&a.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&
"F0"==a.Chart.Series.DataFields[0])return a.Metadata.Axes[0].Style?a.Metadata.Axes[0].Style.substring(6,a.Metadata.Axes[0].Style.length):"#0F5B78"}function c(b){var c=[];if(b.Metadata.Axes[0].DataType==QueryViewerDataType.Character){if(0<b.Chart.Categories.DataFields.length&&0<b.Chart.Series.DataFields.length)for(var d=0;d<b.Chart.Categories.Values.length;d++){var f=b.Chart.Categories.Values[d].Value,h=parseFloat(b.Chart.Series.ByIndex[0].Points[d].Value);b.MapLibrary===QueryViewerMapLibrary.ECharts?
c.push({name:f,value:h}):c.push([axisvalue,h])}}else if(b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint)for(var c=[],k,l=b.Metadata.Axes[0],d=0;d<b.Data.Rows.length;d++){f=b.Data.Rows[d][l.DataField];f=f.substring(7,f.length-1);for(h=0;h<f.length;h++)if(" "==f[h])var m=parseFloat(f.substring(0,h)),n=parseFloat(f.substring(h+1,f.length));f=[m,n];h=parseFloat(b.Chart.Series.ByIndex[0].Points[d].Value);"F0"==b.Chart.Series.DataFields[0]?c.push({coord:[f[0],f[1]],additionalData:b.Data.Rows[d]}):
0==b.Chart.colorAxis.dataClasses.length?c.push({coord:[f[0],f[1]],value:h,itemStyle:{color:a(b)},additionalData:b.Data.Rows[d]}):(k=b.Chart.Series.ByIndex[0].Points[d].Color.Color,u(k)&&(k="#"+k),c.push({coord:[f[0],f[1]],value:h,itemStyle:{color:k},additionalData:b.Data.Rows[d]}))}return c}function d(a,b,c,d,f,h,l,m,n){function B(a,c){var e={};e.Name=a.Name;var d=qv.util.GetPictureProperties(a.DataType,a.Picture);a.DataType!=QueryViewerDataType.GeoPoint?(d=qv.util.ApplyPicture(c,a.Picture,a.DataType,
d),e.Values=[d]):e.Values=b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&b.MapType==QueryViewerMapType.Bubble?c[w.DataField]:[c];return e}var w=b.Metadata.Axes[0];a.Name=c;a.Type=d;a.Axis="";a.Value=f;a.Selected=h;a.Context=[];w.IsComponent||(d=b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&b.MapType==QueryViewerMapType.Bubble?B(w,b.Data.Rows[n]):b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&b.MapType==QueryViewerMapType.Choropleth?B(w,m[n].name):B(w,m[n].Value),
a.Context.push(d));for(c=0;c<b.Metadata.Data.length;c++)d=b.Metadata.Data[c],d.IsComponent||(d=b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&b.MapType==QueryViewerMapType.Choropleth?B(d,l[n].value):B(d,l[n].Value),a.Context.push(d));a.Filters=[]}function b(a){a.on("mousedown",function(){a.getZr().setCursorStyle("auto")});a.on("mousemove",function(){a.getZr().setCursorStyle("auto")});a.on("mouseup",function(){a.getZr().setCursorStyle("auto")});a.on("mouseover",function(){a.getZr().setCursorStyle("auto")});
a.on("mouseout",function(){a.getZr().setCursorStyle("auto")})}function m(a,b){a.on("mousedown",function(c){b.MapType==QueryViewerMapType.Choropleth?a.getZr().setCursorStyle("pointer"):"markPoint"===c.componentType?a.getZr().setCursorStyle("pointer"):a.getZr().setCursorStyle("auto")});a.on("mousemove",function(c){b.MapType==QueryViewerMapType.Choropleth?a.getZr().setCursorStyle("pointer"):"markPoint"===c.componentType?a.getZr().setCursorStyle("pointer"):a.getZr().setCursorStyle("auto")});a.on("mouseup",
function(c){b.MapType==QueryViewerMapType.Choropleth?a.getZr().setCursorStyle("pointer"):"markPoint"===c.componentType?a.getZr().setCursorStyle("pointer"):a.getZr().setCursorStyle("auto")});a.on("mouseover",function(c){b.MapType==QueryViewerMapType.Choropleth?a.getZr().setCursorStyle("pointer"):"markPoint"===c.componentType?a.getZr().setCursorStyle("pointer"):a.getZr().setCursorStyle("auto")});a.on("mouseout",function(c){b.MapType==QueryViewerMapType.Choropleth?a.getZr().setCursorStyle("pointer"):
"markPoint"===c.componentType?a.getZr().setCursorStyle("pointer"):a.getZr().setCursorStyle("auto")})}function f(a,b){a.on("click",function(f){if(b.MapType==QueryViewerMapType.Choropleth||b.MapType==QueryViewerMapType.Bubble&&"markPoint"===f.componentType){var h=b.Chart.Series.ByIndex[0],m=qv.util.formatNumber(f.value,h.NumberFormat.DecimalPrecision,h.Picture,!1),k=b.Chart.Series.ByIndex[0].Points,n;b.MapType==QueryViewerMapType.Bubble&&b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint?n=b.Data.Rows:
b.MapType==QueryViewerMapType.Choropleth&&b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint?k=n=l(c(b),a,b):n=b.Chart.Categories.Values;var q;q=a.getOption();if(b.SelectionAllowed())if(b.MapType==QueryViewerMapType.Choropleth)q=q.series[0].selectedMap,q=!0==q[Object.keys(q)[0]]?!0:!1;else{var p;0==b.Chart.colorAxis.dataClasses.length?p=q.series[0].color:(p=b.Chart.Series.ByIndex[0].Points[f.dataIndex].Color.Color,u(p)&&(p="#"+p));q=a.BubbleSelect==f.dataIndex&&q.series[0].markPoint.data[f.dataIndex].itemStyle.color==
p?!0:a.BubbleSelect==f.dataIndex&&q.series[0].markPoint.data[f.dataIndex].itemStyle.color!=p?!1:a.BubbleSelect!=f.dataIndex&&q.series[0].markPoint.data[f.dataIndex].itemStyle.color==p?!0:!1}else q=!1;f.dataIndex>n.length-1&&Number.isNaN(f.value)||(d(b.ItemClickData,b,h.FieldName,QueryViewerElementType.Datum,m,q,k,n,f.dataIndex),b.ItemClick())}})}function q(a,b,c){function d(a,b){for(var c=a[0],e=a[1],g=!1,f=0,h=b.length-1;f<b.length;h=f++){var l=b[f][0],m=b[f][1],n=b[h][0],h=b[h][1];m>e!=h>e&&c<(n-
l)*(e-m)/(h-m)+l&&(g=!1==g?!0:!1)}return g}return function(a,b,c){var e=[];if(b.Region==QueryViewerRegion.Country&&(b.Country==QueryViewerCountry.US||b.Country==QueryViewerCountry.ES||b.Country==QueryViewerCountry.PT||b.Country==QueryViewerCountry.FR||b.Country==QueryViewerCountry.GQ||b.Country==QueryViewerCountry.MU)){for(var g=[[QueryViewerCountry.US,["US-AK","US-HI","US-PR"]],[QueryViewerCountry.ES,["ES-CN","ES-IB"]],[QueryViewerCountry.PT,["PT-20","PT-30"]],[QueryViewerCountry.FR,["FR-GF","FR-RE",
"FR-GP","FR-MQ","FR-YT"]],[QueryViewerCountry.GQ,["GQ-AN","GQ-BS","GQ-BN"]],[QueryViewerCountry.MU,["MU-RO","MU-CC","MU-AG"]]],f,h,l,m,n,t,q,y=0;y<g.length;y++)if(g[y][0]==b.Country){m=g[y];break}for(b=0;b<c._coordSysMgr._coordinateSystems[0].regions.length;b++)for(g=0;g<m[1].length;g++)for(y=0;y<a.length;y++)if(c._coordSysMgr._coordinateSystems[0].regions[b].name==m[1][g]){if(f=d(a[y].coord,c._coordSysMgr._coordinateSystems[0].regions[b].properties.specialArea),!0==f){height=c._coordSysMgr._coordinateSystems[0].regions[b].properties.specialAreaHeight;
h=c._coordSysMgr._coordinateSystems[0].regions[b]._rect.x;f=c._coordSysMgr._coordinateSystems[0].regions[b]._rect.y;l=c._coordSysMgr._coordinateSystems[0].regions[b]._rect.width;void 0!=c._coordSysMgr._coordinateSystems[0].regions[b].properties.AreaWidth&&c._coordSysMgr._coordinateSystems[0].regions[b].properties.coordlimit?(n=c._coordSysMgr._coordinateSystems[0].regions[b].properties.coordlimit[0],t=c._coordSysMgr._coordinateSystems[0].regions[b].properties.coordlimit[1],q=c._coordSysMgr._coordinateSystems[0].regions[b].properties.AreaWidth,
areaHeight=c._coordSysMgr._coordinateSystems[0].regions[b].properties.AreaHeight,h-=[(n-a[y].coord[0])/q*l],f=f+height-Math.abs((t-a[y].coord[1])/areaHeight*height)):(h=a[y].coord[0]+(h-a[y].coord[0])+l,f=a[y].coord[1]*height/90+f);a[y].coord=[h,f];t=a[y];t.name=null;t.name=c._coordSysMgr._coordinateSystems[0].regions[b].name;e.push(t);break}}else for(f=0;f<c._coordSysMgr._coordinateSystems[0].regions[b].geometries.length;f++)if(d(a[y].coord,c._coordSysMgr._coordinateSystems[0].regions[b].geometries[f].exterior)){t=
a[y];h=!1;for(l=0;l<e.length;l++)e[l].coord===t.coord&&e[l].value===t.value&&(h=!0);h||(t=a[y],t.name=null,t.name=c._coordSysMgr._coordinateSystems[0].regions[b].name,e.push(t))}return e}if(b.Region==QueryViewerRegion.World&&b.MapType!=QueryViewerMapType.Choropleth)return a;for(m=0;m<a.length;m++){g=!1;for(b=0;b<c._coordSysMgr._coordinateSystems[0].regions.length&&!1==g;b++)for(f=0;f<c._coordSysMgr._coordinateSystems[0].regions[b].geometries.length&&!1==g;f++)if(d(a[m].coord,c._coordSysMgr._coordinateSystems[0].regions[b].geometries[f].exterior)){t=
a[m];t.name=null;t.name=c._coordSysMgr._coordinateSystems[0].regions[b].name;e.push(t);g=!0;break}}return e}(a,b,c)}function l(a,b,c){for(var d=[],b=q(a,c,b),a=[],f=0;f<b.length;f++)d.push({name:b[f].name,value:0,additionalData:[b[f].additionalData]});for(b=0;b<d.length;b++){for(var f=d[b],h=!1,l=[],m=0;m<a.length;m++)a[m].name===f.name&&(l=a[m].additionalData,l.push(f.additionalData[0]),a[m].additionalData=l,h=!0);!1==h&&a.push(f)}for(b=0;b<a.length;b++)d=qv.util.aggregateData(c.Metadata.Data,a[b].additionalData,
c),a[b].value=d[c.Metadata.Data[0].DataField];return a}function v(b){var c;if(b.MapType==QueryViewerMapType.Choropleth&&0==b.Chart.colorAxis.dataClasses.length)return c={min:0,maxColor:a(b)};if(b.MapType==QueryViewerMapType.Choropleth&&0!=b.Chart.colorAxis.dataClasses.length||b.MapType==QueryViewerMapType.Bubble&&0!=b.Chart.colorAxis.dataClasses.length)return c=b.Chart.colorAxis;b.MapType==QueryViewerMapType.Bubble&&0==b.Chart.colorAxis.dataClasses.length&&(c=[]);return c}function s(a){var b;if(a.MapType==
QueryViewerMapType.Choropleth)return b={enabled:!0};a.MapType==QueryViewerMapType.Bubble&&(b=0!=a.Chart.colorAxis.dataClasses.length?{enabled:!0}:{enabled:!1});return b}function r(b){var d;if(b.MapType==QueryViewerMapType.Choropleth)return d=[{name:qv.util.getTranslation(b.Title),type:"map",borderColor:"gray",colorByPoint:!1,data:c(b),joinBy:["name","hc-key"],dataLabels:{enabled:!0,format:"{point.name}"}}];b.MapType==QueryViewerMapType.Bubble&&(d=0==b.Chart.colorAxis.dataClasses.length?b.Chart.Series.ByIndex[0].Color.Color?
[{color:"#E0E0E0",enableMouseTracking:!1},{name:qv.util.getTranslation(b.Title),type:"mapbubble",joinBy:["name","hc-key"],data:c(b),styledMode:!1,color:a(b),showInLegend:!0,minSize:4,maxSize:"12%"}]:[{enableMouseTracking:!1},{name:qv.util.getTranslation(b.Title),type:"mapbubble",joinBy:["name","hc-key"],data:c(b),colorIndex:b.Metadata.Data[0].colorIndex,opacity:0.5,showInLegend:!0,minSize:4,maxSize:"12%"}]:[{color:"#E0E0E0",enableMouseTracking:!1},{name:qv.util.getTranslation(b.Title),type:"mapbubble",
joinBy:["name","hc-key"],data:c(b),styledMode:!1,showInLegend:!0,minSize:4,maxSize:"12%"}]);return d}function h(a){var b;if(a.MapType==QueryViewerMapType.Choropleth)return b={};a.MapType==QueryViewerMapType.Bubble&&(b={});return b}function u(a){var b=/[0-9A-Fa-f]{6}/g,a=b.test(a)?!0:!1;b.lastIndex=0;return a}function n(b,c,d){var f=[],h;if(d.MapType==QueryViewerMapType.Choropleth&&d.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint)for(var k=0;k<b.length;k++)for(var l=0;l<c._coordSysMgr._coordinateSystems[0].regions.length;l++){if(c._coordSysMgr._coordinateSystems[0].regions[l].name==
b[k].name){0!=d.Chart.colorAxis.dataClasses.length?void 0!=c._coordSysMgr._coordinateSystems[0].regions[l].properties.center?(h=d.Chart.Series.ByIndex[0].Points[k].Color.Color,u(h)&&(h="#"+h),f.push({name:b[k].name,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[0],c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[1]],value:b[k].value,itemStyle:{color:h}})):f.push({name:b[k].name,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].center[0],c._coordSysMgr._coordinateSystems[0].regions[l].center[1]],
value:b[k].value,itemStyle:{color:h}}):void 0!=c._coordSysMgr._coordinateSystems[0].regions[l].properties.center?f.push({name:b[k].name,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[0],c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[1]],value:b[k].value,itemStyle:{color:a(d)}}):f.push({name:b[k].name,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].center[0],c._coordSysMgr._coordinateSystems[0].regions[l].center[1]],value:b[k].value,itemStyle:{color:a(d)}});
break}}else for(k=0;k<d.Chart.Categories.Values.length;k++)for(l=0;l<c._coordSysMgr._coordinateSystems[0].regions.length;l++)if(c._coordSysMgr._coordinateSystems[0].regions[l].name==d.Chart.Categories.Values[k].Value){0!=d.Chart.colorAxis.dataClasses.length?void 0!=c._coordSysMgr._coordinateSystems[0].regions[l].properties.center?(h=d.Chart.Series.ByIndex[0].Points[k].Color.Color,u(h)&&(h="#"+h),f.push({name:d.Chart.Categories.Values[k].Value,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[0],
c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[1]],value:b[k].value,itemStyle:{color:h}})):f.push({name:d.Chart.Categories.Values[k].Value,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].center[0],c._coordSysMgr._coordinateSystems[0].regions[l].center[1]],value:b[k].value,itemStyle:{color:h}}):void 0!=c._coordSysMgr._coordinateSystems[0].regions[l].properties.center?f.push({name:d.Chart.Categories.Values[k].Value,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[0],
c._coordSysMgr._coordinateSystems[0].regions[l].properties.center[1]],value:b[k].value,itemStyle:{color:a(d)}}):f.push({name:d.Chart.Categories.Values[k].Value,coord:[c._coordSysMgr._coordinateSystems[0].regions[l].center[0],c._coordSysMgr._coordinateSystems[0].regions[l].center[1]],value:b[k].value,itemStyle:{color:a(d)}});break}return f}function z(e,d){function h(a,b,c){var e=[],d=function(a){for(var b=qv.util.GetPictureProperties(a.Chart.Series.ByIndex[0].DataType,a.Chart.Series.ByIndex[0].Picture),
c=[],e,d=0;d<a.Chart.colorAxis.dataClasses.length;d++)e=a.Chart.colorAxis.dataClasses[d].Operator,e=e==QueryViewerConditionOperatorSymbol.Interval?qv.util.ApplyPicture(a.Chart.colorAxis.dataClasses[d].from,a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,b)+e+qv.util.ApplyPicture(a.Chart.colorAxis.dataClasses[d].to,a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,b):e==QueryViewerConditionOperatorSymbol.Equal?""+qv.util.ApplyPicture(a.Chart.colorAxis.dataClasses[d].from,
a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,b):e==QueryViewerConditionOperatorSymbol.LessThan||e==QueryViewerConditionOperatorSymbol.LessOrEqual?e+" "+qv.util.ApplyPicture(a.Chart.colorAxis.dataClasses[d].to,a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,b):e+" "+qv.util.ApplyPicture(a.Chart.colorAxis.dataClasses[d].from,a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,b),c.push(e);return c}(a),f=function(a){for(var b=a.MapType==QueryViewerMapType.Bubble&&
a.Metadata.Axes[0].DataType==QueryViewerDataType.Character?[""]:[],c,e=0;e<a.Chart.colorAxis.dataClasses.length;e++)c=a.Chart.colorAxis.dataClasses[e].color,b.push(c);return b}(a),a=function(a,b,c,e){var d=[];if(a.Metadata.Axes[0].DataType==QueryViewerDataType.Character)b={name:"serie",type:"map",markPoint:{nameProperty:"iso-code",data:b}};else var b=q(b,a,e),f=Math.max.apply(Math,b.map(function(a){return a.value})),e=a.getContainerControl(),g=Math.min(e.offsetWidth,e.offsetHeight),b={name:"serie",
type:"map",markPoint:{data:b,symbolSize:function(a){return void 0==a?8:Math.sqrt(a/f)*g/10}}};d.push(b);for(b=0;b<a.Chart.colorAxis.dataClasses.length;b++)d.push({name:c[b],type:"map",data:[]});return d}(a,b,d,c);e.push(d,f,a);return e}function s(a,b){b.TextStyle.fontFamily&&(a.fontFamily=b.TextStyle.fontFamily);b.TextStyle.fontSize&&(a.fontSize=b.TextStyle.fontSize);b.TextStyle.fontStyle&&(a.fontStyle=b.TextStyle.fontStyle);b.TextStyle.fontWeight&&(a.fontWeight=b.TextStyle.fontWeight);b.TextStyle.color&&
(a.color=b.TextStyle.color);b.BoxStyle.backgroundColor&&(a.backgroundColor=qv.util.color.resolveColor(b.BoxStyle.backgroundColor,b.BoxStyle.opacity));b.BoxStyle.borderColor&&(a.borderColor=b.BoxStyle.borderColor);b.BoxStyle.borderWidth&&(a.padding=3,a.borderWidth=b.BoxStyle.borderWidth)}0==e.offsetHeight&&(e.style.height="400px",e.style.overflow="hidden");var o=echarts.init(e),k=function(a){function b(a,c){if(a.fontFamily&&!c.fontFamily)c.fontFamily=a.fontFamily;if(a.fontSize&&!c.fontSize)c.fontSize=
a.fontSize;if(a.fontStyle&&!c.fontStyle)c.fontStyle=a.fontStyle;if(a.fontWeight&&!c.fontWeight)c.fontWeight=a.fontWeight;if(a.color&&!c.color)c.color=a.color}function c(a,b){if(a.fontFamily)b.fontFamily=qv.util.css.resolveVariable(a.fontFamily);if(a.fontSize)b.fontSize=parseFloat(qv.util.css.resolveVariable(a.fontSize));if(a.fontStyle)b.fontStyle=qv.util.css.resolveVariable(a.fontStyle);if(a.fontWeight)b.fontWeight=qv.util.css.resolveVariable(a.fontWeight);if(a.color)b.color=qv.util.css.resolveVariable(a.color)}
function e(a,b){if(a.backgroundColor)b.backgroundColor=qv.util.css.resolveVariable(a.backgroundColor);if(a.opacity)b.opacity=qv.util.css.resolveVariable(a.opacity);if(a.borderWidth)b.borderWidth=parseFloat(qv.util.css.resolveVariable(a.borderWidth));if(a.borderColor)b.borderColor=qv.util.css.resolveVariable(a.borderColor)}function d(a,b,f){f.BackgroundColor=f.BackgroundColor||"white";f.SelectionColor=f.SelectionColor||"lightcoral";f.Opacity=f.Opacity||"1";f.TextStyle=f.TextStyle||{fontFamily:"Source Sans Pro"};
f.Title=f.Title||{TextStyle:{}};f.SeriesLabels=f.SeriesLabels||{TextStyle:{},BoxStyle:{}};f.Legend=f.Legend||{TextStyle:{},BoxStyle:{}};f.Tooltip=f.Tooltip||{TextStyle:{},BoxStyle:{}};for(var g=0;g<a.length;g++){var h=a[g];if(h instanceof CSSStyleRule){var k=h.style;if(h.selectorText==="."+b)c(k,f.TextStyle);else if(h.selectorText==="."+b+" .gx-qv-selected-element")f.SelectionColor=qv.util.css.resolveVariable(k.backgroundColor);else if(h.selectorText==="."+b+".qv-map"){f.BackgroundColor=qv.util.css.resolveVariable(k.backgroundColor);
f.Opacity=qv.util.css.resolveVariable(k.opacity)}else h.selectorText==="."+b+" .gx-qv-title"?c(k,f.Title.TextStyle):h.selectorText==="."+b+" .gx-qv-legend-box"?e(k,f.Legend.BoxStyle):h.selectorText==="."+b+" .gx-qv-legend-text"?c(k,f.Legend.TextStyle):h.selectorText==="."+b+" .gx-qv-series-labels-box"?e(k,f.SeriesLabels.BoxStyle):h.selectorText==="."+b+" .gx-qv-series-labels-text"?c(k,f.SeriesLabels.TextStyle):h.selectorText==="."+b+" .gx-qv-tooltip-box"?e(k,f.Tooltip.BoxStyle):h.selectorText==="."+
b+" .gx-qv-tooltip-text"&&c(k,f.Tooltip.TextStyle)}else h instanceof CSSImportRule?d(h.styleSheet.rules||h.styleSheet.cssRules,b,f):h instanceof CSSLayerBlockRule&&d(h.cssRules,b,f)}}var f=qv.util.GetThemeStyleSheet(a),f=f.rules||f.cssRules,a=qv.util.GetContainerControlClass(a),g={};d(f,a,g);b(g.TextStyle,g.Title.TextStyle);b(g.TextStyle,g.Legend.TextStyle);b(g.TextStyle,g.SeriesLabels.TextStyle);b(g.TextStyle,g.Tooltip.TextStyle);return g}(d);o.clear();var r={backgroundColor:qv.util.color.resolveColor(k.BackgroundColor,
k.Opacity),series:function(b,e){var d=a(b),f=gx.lang.gxBoolean(b.ShowValues)&&b.MapType===QueryViewerMapType.Bubble,g=b.getContainerControl(),h=Math.min(g.offsetWidth,g.offsetHeight),k=qv.util.GetPictureProperties(b.Chart.Series.ByIndex[0].DataType,b.Chart.Series.ByIndex[0].Picture),g={type:"map",map:qv.map.getMapDirectory(b).mapKey,roam:true,scaleLimit:{min:1},selectedMode:b.SelectionAllowed()?"single":false,label:{show:false,formatter:"{c}"},emphasis:{label:{show:false},itemStyle:{borderWidth:0.5}},
select:{label:{show:false},itemStyle:{borderWidth:0.5}}};if(b.MapType===QueryViewerMapType.Choropleth){g.nameProperty="iso-code";if(b.Metadata.Axes[0].DataType==QueryViewerDataType.Character)g.data=c(b);s(g.label,e.SeriesLabels);g.select.itemStyle.areaColor=e.SelectionColor;g.emphasis.itemStyle.borderWidth=1;g.emphasis.itemStyle.areaColor=null;g.emphasis.itemStyle.borderColor=qv.util.color.lightenDarkenColor(d,50)}else if(b.MapType==QueryViewerMapType.Bubble&&b.Metadata.Axes[0].DataType==QueryViewerDataType.Character){var l=
b.Chart.Series.ByIndex[0].MaxValue;if(b.Chart.colorAxis.dataClasses.length===0)g.color=d;g.nameProperty="iso-code";g.emphasis.itemStyle.areaColor="#eeeeee";g.select.itemStyle.areaColor="#eeeeee";g.data=c(b);g.showLegendSymbol=false;g.markPoint={symbol:"circle",symbolSize:function(a){return Math.sqrt(a/l)*h/10},label:{show:f,formatter:function(a){return qv.util.ApplyPicture(a.value,b.Chart.Series.ByIndex[0].Picture,b.Chart.Series.ByIndex[0].DataType,k)}},itemStyle:{opacity:0.6,borderColor:qv.util.color.lightenDarkenColor(d,
50),borderWidth:1},emphasis:{label:{show:f},itemStyle:{opacity:0.7,borderColor:qv.util.color.lightenDarkenColor(d,100),borderWidth:2}}};s(g.markPoint.label,e.SeriesLabels)}else if(b.MapType==QueryViewerMapType.Bubble&&b.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint){g.color=d;g.nameProperty="iso-code";g.emphasis.itemStyle.areaColor="#eeeeee";g.select.itemStyle.areaColor="#eeeeee";g.data=[];g.markPoint={symbol:"circle",label:{show:f,formatter:function(a){return qv.util.ApplyPicture(a.value,
b.Chart.Series.ByIndex[0].Picture,b.Chart.Series.ByIndex[0].DataType,k)}},itemStyle:{opacity:0.6,borderColor:qv.util.color.lightenDarkenColor(d,50),borderWidth:1},emphasis:{label:{show:f},itemStyle:{opacity:0.7,borderColor:qv.util.color.lightenDarkenColor(d,100),borderWidth:2}}};s(g.markPoint.label,e.SeriesLabels)}return g}(d,k),title:{text:qv.util.getTranslation(d.Title),left:"center",textStyle:k.Title.TextStyle},dataRange:function(b,c){function e(c){return c!=null?c:a(b)}var d,f=qv.util.GetPictureProperties(b.Chart.Series.ByIndex[0].DataType,
b.Chart.Series.ByIndex[0].Picture);if(b.MapType==QueryViewerMapType.Choropleth&&b.Chart.colorAxis.dataClasses.length!=0){d=[];for(var g=0;g<b.Chart.colorAxis.dataClasses.length;g++){var k={},l=h(b,"",null)[0];b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.Interval?k={start:b.Chart.colorAxis.dataClasses[g].from,end:b.Chart.colorAxis.dataClasses[g].to,color:e(b.Chart.colorAxis.dataClasses[g].color),label:l[g]}:b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.Equal||
b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.NotEqual?k={value:b.Chart.colorAxis.dataClasses[g].from,color:e(b.Chart.colorAxis.dataClasses[g].color),label:l[g]}:b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.GreaterThan?k={start:b.Chart.colorAxis.dataClasses[g].from,color:e(b.Chart.colorAxis.dataClasses[g].color),label:l[g]}:b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.GreaterOrEqual?k={start:b.Chart.colorAxis.dataClasses[g].from-
1,color:e(b.Chart.colorAxis.dataClasses[g].color),label:l[g]}:b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.LessThan?k={end:b.Chart.colorAxis.dataClasses[g].to,color:e(b.Chart.colorAxis.dataClasses[g].color),label:l[g]}:b.Chart.colorAxis.dataClasses[g].Operator==QueryViewerConditionOperatorSymbol.LessOrEqual&&(k={end:b.Chart.colorAxis.dataClasses[g].to+1,color:e(b.Chart.colorAxis.dataClasses[g].color),label:l[g]});d.push(k)}d={left:"left",orient:"vertical",splitList:d,
textStyle:c.TextStyle}}else if(b.MapType==QueryViewerMapType.Choropleth&&b.Chart.colorAxis.dataClasses.length==0){d={min:0,calculable:true,orient:"horizontal",left:"center",color:[a(b),"white"],textStyle:c.TextStyle,formatter:function(a){return qv.util.ApplyPicture(a,b.Chart.Series.ByIndex[0].Picture,b.Chart.Series.ByIndex[0].DataType,f)}};if(b.Metadata.Axes[0].DataType==QueryViewerDataType.Character){g=b.Chart.Series.ByIndex[0].MaxValue;d.max=g}}if(b.MapType==QueryViewerMapType.Choropleth){if(c.BoxStyle.backgroundColor)d.backgroundColor=
qv.util.color.resolveColor(c.BoxStyle.backgroundColor,c.BoxStyle.opacity);if(c.BoxStyle.borderColor)d.borderColor=c.BoxStyle.borderColor;if(c.BoxStyle.borderWidth)d.borderWidth=c.BoxStyle.borderWidth}return d}(d,k.Legend),tooltip:function(a,b){var e=qv.util.GetPictureProperties(a.Chart.Series.ByIndex[0].DataType,a.Chart.Series.ByIndex[0].Picture),d;if(a.MapType==QueryViewerMapType.Bubble&&a.Metadata.Axes[0].DataType==QueryViewerDataType.Character||a.MapType==QueryViewerMapType.Choropleth)d={trigger:"item",
textStyle:b.TextStyle,formatter:function(b){for(var c=0;c<o._coordSysMgr._coordinateSystems[0].regions.length;c++)if(o._coordSysMgr._coordinateSystems[0].regions[c].name==b.name)return Number.isNaN(b.value)?o._coordSysMgr._coordinateSystems[0].regions[c].properties.name+" : 0":o._coordSysMgr._coordinateSystems[0].regions[c].properties.name+" : "+qv.util.ApplyPicture(b.value,a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,e)}};else if(a.MapType==QueryViewerMapType.Bubble&&a.Metadata.Axes[0].DataType==
QueryViewerDataType.GeoPoint){coordData=c(a);d={trigger:"item",textStyle:b.TextStyle,formatter:function(b){var c=a.Chart.Series.ByIndex[0].Name;if(Number.isNaN(b.value))for(c=0;c<o._coordSysMgr._coordinateSystems[0].regions.length;c++){if(o._coordSysMgr._coordinateSystems[0].regions[c].name==b.name)return o._coordSysMgr._coordinateSystems[0].regions[c].properties.name}else return b.value!=void 0?gx.getMessage("GXPL_QViewerMapLatitude")+" "+b.data.coord[0]+"<br />"+gx.getMessage("GXPL_QViewerMapLongitude")+
" "+b.data.coord[1]+"<br />"+c+": "+qv.util.ApplyPicture(b.value,a.Chart.Series.ByIndex[0].Picture,a.Chart.Series.ByIndex[0].DataType,e):gx.getMessage("GXPL_QViewerMapLatitude")+" "+b.data.coord[0]+"<br />"+gx.getMessage("GXPL_QViewerMapLongitude")+" "+b.data.coord[1]}}}if(b.BoxStyle.backgroundColor)d.backgroundColor=qv.util.color.resolveColor(b.BoxStyle.backgroundColor,b.BoxStyle.opacity);if(b.BoxStyle.borderColor)d.borderColor=b.BoxStyle.borderColor;if(b.BoxStyle.borderWidth)d.borderWidth=b.BoxStyle.borderWidth;
return d}(d,k.Tooltip)};b(o);o.setOption(r);var v=qv.util.GetPictureProperties(d.Chart.Series.ByIndex[0].DataType,d.Chart.Series.ByIndex[0].Picture);o.lastSelected=null;o.BubbleSelect=null;d.SelectionAllowed()&&m(o,d);d.ItemClick&&d.Metadata.Data[0].RaiseItemClick&&f(o,d);if(d.MapType==QueryViewerMapType.Bubble){var p=n(c(d),o,d),p=d.Metadata.Axes[0].DataType==QueryViewerDataType.Character?n(c(d),o,d):c(d),r=h(d,p,o),r={color:r[1],series:r[2],legend:{orient:"vertical",x:"left",y:"bottom",selectedMode:!1,
data:r[0],textStyle:k.Legend.TextStyle,formatter:function(a){return a}}};if(d.SelectionAllowed())o.on("click",function(a){if(a.componentType==="markPoint"){var b=o.getOption(),c;if(d.Chart.colorAxis.dataClasses.length==0)c=b.series[0].color;else{c=d.Chart.Series.ByIndex[0].Points[a.dataIndex].Color.Color;u(c)&&(c="#"+c)}if(o.lastSelected!=a.dataIndex){if(o.lastSelected!=null)if(d.Chart.colorAxis.dataClasses.length==0)b.series[0].markPoint.data[o.lastSelected].itemStyle={color:b.series[0].color};else{colorLastBubble=
d.Chart.Series.ByIndex[0].Points[o.lastSelected].Color.Color;u(colorLastBubble)&&(colorLastBubble="#"+colorLastBubble);b.series[0].markPoint.data[o.lastSelected].itemStyle={color:colorLastBubble}}b.series[0].markPoint.data[a.dataIndex].itemStyle={color:k.SelectionColor};o.lastSelected=a.dataIndex}else{b.series[0].markPoint.data[a.dataIndex].itemStyle={color:c};o.lastSelected=null}o.BubbleSelect=a.dataIndex;o.setOption(b)}});if(0!=d.Chart.colorAxis.dataClasses.length&&(k.Legend.BoxStyle.backgroundColor&&
(r.legend.backgroundColor=qv.util.color.resolveColor(k.Legend.BoxStyle.backgroundColor,k.Legend.BoxStyle.opacity)),k.Legend.BoxStyle.borderColor&&(r.legend.borderColor=k.Legend.BoxStyle.borderColor),k.Legend.BoxStyle.borderWidth))r.legend.borderWidth=k.Legend.BoxStyle.borderWidth;o.setOption(r)}else d.MapType==QueryViewerMapType.Choropleth&&(d.Metadata.Axes[0].DataType==QueryViewerDataType.GeoPoint&&(p=l(c(d),o,d),maxValue=Math.max.apply(Math,p.map(function(a){return a.value})),r={series:{data:p},
dataRange:{max:maxValue}}),o.setOption(r),gx.lang.gxBoolean(d.ShowValues)&&(dataValues=d.Metadata.Axes[0].DataType==QueryViewerDataType.Character?n(c(d),o,d):n(p,o,d),r={series:{markPoint:{symbol:"circle",symbolSize:function(){return 0},label:{show:!0,color:"black",formatter:function(a){return qv.util.ApplyPicture(a.value,d.Chart.Series.ByIndex[0].Picture,d.Chart.Series.ByIndex[0].DataType,v)}},data:dataValues}}},s(r.series.markPoint.label,k.SeriesLabels)),o.setOption(r));d.Charts=[o];(function(a){var b=
"try { qv.map.CheckMapSize("+a.me()+") } catch (e) {}";a.IntervalCheckChartSize=setInterval(b,500)})(d);d._ControlRenderedTo=d.RealType}return{tryToRenderMap:function(a){var b="";(new Date).getTime();a.xml=a.xml||{};qv.services.GetRecordsetCacheKeyIfNeeded(a,function(c,d){var f=!1;c!=d.xml.recordsetCacheKey&&(d.xml.recordsetCacheKey=c,f=!0);qv.util.anyError(c)?(b=qv.util.getErrorFromText(c),qv.util.renderError(d,b)):(f&&qv.services.parseRecordsetCacheKeyXML(d),qv.services.GetMetadataIfNeeded(d,function(c,
d){var f=false;if(c!=d.xml.metadata){d.xml.metadata=c;f=true}(new Date).getTime();if(qv.util.anyError(c)){b=qv.util.getErrorFromText(c);qv.util.renderError(d,b)}else{f&&qv.services.parseMetadataXML(d);d.Metadata.ParserResult.Success?qv.services.GetDataIfNeeded(d,function(c,d){var f=false;if(c!=d.xml.data){d.xml.data=c;f=true}(new Date).getTime();if(qv.util.anyError(c)){b=qv.util.getErrorFromText(c);qv.util.renderError(d,b)}else{f&&qv.services.parseDataXML(d);f=qv.util.GetContainerControlClasses(a);
f!=""&&qv.util.SetUserControlClass(a,f);f=qv.util.ProcessDataAndMetadata(a);if(f==""){f=a.getContainerControl();qv.util.hideActivityIndicator(a);if(a.MapLibrary==QueryViewerMapLibrary.Highcharts){Highcharts.mapChart(f,{chart:a.MapType==QueryViewerMapType.Bubble&&a.Chart.Series.ByIndex[0].Color.Color||a.MapType==QueryViewerMapType.Choropleth&&a.Chart.colorAxis.dataClasses.length!=0&&!a.Chart.Series.ByIndex[0].Color.Color||a.MapType==QueryViewerMapType.Bubble&&a.Chart.colorAxis.dataClasses.length!=
0&&!a.Chart.Series.ByIndex[0].Color.Color?{map:qv.map.getMapDirectory(a).mapKey,styledMode:false}:{map:qv.map.getMapDirectory(a).mapKey,styledMode:true},title:{text:qv.util.getTranslation(a.Title)},mapNavigation:{enabled:true,buttonOptions:{verticalAlign:"bottom"}},tooltip:h(a),series:r(a),colorAxis:v(a),legend:s(a)});a._ControlRenderedTo=a.RealType}else echarts.getMap(qv.map.getMapDirectory(a).mapKey)==null?qv.util.renderError(a,gx.getMessage("GXPL_QViewerNoMapSupport")):z(f,a)}else qv.util.renderError(a,
f)}}):qv.util.renderError(d,d.Metadata.ParserResult.Message)}}))})},getMapDirectory:function(a){var b="QueryViewer/"+(a.MapLibrary===QueryViewerMapLibrary.Highchart?"highcharts/":"Echarts/"),c;c={};if(a.Region==QueryViewerRegion.Country)b=b+"countries/"+a.Country.toLowerCase()+"-all.js",c="countries/"+a.Country.toLowerCase()+"/"+a.Country.toLowerCase()+"-all";else if(a.Region==QueryViewerRegion.Continent){c="custom/";b+="continents/";switch(a.Continent){case QueryViewerContinent.SouthAmerica:a="south-america";
break;case QueryViewerContinent.NorthAmerica:a="north-america";break;default:a=a.Continent.toLowerCase()}c+=a;b+=a+".js"}else a.MapLibrary==QueryViewerMapLibrary.Highcharts?(c="custom/world-highres",b+="continents/world-highres.js"):(c="world",b+="World/world.js");return c={mapKey:c,mapDir:b}},GetMetadataMap:function(a){return qv.util.GetDesigntimeMetadata(a)},GetDataMap:function(a){return a.xml.data},CheckMapSize:function(a){var b=a.getContainerControl();if(b.offsetWidth!=a.Chart._lastWidth||b.offsetHeight!=
a.Chart._lastHeight)a.Charts[0].resize({width:b.offsetWidth+"px",height:b.offsetHeight+"px"}),a.Chart._lastWidth=b.offsetWidth,a.Chart._lastHeight=b.offsetHeight},IsAfricanCountry:function(a){return 0<="DZ AO BJ BW BF BI CM CV CF TD KM CD DJ EG GQ ER SZ ET GA GM GH GN GW CI KE LS LR LY MG MW ML MR MU MA MZ NA NE NG CG RW ST SN SC SL SO ZA SS SD TZ TG TN UG EH ZM ZW".split(" ").indexOf(a)},IsAsianCountry:function(a){return 0<="AF AZ AM BH BD BT BN KH CN CY TL GE IN ID IR IQ IL JP JO KZ KW KG LA LB MY MV MN MM NP KP OM PK PS PH QA RU SA SG KR LK PS SY TW TJ TH TR TM AE UZ VN YE".split(" ").indexOf(a)},
IsEuropeanCountry:function(a){return 0<="AL AD AT AZ AM BY BE BA BG HR CY CZ DK EE FO FI FR GE DE GR HU IS IE IT XK LV LI LT LU MT MD MC ME NL MK NO PL PT RO RU SM RS SK SI ES SE CH TR UA GB VA".split(" ").indexOf(a)},IsNorthAmericanCountry:function(a){return 0<="AI AG BB BZ BM VG CA CR CU DM DO SV GL GD GT HT HN JM MX NI PA PR LC KN VC BS US TT".split(" ").indexOf(a)},IsOceanianCountry:function(a){return 0<="AU CK FJ ID KI MY MH FM NR NC NZ PW PG PH WS SB TK TO TV VU".split(" ").indexOf(a)},IsSouthAmericanCountry:function(a){return 0<=
"AR BO BR CL CO EC GF GY PY PE SR TT UY VE".split(" ").indexOf(a)},Select:function(a,b){var c=a.Charts[0].getOption();c.series[0].selectedMode="single";a.Charts[0].setOption(c);a._selectedValue=b[0].Value;a.Charts[0].dispatchAction({type:"select",seriesIndex:0,name:a._selectedValue});c=a.Charts[0].getOption();c.series[0].selectedMode=!1;a.Charts[0].setOption(c)},Deselect:function(a){a.Charts[0].dispatchAction({type:"unselect",seriesIndex:0,name:a._selectedValue});a._selectedValue=void 0}}}();
